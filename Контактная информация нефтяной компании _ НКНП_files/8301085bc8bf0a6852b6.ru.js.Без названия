(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["map-widget-app"],[,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}},,,,,,function(e,t,n){"use strict";var r;function o(e){r||(r=e({project:"ymaps3",unhandledRejection:!1,uncaughtException:!1}))}function i(e){e&&"object"==typeof e||(e=new Error(e||"empty")),function(e){var t=e.logged,n="AbortError"===e.name,r=/fetch|network/i.test(e.message);return!(t||n||r)}(e)&&(r?(r({additional:e.additionalInfo},e),e.logged=!0):window.console.error("There is no error logger to log the error:",e))}function a(e){throw i(e),e}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a})},function(e,t,n){"use strict";var r=n(6),o=n(4),i=n(2),a=n(5),s=n(39),c=n(28),u=n(62),l={},d={},p=Object(a.a)("inline-image"),f=function(e){function t(t){var n;return(n=e.call(this,t)||this)._loadAction=void 0,n._load=function(){c.a.cancel(n._loadAction);var e=n.props.url;d[e]||(d[e]=Object(s.a)({url:e,parser:"string"}),d[e].then(function(t){return l[e]=t},function(){return delete d[e]})),n._loadAction=c.a.create(d[e],{success:function(){return n.setState({loaded:!0})}})},n.state={loaded:Boolean(l[n.props.url])},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.state.loaded||this._load()},n.componentDidUpdate=function(e){if(this.props.url!==e.url){c.a.cancel(this._loadAction);var t=Boolean(l[this.props.url]);this.setState({loaded:t}),t||this._load()}},n.componentWillUnmount=function(){c.a.cancel(this._loadAction)},n.render=function(){var e=this.props;return e.children?e.children(l[e.url]||""):i.createElement("span",{key:this.state.loaded?0:1,style:Object(r.a)(Object(r.a)({},e.style),{},{fontSize:0,lineHeight:0}),className:p({loaded:this.state.loaded})+(e.className?" "+e.className:""),onClick:e.onClick,dangerouslySetInnerHTML:{__html:l[e.url]||""},ref:e.forwardedRef})},t}(i.PureComponent);t.a=Object(u.a)(f)},,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(16),o=n(2),i=o.createContext({});i.displayName="mapContext";var a=i.Provider;t.b=function(e){return void 0===e&&(e={}),function(t){var n=function(n){return o.createElement(i.Consumer,null,function(i){var a=i.map,s=i.ymaps3;return e.shouldWait&&!a?null:o.createElement(t,Object(r.a)({},n,{map:a,ymaps3:s}))})};return n.displayName="mapContext("+t.displayName+")",n}}},,function(e,t,n){"use strict";var r=n(6),o=n(457),i=n(458),a=(n(460),n(264));n(29);var s=n(45),c=n(0),u=1e6,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function d(e){for(var t=function(e){var t=[],n=(e=e.replace(/[^A-Za-z0-9\-\+_\=]/g,"")).length,r=0;for(;r<n;){var o=l.indexOf(e.charAt(r++)),i=l.indexOf(e.charAt(r++)),a=l.indexOf(e.charAt(r++)),s=l.indexOf(e.charAt(r++)),c=o<<2|i>>4,u=(15&i)<<4|a>>2,d=(3&a)<<6|s;t.push(String.fromCharCode(c)),64!==a&&t.push(String.fromCharCode(u)),64!==s&&t.push(String.fromCharCode(d))}return t.join("")}(e),n=t.length,r=0,o=[0,0],i=[];r<n;){for(var a=0,s=0,c=0,d=t.substr(r,8);c<4;)a|=d.charCodeAt(c)<<8*c,s|=d.charCodeAt(c+4)<<8*c,c++;var p=[a/u,s/u],f=[p[0]+o[0],p[1]+o[1]];o=f,i.push(f),r+=8}return i}var p=n(33);n(66);var f=n(59);n.d(t,"b",function(){return g}),n.d(t,"r",function(){return O}),n.d(t,"m",function(){return k}),n.d(t,"g",function(){return V}),n.d(t,"l",function(){return j}),n.d(t,"i",function(){return R}),n.d(t,"j",function(){return T}),n.d(t,"o",function(){return P}),n.d(t,"d",function(){return N}),n.d(t,"c",function(){return z}),n.d(t,"n",function(){return S}),n.d(t,"k",function(){return C}),n.d(t,"q",function(){return B}),n.d(t,"p",function(){return U}),n.d(t,"f",function(){return F}),n.d(t,"e",function(){return q}),n.d(t,"h",function(){return W}),n.d(t,"a",function(){return v});var m="maps_routes_travel_mode",v=["bus","tramway","trolleybus","underground","minibus","railway"],g={auto:"auto",masstransit:"mt",pedestrian:"pd",bicycle:"bc",scooter:"sc",taxi:"taxi",comparison:"comparison"},h=5e4,b={19:{main:8,underlay:12},18:{main:6,underlay:10},12:{main:4,underlay:8}},y={default:{underlay:8,main:4,border:void 0},colorize:{underlay:10,main:4,border:6}},_={underlay:"#fff",inactive:"#6d6d6d",main:"#6000ff"},E={CLOSED:{color:"#333",border:"#000"},UNKNOWN:{color:"#b3b3b3",border:"#8e8e8e"},FREE:{color:"#47ca0b",border:"#2f8109"},LIGHT:{color:"#faff00",border:"#999c03"},HARD:{color:"#ff0003",border:"#9c0304"},VERY_HARD:{color:"#98201f",border:"#791918"}},w=1e5;function S(e){return e.find(function(e){return Boolean(e.isRecommended)})||e[0]}function O(e,t){var n=e.routePoints,a=e.viaIndexes,c=e.travelMode,u=e.activeRouteIndex,l=e.detailedIndex,d=e.settings,p=e.routerResponse,f=e.ignoreTravelModes,m=e.startNavigationInApp,h=n[0],b=n.reduce(function(e,r,a){var c=r.coords,u=r.searchResult,l=u&&u.uri&&c&&("toponym"!==u.type||Object(o.a)(u.coordinates,u.displayCoordinates)||u.uri&&s.g(u.uri))&&(a<t.routes.maxCount-1||a===n.length-1)?u.uri:"";l=s.i(l)&&a>0&&a<n.length-1?"":l;var d=c&&Object(i.a)(c,{reverse:!0});return d?{pointCoords:e.pointCoords.concat([d]),pointUris:e.pointUris.concat([s.e(l)?l:""])}:e},{pointCoords:[],pointUris:[]}),y=b.pointCoords,_=b.pointUris;1!==y.length||!h||h.coords||h.value||(y.unshift(""),_.unshift(""));var E=d&&x(c,d),w=p&&p.routes[u],S="masstransit"===c&&d&&d.masstransit.avoidTypes.length!==v.length?d.masstransit.avoidTypes.join():void 0;return{rtext:y.join("~"),ruri:_.length>0?_.join("~"):void 0,via:a.length>0?a.join("~"):void 0,rtt:g[c],rtn:u>0?u:void 0,rtm:["auto","taxi"].includes(c)&&(null==d?void 0:d.auto.ignoreTrafficJams)?"atm":void 0,rtd:l>-1?l:void 0,routes:Object(r.a)(Object(r.a)({},E),{},{avoidTypes:S,cargo:void 0,activeComparisonMode:"comparison"===c&&w&&"taxi"!==w.type?w.type:void 0,timeDependent:E&&E.timeDependent&&("departure"!==E.timeDependent.type||E.timeDependent.time)?E.timeDependent:void 0,ignoreTravelModes:"comparison"===c?f:void 0}),start_navigation:m?"true":void 0}}function C(e,t,n){var r=Math.floor(e/86400),o=Math.floor(e/3600%24),i=Math.round(e/60%60);return 60===i&&(i=0,o++),24===o&&(o=0,r++),[r>0?(function(params){return params.day+" дн.";})({day:Math.abs(r)}):"",o>0?(function(params){return params.hour+" ч";})({hour:Math.abs(o)}):"",i>0&&(!n||0===r)?(function(params){return params.minutes+" мин";})({minutes:Math.abs(i)}):""].filter(Boolean).join(" ")||(function(params){return params.minutes+" мин";})({minutes:1})}function k(e,t){return 0===e?"start":t&&e!==t.length-1?"middle":"finish"}function j(){return{input:"",value:"",coords:null}}function R(){return[{input:"",value:"",coords:null},{input:"",value:"",coords:null}]}function T(e){var t=e.config,n=e.routes,r=f.a.get(m,t);return{travelMode:(Object.keys(g).includes(r)?r:void 0)||"auto",activeField:0,isFocused:!0,isLoading:!1,optimizingStatus:void 0,activeRouteIndex:0,skipApplyBounds:!1,showMapForm:!1,detailedIndex:-1,moreSnippetsShown:!1,activePoint:null,routePoints:[{input:"",value:"",coords:null},{input:"",value:"",coords:null}],viaIndexes:[],routerResponse:null,mrcFeatures:null,activeMrcIndex:null,geolocationError:null,settings:{auto:{ignoreTrafficJams:!1,avoid:[],timeDependent:{type:"departure"},cargo:null==n?void 0:n.temporaryStackData.cargo},masstransit:{avoidTypes:v,timeDependent:{type:"departure"}}}}}function I(e){var t=e.map(M);return t.filter(Boolean).length>0?t.join("~"):void 0}function M(e){var t=e.searchResult,n=e.ignorePctx;if(t&&!n)return"routePoint"in t?t.routePoint&&t.routePoint.context:void 0}function x(e,t){switch(e){case"auto":var n=t[e].timeDependent,o=t[e].cargo;return{avoid:0!==t[e].avoid.length?t[e].avoid.join():void 0,timeDependent:{time:n.time?H(new Date(n.time)):void 0},cargo:o&&0!==Object.keys(o).length?o:void 0};case"masstransit":var i=t[e].timeDependent,a=t[e].avoidTypes;return{avoidTypes:0===a.length||a.length===v.length?void 0:a.join(),timeDependent:Object(r.a)(Object(r.a)({},i),{},{time:i.time?H(new Date(i.time)):void 0})};default:return}}function P(e){return{type:"LineString",coordinates:e.coordinates||[]}}function N(e){return e.routes.forEach(function(e){e.coordinates=e.encodedCoordinates?d(e.encodedCoordinates):[]}),e}function z(e,t){return e.waypoints=e.waypoints.map(function(e){var n=t.find(function(t){return Boolean(t.coords&&e.coordinates&&Object(o.a)(t.coords,e.coordinates))});return Object(r.a)(Object(r.a)({},e),{},{name:n?n.value:""})}),e}function L(e,t){if("comparison"===t){for(var n=0,r=1;r<e.length;r++)n+=Object(a.a)(e[r],e[r-1]);return n<=h}return!0}var D=L;function A(e,t){return"auto"===e&&function(e){return e.enableRoutesB2B}(t)&&c.a.get("routes_b2b_agreement")||!1}function U(e,t){return e&&A(e,t)?t.routes.maxB2BCount:t.routes.maxCount}function F(e,t){var n=e.route,r=e.isActive,o=e.isDefaultColor;if(!r)return{stroke:[{width:y.default.main,color:_.inactive},{width:y.default.underlay,color:_.underlay}],cursor:"pointer"};var i=q({route:n,isDefaultColor:o},t);return{zIndex:10,stroke:[i.mainStyle,i.borderStyle,i.underlayStyle],cursor:"default"}}function q(e,t){var n=e.route,r=e.isDefaultColor,o=y,i=r?o.default:o.colorize;return{mainStyle:function(e,t,n){return n?{width:t.main,color:_.main}:{width:t.main,palette:e.map(function(e){return{count:e.count,color:E[e.type].color}})}}(n.colorizeInfo||[],i,r),borderStyle:function(e,t,n){return n?{}:{width:t.border,palette:e.map(function(e){return{count:e.count,color:E[e.type].border}})}}(n.colorizeInfo||[],i,r),underlayStyle:function(e){return{width:e.underlay,color:_.underlay}}(i)}}function B(e){return b[e<=12?12:e<=18?18:19]}function H(e){var t=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),r=e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":00";return e.getFullYear()+"-"+t+"-"+n+"T"+r}function W(e,t){var n=p.c(e).getTime()+60*p.e(t).getTimezoneOffset()*1e3;return new Date(n)}function G(e){return 2===e.length&&Object(a.a)(e[0],e[1])>w}function Y(e){var t=e.ignoreTrafficJams,n=e.travelMode,r=e.isRough;if(["auto","taxi","comparison"].includes(n))return r?"approx":t?"nojams":"best"}function V(e,t,n){var o=n.regionId,i=n.isRough,a=t.travelMode,s=t.routerResponse,c=t.routePoints,u=t.activeRouteIndex,l=t.viaIndexes,d=c.filter(function(e){return Boolean(e.coords)}),p=d.map(function(e){return e.coords}),f=s?s.routes[u]:null,m=t.activeComparisonMode?t.activeComparisonMode:f&&"taxi"!==f.type&&f.type||void 0,v=x(a,t.settings),g=[];return L(p,a)||g.push("bicycle"),D(p,a)||g.push("scooter"),Object(r.a)(Object(r.a)({rll:p.map(function(e){return e.join(",")}).join("~"),type:a,activeComparisonMode:m,via:l.length>0?l.join("~"):void 0,mode:Y({ignoreTrafficJams:t.settings.auto.ignoreTrafficJams||Boolean(v&&v.timeDependent&&v.timeDependent.time&&"comparison"!==a),travelMode:a,isRough:i}),pctx:I(d),ignoreTravelModes:g.length>0?g.join(","):void 0,regionId:o,enableRoutesB2B:A(a,e)||void 0},v),{},{isIntercityRoute:G(p),"no-taxi-route-hidden":e.query["no-taxi-route-hidden"]})}},,function(e,t,n){"use strict";var r=n(16),o=n(4),i=(n(139),n(141),n(143),n(145),n(2)),a=n(62),s=n(5),c=n(15),u=n(147),l=n.n(u),d=n(148),p=n.n(d),f={angle:l.a,triangle:p.a},m=Object(s.a)("button"),v=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=i.createRef(),n._onMouseEnter=function(e){n.props.title&&!n.state.hideTitle&&n.setState({hideTitle:!0}),n.props.onMouseEnter&&n.props.onMouseEnter(e)},n._onMouseDown=function(e){n.props.disabled||(n.setState({pressed:!0}),n.props.onMouseDown&&n.props.onMouseDown(e))},n._onMouseUp=function(){n.setState({pressed:!1})},n._onMouseOut=function(){n.setState({pressed:!1})},n._onFocus=function(){var e=n.props.forwardedRef,t=void 0===e?n._ref:e;if(n.state.pressed){var r=t.current;r&&r.blur()}},n._renderLink=function(e,t){var o=n.props,a=o.disabled,s=o.url,c=o.rel,u=o.target,l=o.forwardedRef,d=void 0===l?n._ref:l;return i.createElement("a",Object(r.a)({href:a?void 0:s,role:"button",target:u||"_parent","aria-disabled":!!a||void 0,ref:d,rel:c},e),t)},n._renderButton=function(e,t){var o=n.props,a=o.disabled,s=o.type,c=void 0===s?"button":s,u=o.forwardedRef,l=void 0===u?n._ref:u;return i.createElement("button",Object(r.a)({disabled:a,type:c,ref:l},e),t)},n._renderIcon=function(e){var t=n.props;return i.createElement("span",{key:"icon",className:e("icon"),style:{width:t.iconWidth}},t.icon)},n._renderTick=function(e){var t=f[n.props.tick];return i.createElement(c.a,{key:"tick",className:e("tick"),url:t})},n.state={pressed:!1,hideTitle:!1},n}return Object(o.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=[t.icon?this._renderIcon(m):null,t.children?i.createElement("span",{key:"text",className:m("text")},t.children):null,t.tick?this._renderTick(m):null],r={className:m({view:t.view,ui:(e=t.view,!["air","air-alt","search"].includes(e)),size:t.size,link:Boolean(t.url),disabled:t.disabled,checked:t.checked,"pin-left":t.pinLeft,"pin-right":t.pinRight,"pin-top":t.pinTop,"pin-bottom":t.pinBottom,pressed:this.state.pressed||t.pressed,tick:t.tick,stretched:t.isStretched,"text-align-left":t.isTextAlignLeft,"flipped-tick":t.flippedTick,hovered:t.hovered,focused:t.focused,"no-shadow":t.noShadow,truncated:t.truncated})+(t.className?" "+t.className:""),tabIndex:t.tabIndex,title:this.state.hideTitle?void 0:t.title,"aria-label":t.ariaLabel,itemProp:t.itemProp,onMouseEnter:this._onMouseEnter,onMouseLeave:t.onMouseLeave,onClick:t.onClick,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseOut:this._onMouseOut,onFocus:this._onFocus};return t.url?this._renderLink(r,n):this._renderButton(r,n)},t}(i.Component);t.a=Object(a.a)(v)},,,,function(e,t,n){"use strict";t.a={create:function(e,t){var n=t.success,r=t.fail,o=t.always,i=!1;return e.then(function(e){i||(n&&n(e),o&&o(null,e))},function(e){i||(r&&r(e),o&&o(e))}),{cancel:function(){return i=!0}}},cancel:function(e){e&&e.cancel()}}},function(e,t,n){"use strict";var r=n(120),o=["orgpage","discovery","search","search-result","routes","usermaps","masstransit","traffic","home","post-editor","bookmarks","panoramas","photos","mrc","feedback","post-editor","mobile-app-share","catalog","covid","metro","actual","stories-player","share","reviews","user-profile","event","stories-editor","ugc-profile","ingrad","booking","booking-panel"],i=n(123);n(22),n(67);n.d(t,"c",function(){return m}),n.d(t,"d",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"f",function(){return u}),n.d(t,"h",function(){return g}),n.d(t,"a",function(){return v}),n.d(t,"g",function(){return h});var a={search:["orgpage","search-result","bookmarks","traffic","masstransit","user-profile"],"search-result":["user-profile","booking"],discovery:["orgpage","search","traffic","masstransit","user-profile"],bookmarks:["search","routes","traffic","masstransit","user-profile"],routes:["search","search-result","bookmarks","traffic","feedback","user-profile","masstransit"],usermaps:["search","bookmarks","discovery","orgpage","search-result","feedback","masstransit","routes","traffic","user-profile"]},s=["photos","panoramas","mrc","mobile-app-share","reviews","share","stories-player","booking"],c=["orgpage","discovery"];function u(e){return null===e||"string"==typeof e&&o.includes(e)}function l(e){return s.includes(e)}function d(e){var t,n,r,o,a=f(e,"search-result"),s=f(e,"masstransit"),u="stop"===(null==s?void 0:s.masstransitMode)&&(null==s?void 0:null===(t=s.stops)||void 0===t?void 0:t.tab),l="business"===(null==a?void 0:null===(n=a.response)||void 0===n?void 0:null===(r=n.items[0])||void 0===r?void 0:r.type)?Object(i.a)(a.tab):void 0,d=u?Object(i.h)(u)?Object(i.g)(u):Object(i.f)(u):l?Object(i.f)(l):void 0;return Boolean((o=p(e),Boolean(o&&c.includes(o))||d))&&!0}function p(e,t){void 0===t&&(t=!0);var n=e.stack,r=t?n.filter(function(e){return!l(e.mode)}):n,o=r[r.length-1],i=function(e){var t=e.traffic,n=e.masstransit,r=e.homePanel;e.config;if(!r.isOpen)return"home";if(t.isLayerEnabled)return"traffic";if(n.isLayerShown)return"masstransit";return"home"}(e);return o&&o.mode||i}function f(e,t){var n=e.stack,r=l(t)?n:n.filter(function(e){return!l(e.mode)}),o=r[r.length-1];if(o&&o.mode===t)return o}function m(e,t){var n=e.stack,o=a[t];l(t)||(o=o?o.concat(s):s);for(var i,c=[],u=Object(r.a)(n.slice().reverse());!(i=u()).done;){var d=i.value;if(!o||!o.includes(d.mode)){if(d.mode!==t)break;c.unshift(d)}}return c}function v(e){var t=f(e,p(e));return t?t.mobileViewState||"expanded":e.defaultMobileViewState}function g(e){return e.collapsedSidebar}function h(e){return function(e){return e.baseUrl.endsWith("/profile")}(e)||Boolean(e.query["profile-mode"])}},function(e,t,n){"use strict";var r=n(6),o=n(2),i=n(7),a=n(15);t.a=Object(i.b)(function(e){var t,n,i,s,c,u=(t={name:e.name,size:e.size,theme:e.theme},n=e.config,i="number"==typeof t.size?t.size:t.size.width+"x"+t.size.height,s="dark"===t.theme?"_night":"",c=t.name+"-"+i+s+".svg",n.staticHost+"static/v18/icons/core/"+c);if(e.inline)return o.createElement(a.a,{url:u,className:e.className,onClick:e.onClick,style:e.style},"function"==typeof e.inline?e.inline:void 0);var l="number"==typeof e.size?{width:e.size,height:e.size}:e.size,d=Object(r.a)(Object(r.a)({},e.style),l);return o.createElement("img",{src:u,className:e.className,onClick:e.onClick,style:d})})},function(e,t,n){"use strict";var r=n(112),o=n(4),i=(n(277),n(2)),a=n(3),s=n(5),c=n(20),u=n(42),l=n(51),d=300,p=Object(s.a)("map-placemark"),f=function(){},m=function(e){function t(t){var n;return(n=e.call(this,t)||this)._marker=void 0,n._container=document.createElement("div"),n._mapEventHandlers=void 0,n._clickTimer=void 0,n._isDragged=!1,n._initCursor=function(){n._updateCursor(),n._marker.group().on("dragStart",function(){n._isDragged=!0,n._container.style.cursor="grabbing",n.props.map.container.style.cursor="grabbing"}).on("dragEnd",function(){n._isDragged=!1,n._updateCursor(),n.props.map.container.style.cursor="default"})},n._updateCursor=function(){n._container.style.cursor=n.props.onClick||n.props.onMouseEnter||n.props.draggable?"pointer":"default"},n._addMapEventHandlers=function(e){var t={dragStart:e.onDragStart,dragMove:e.onDragMove,dragEnd:e.onDragEnd};Object.keys(t).forEach(function(e){t[e]&&n._mapEventHandlers.on(e,function(){t[e]({coordinates:n._marker.coordinates})})})},n._onClick=function(e){e.stopPropagation();var t=n.props,r=t.onClick||f,o=t.onFastClick||f,i=t.onDoubleClick||f;n._clickTimer?(i(),window.clearTimeout(n._clickTimer),n._clickTimer=void 0):(o(),n._clickTimer=window.setTimeout(function(){r(),n._clickTimer=void 0},d))},n._container.className=p(),n._marker=t.map.createMarker({coordinates:t.coordinates,element:n._container,options:{draggable:t.draggable,zIndex:t.zIndex||u.a.default,disableRoundCoordinates:t.disableRoundCoordinates,blockEvents:t.blockEvents}}),n._mapEventHandlers=n._marker.group(),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;this._initCursor(),this._addMapEventHandlers(e),e.map.addMarker(this._dataSourceId,this._marker)},n.componentWillUnmount=function(){this.props.map.destroyed||(this._mapEventHandlers.offAll(),this.props.map.removeMarker(this._dataSourceId,this._marker),this._marker.destroy(),this._isDragged&&(this.props.map.container.style.cursor="default")),window.clearTimeout(this._clickTimer)},n.componentDidUpdate=function(e){var t=e.dataSourceId?e.dataSourceId:l.d.DEFAULT_MARKERS;t!==this._dataSourceId&&(this.props.map.removeMarker(t,this._marker),this.props.map.addMarker(this._dataSourceId,this._marker));var n=this.props;n.coordinates!==e.coordinates&&this._marker.setCoordinates(n.coordinates),e.draggable!==n.draggable&&this._marker.toggleDrag(n.draggable||!1),e.zIndex!==n.zIndex&&this._marker.setZIndex(n.zIndex||u.a.default),e.disableRoundCoordinates!==n.disableRoundCoordinates&&this._marker.toggleRoundCoordinates(n.disableRoundCoordinates||!1),n.onDragStart===e.onDragStart&&n.onDragMove===e.onDragMove&&n.onDragEnd===e.onDragEnd||(this._mapEventHandlers.offAll(),this._addMapEventHandlers(n)),e.draggable===n.draggable&&e.onClick===n.onClick||this._updateCursor()},n.render=function(){var e=this.props,t=i.createElement("div",{className:p("wrapper",{"non-interactive":e.nonInteractive}),onClick:this._onClick,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseMove:e.onMouseMove},e.children);return a.createPortal(t,this._container)},Object(r.a)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||l.d.DEFAULT_MARKERS}}]),t}(i.PureComponent);t.a=Object(c.b)({shouldWait:!0})(m)},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),o=n(2),i=n(20),a={onTouchStart:"touchstart",onTouchMove:"touchmove",onTouchEnd:"touchend",onFastClick:"fastclick",onTouchCancel:"touchcancel",onPointerDown:"pointerdown",onPointerMove:"pointermove",onPointerUp:"pointerup",onPointerCancel:"pointercancel",onClick:"click",onDoubleClick:"dblclick",onMouseUp:"mouseup",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove"},s={onUpdate:"update",onCopyrightsChange:"copyrightsChange",onResize:"resize",onZoomRangeChange:"zoomRangeChange",onReady:"ready",onIndoorPlansChanged:"indoorPlansChanged",onVectorError:"vectorError",onVectorStart:"vectorStart",onZoomRoundingChanged:"zoomRoundingChanged",onMainEngineChanged:"mainEngineChanged"},c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._applyMapHandlers=function(e,t,n){Object.keys(s).forEach(function(r){n&&t&&n[r]===t[r]||(n&&n[r]&&e.offSingle(s[r],n[r]),t&&t[r]&&e.on(s[r],t[r]))})},t._applyDomHandlers=function(e,t,n){Object.keys(a).forEach(function(r){n&&t&&n[r]===t[r]&&n.layer===t.layer||(n&&n[r]&&e.events.off(a[r],n.layer||"none",n[r]),t&&t[r]&&e.events.on(a[r],t.layer||"none",t[r]))})},t._onInertiaStart=function(e){t.props.onInertiaStart&&t.props.onInertiaStart(t.props.map.calculateCenter(e.targetPositionWcs))},t._onDragStart=function(){t.props.onDragStart&&t.props.onDragStart()},t._onDragEnd=function(){t.props.onDragEnd&&t.props.onDragEnd()},t._onContainerTouchMove=function(e){t.props.onContainerTouchMove&&t.props.onContainerTouchMove(u(e))},t._onContainerPointerMove=function(e){t.props.onContainerPointerMove&&t.props.onContainerPointerMove(u(e))},t._onActionStart=function(){t.props.onActionStart&&t.props.onActionStart()},t._onActionEnd=function(){t.props.onActionEnd&&t.props.onActionEnd()},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.map;this._applyMapHandlers(e,this.props),this._applyDomHandlers(e,this.props),e.behaviors.on("actionStart",this._onActionStart),e.behaviors.on("actionEnd",this._onActionEnd),e.behaviors.drag&&(e.behaviors.drag.on("inertiaStart",this._onInertiaStart),e.behaviors.drag.on("dragStart",this._onDragStart),e.behaviors.drag.on("dragEnd",this._onDragEnd)),e.container.addEventListener("touchmove",this._onContainerTouchMove),e.container.addEventListener("pointermove",this._onContainerPointerMove)},n.componentDidUpdate=function(e){this._applyMapHandlers(this.props.map,this.props,e),this._applyDomHandlers(this.props.map,this.props,e)},n.componentWillUnmount=function(){var e=this.props.map;this._applyMapHandlers(e,void 0,this.props),this._applyDomHandlers(e,void 0,this.props),e.behaviors.offSingle("actionStart",this._onActionStart),e.behaviors.offSingle("actionEnd",this._onActionEnd),e.behaviors.drag&&(e.behaviors.drag.offSingle("inertiaStart",this._onInertiaStart),e.behaviors.drag.offSingle("dragStart",this._onDragStart),e.behaviors.drag.offSingle("dragEnd",this._onDragEnd)),e.container.removeEventListener("touchmove",this._onContainerTouchMove),e.container.removeEventListener("pointermove",this._onContainerPointerMove)},n.render=function(){return null},t}(o.PureComponent);function u(e){if("touches"in e){var t=e.touches[0]||e.changedTouches[0];return[t.clientX,t.clientY]}return[e.clientX,e.clientY]}t.b=Object(i.b)({shouldWait:!0})(c)},,,,function(e,t,n){"use strict";n(6),n(452),n(29);var r=n(45);n(38),n(65),n(111);n.d(t,"j",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"k",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"f",function(){return p}),n.d(t,"c",function(){return f}),n.d(t,"h",function(){return m}),n.d(t,"i",function(){return g}),n.d(t,"a",function(){return d}),n.d(t,"l",function(){return v});var o=["one","two","three","four","five"];function i(e){try{JSON.parse(e)}catch(t){return e.startsWith("provider:")}return!0}function a(e){return o.indexOf(e)+1||0}function s(e){return"business"===e.type?e.direct?"geodirect":e.advert?"yabs":"bizfinder":"toponym"===e.type?"geocoder":"direct"===e.type?"geodirect":"collection"===e.type?"collection":void 0}function c(e){return Boolean(e&&"results"in e&&e.results)}function u(e){return"similar"===e.type?e.isAdvert:Boolean("business"===e.type&&e.advert&&e.advert.highlighted)}function l(e){var t;if(e)return"categories"in e&&e.categories?null===(t=e.categories[0])||void 0===t?void 0:t.class:"toponym"===e.type?g(e.hotspotProperties)?"car park":e.kind:void 0}function d(e){return"MultiLineString"===(null==e?void 0:e.type)?{type:"MultiLineString",coordinates:e.coordinates}:"GeometryCollection"===(null==e?void 0:e.type)?{type:"Polygon",coordinates:e.geometries.reduce(function(e,t){return[].concat(e,t.coordinates)},[])}:void 0}function p(e){if(c(e)){var t=1===e.results.items.length?e.results.items[0].uri:void 0;return r.c(t)}}function f(e){if(c(e)){var t=e.results.items[0];return"transit-route"===(null==t?void 0:t.type)?t.transitRouteInfo.routeId:void 0}}function m(e){return"business"===e.type}function v(e,t){return{items:[e],requestCorrectedQuery:null==t?void 0:t.requestCorrectedQuery,requestId:e.requestId,requestQuery:null==t?void 0:t.requestQuery,requestResults:1,totalResultCount:1}}function g(e){return!(null==e||!e.vectorMetadata)&&"carparks"===e.vectorMetadata.get("_vector_layerName")}},function(e,t,n){"use strict";var r=n(6),o=n(39),i=n(125),a=n(26);var s,c=function(e){var t=a.stringify(e,{sort:function(e,t){var n=e.toLowerCase(),r=t.toLowerCase();return n<r?-1:n>r?1:0}});return t?String(function(e){for(var t=e.length,n=5381,r=0;r<t;r++)n=33*n^e.charCodeAt(r);return n>>>0}(t)):""};t.a=function e(t,n,a,u){var l={csrfToken:s||a.csrfToken,sessionId:a.counters.analytics.sessionId,host_config:a.hostConfig,ajax:"1"};a.query["no-mail"]&&(l["no-mail"]=!0),a.query["no-cache"]&&(l["no-cache"]=!0),a.query.debug&&(l.debug=a.query.debug),a.mocks&&(l.mocks=0!==Object.keys(a.mocks).length?a.mocks:"1");var d={url:(n.baseUrl||a.baseUrl)+"/api/"+t,method:n.body?"POST":"GET",headers:{"X-Retpath-Y":window.location.href}};if(n.body)d.body=JSON.stringify(Object(r.a)(Object(r.a)({},l),n.body)),d.headers=Object(r.a)(Object(r.a)(Object(r.a)({},d.headers),n.headers),{},{"Content-Type":"application/json; charset=utf-8"});else{var p=Object(r.a)(Object(r.a)({},l),n.query),f=c(p);d.query=Object(r.a)(Object(r.a)({},p),{},{s:f})}return Object(o.a)(d).then(function(r){if(function(e){return"type"in e&&"captcha"===e.type}(r))throw window.location.href=r.captcha["captcha-page"],new Error("Response is captcha");if("csrfToken"in r){if(!1!==u)return s=r.csrfToken,e(t,n,a,!1);throw new Error("Invalid csrf token")}if(r.debug&&Object(i.a)(r.debug),"error"in r)throw r.error;return r.data})}},function(e,t,n){"use strict";var r=n(6),o=Object(r.a)(Object(r.a)({},{airport:"airports",area:"district",country:"fallback-toponym",house:"building",metro_station:"fallback-toponym",railway_station:"railway-station",other:"fallback-toponym",region:"fallback-toponym",station:"bus-station",vegetation:"park",unknown:"fallback-toponym"}),{barbershop:"hairdressers",gasoline:"gas-station",hotel:"hotels","phone-shop":"mobile-phones",restaurant:"restaurants",shop:"supermarket","shopping-mall":"malls",pharmacy:"medicine"}),i={medicine:"medicine-tr",drugstores:"drugstores-tr","emergency-point":"emergency-point-tr","currency-exchange":"currency-exchange-tr"},a={banks:"banks-ru","currency-exchange":"currency-exchange-ru"},s=n(160),c=n.n(s),u=n(161),l=n.n(u),d=n(162),p=n.n(d),f=n(163),m=n.n(f),v=n(164),g=n.n(v),h=n(165),b=n.n(h),y=n(166),_=n.n(y),E=n(167),w=n.n(E),S=n(168),O=n.n(S),C=n(169),k=n.n(C),j=n(170),R=n.n(j),T=n(171),I=n.n(T),M=n(172),x=n.n(M),P=n(173),N=n.n(P),z=n(174),L=n.n(z),D=n(175),A=n.n(D),U=n(176),F=n.n(U),q=n(177),B=n.n(q),H=n(178),W=n.n(H),G=n(179),Y=n.n(G),V=n(180),Z=n.n(V),K=n(181),X=n.n(K),$=n(182),J=n.n($),Q=n(183),ee=n.n(Q),te=n(184),ne=n.n(te),re=n(185),oe=n.n(re),ie=n(186),ae=n.n(ie),se=n(187),ce=n.n(se),ue=n(188),le=n.n(ue),de=n(189),pe=n.n(de),fe=n(190),me=n.n(fe);n.d(t,"b",function(){return ye}),n.d(t,"a",function(){return be}),n.d(t,"c",function(){return _e});var ve={"apteki-favicon":["favicon.svg"],favicon:["favicon.svg"],masstransit:["aero-24.svg","aeroexpress-24.svg","aeroexpress-stop-14.svg","aeroexpress-stop-24.svg","aeroexpress-stop-38.svg","bus-24.svg","bus-frame-14.svg","bus-frame-24.svg","bus-frame-38.svg","bus-placemark-24.svg","bus-placemark-38.svg","bus-stop-14.svg","bus-stop-24.svg","bus-stop-38.svg","cable-24.svg","cable-stop-14.svg","cable-stop-24.svg","cable-stop-38.svg","funicular-24.svg","funicular-stop-14.svg","funicular-stop-24.svg","funicular-stop-38.svg","minibus-24.svg","minibus-frame-14.svg","minibus-frame-24.svg","minibus-frame-38.svg","minibus-placemark-24.svg","minibus-placemark-38.svg","minibus-stop-14.svg","minibus-stop-24.svg","minibus-stop-38.svg","railway-24.svg","railway-frame-14.svg","railway-frame-24.svg","railway-frame-38.svg","railway-placemark-24.svg","railway-placemark-38.svg","railway-station-24.svg","railway-stop-14.svg","railway-stop-24.svg","railway-stop-38.svg","suburban-24.svg","suburban-stop-14.svg","suburban-stop-24.svg","suburban-stop-38.svg","train-24.svg","tramway-24.svg","tramway-frame-14.svg","tramway-frame-24.svg","tramway-frame-38.svg","tramway-placemark-24.svg","tramway-placemark-38.svg","tramway-stop-14.svg","tramway-stop-24.svg","tramway-stop-38.svg","trolleybus-24.svg","trolleybus-frame-14.svg","trolleybus-frame-24.svg","trolleybus-frame-38.svg","trolleybus-placemark-24.svg","trolleybus-placemark-38.svg","trolleybus-stop-14.svg","trolleybus-stop-24.svg","trolleybus-stop-38.svg","underground-14.svg","underground-24.svg","underground-adana-14.svg","underground-adana-24.svg","underground-almaty-14.svg","underground-almaty-24.svg","underground-ankara-14.svg","underground-ankara-24.svg","underground-athens-14.svg","underground-athens-24.svg","underground-baku-14.svg","underground-baku-24.svg","underground-barcelona-14.svg","underground-barcelona-24.svg","underground-berlin-14.svg","underground-berlin-24.svg","underground-bucharest-14.svg","underground-budapest-14.svg","underground-budapest-24.svg","underground-bursa-14.svg","underground-bursa-24.svg","underground-dnipro-14.svg","underground-dnipro-24.svg","underground-dubai-14.svg","underground-ekaterinburg-14.svg","underground-ekaterinburg-24.svg","underground-helsinki-14.svg","underground-helsinki-24.svg","underground-istanbul-14.svg","underground-istanbul-24.svg","underground-izmir-14.svg","underground-izmir-24.svg","underground-kazan-14.svg","underground-kazan-24.svg","underground-kharkiv-14.svg","underground-kharkiv-24.svg","underground-kiev-14.svg","underground-kiev-24.svg","underground-kyiv-14.svg","underground-kyiv-24.svg","underground-lisbon-14.svg","underground-lisbon-24.svg","underground-london-14.svg","underground-london-24.svg","underground-madrid-14.svg","underground-madrid-24.svg","underground-milan-14.svg","underground-minsk-14.svg","underground-minsk-24.svg","underground-moscow-14.svg","underground-moscow-24.svg","underground-moscow-mcd-14.svg","underground-nizhny-novgorod-14.svg","underground-nizhny-novgorod-24.svg","underground-novosibirsk-14.svg","underground-novosibirsk-24.svg","underground-omsk-14.svg","underground-oslo-14.svg","underground-oslo-24.svg","underground-paris-14.svg","underground-paris-24.svg","underground-praga-14.svg","underground-praga-24.svg","underground-rome-14.svg","underground-rome-24.svg","underground-saint-petersburg-14.svg","underground-saint-petersburg-24.svg","underground-samara-14.svg","underground-samara-24.svg","underground-san-francisco-14.svg","underground-santiago-14.svg","underground-santiago-24.svg","underground-sofia-14.svg","underground-stockholm-14.svg","underground-stockholm-24.svg","underground-tashkent-14.svg","underground-tashkent-24.svg","underground-tbilisi-14.svg","underground-tbilisi-24.svg","underground-tokyo-14.svg","underground-vienna-14.svg","underground-vienna-24.svg","underground-volgograd-14.svg","underground-volgograd-24.svg","underground-warsaw-14.svg","underground-warsaw-24.svg","underground-yekaterinburg-14.svg","underground-yekaterinburg-24.svg","underground-yerevan-14.svg","underground-yerevan-24.svg","underground.svg","walk-24.svg","water-24.svg","water-stop-14.svg","water-stop-24.svg","water-stop-38.svg"],"metro-favicon":["favicon.svg"],rubrics:["administration-14.svg","administration-24.svg","aeroexpress-14.svg","aeroexpress-24.svg","airfield-14.svg","airfield-24.svg","airports-14.svg","airports-24.svg","animation-14.svg","animation-24.svg","aquarium-14.svg","aquarium-24.svg","architect-bureau-14.svg","architect-bureau-24.svg","art-14.svg","art-24.svg","atm-14.svg","atm-24.svg","attraction-14.svg","attraction-24.svg","auto-14.svg","auto-24.svg","auto-parts-14.svg","auto-parts-24.svg","auto-repair-14.svg","auto-repair-24.svg","baby-shop-14.svg","baby-shop-24.svg","banks-14.svg","banks-24.svg","banks-ru-14.svg","banks-ru-24.svg","bars-14.svg","bars-24.svg","baths-14.svg","baths-24.svg","beach-14.svg","beach-24.svg","beauty-14.svg","beauty-24.svg","beauty-shops-14.svg","beauty-shops-24.svg","beer-market-14.svg","beer-market-24.svg","bike-14.svg","bike-24.svg","bike-rent-14.svg","bike-rent-24.svg","boat-station-14.svg","boat-station-24.svg","bookstore-14.svg","bookstore-24.svg","bowling-14.svg","bowling-24.svg","buddhism-14.svg","buddhism-24.svg","building-14.svg","building-24.svg","bus-medium-14.svg","bus-medium-24.svg","bus-station-14.svg","bus-station-24.svg","bus-stop-14.svg","bus-stop-24.svg","butcher-shop-14.svg","butcher-shop-24.svg","cableway-14.svg","cableway-24.svg","cafe-14.svg","cafe-24.svg","canteen-14.svg","canteen-24.svg","car-14.svg","car-24.svg","car-park-14.svg","car-park-24.svg","car-wash-14.svg","car-wash-24.svg","catholic-church-14.svg","catholic-church-24.svg","cemetery-14.svg","cemetery-24.svg","checkpoint-14.svg","checkpoint-24.svg","childrens-camp-14.svg","childrens-camp-24.svg","childrens-playground-14.svg","childrens-playground-24.svg","cinemas-14.svg","cinemas-24.svg","circus-14.svg","circus-24.svg","clothes-shop-14.svg","clothes-shop-24.svg","college-14.svg","college-24.svg","concert-hall-14.svg","concert-hall-24.svg","confectionary-14.svg","confectionary-24.svg","construction-hypermarket-14.svg","construction-hypermarket-24.svg","construction-tool-14.svg","construction-tool-24.svg","country-14.svg","country-24.svg","currency-exchange-14.svg","currency-exchange-24.svg","currency-exchange-ru-14.svg","currency-exchange-ru-24.svg","currency-exchange-tr-14.svg","currency-exchange-tr-24.svg","dairy-14.svg","dairy-24.svg","dancehall-14.svg","dancehall-24.svg","dental-14.svg","dental-24.svg","district-14.svg","district-24.svg","dolmus-14.svg","dolmus-24.svg","driving-school-14.svg","driving-school-24.svg","drugstores-14.svg","drugstores-24.svg","drugstores-tr-14.svg","drugstores-tr-24.svg","dry-cleaning-14.svg","dry-cleaning-24.svg","electronics-14.svg","electronics-24.svg","emergency-14.svg","emergency-24.svg","emergency-point-tr-14.svg","emergency-point-tr-24.svg","entertainments-14.svg","entertainments-24.svg","entrance-14.svg","entrance-24.svg","equestrian-14.svg","equestrian-24.svg","exhibition-center-14.svg","exhibition-center-24.svg","factory-14.svg","factory-24.svg","fallback-14.svg","fallback-24.svg","fallback-beauty-14.svg","fallback-beauty-24.svg","fallback-civil-services-14.svg","fallback-civil-services-24.svg","fallback-common-14.svg","fallback-common-24.svg","fallback-drugstores-14.svg","fallback-drugstores-24.svg","fallback-entertainment-14.svg","fallback-entertainment-24.svg","fallback-food-drink-14.svg","fallback-food-drink-24.svg","fallback-fun-14.svg","fallback-fun-24.svg","fallback-health-14.svg","fallback-health-24.svg","fallback-hydro-14.svg","fallback-hydro-24.svg","fallback-medicine-14.svg","fallback-medicine-24.svg","fallback-outdoor-14.svg","fallback-outdoor-24.svg","fallback-services-14.svg","fallback-services-24.svg","fallback-shopping-14.svg","fallback-shopping-24.svg","fallback-toponym-14.svg","fallback-toponym-24.svg","fallback-transport-14.svg","fallback-transport-24.svg","fast-food-14.svg","fast-food-24.svg","festival-14.svg","festival-24.svg","film-studio-14.svg","film-studio-24.svg","fire-station-14.svg","fire-station-24.svg","fish-store-14.svg","fish-store-24.svg","fitness-14.svg","fitness-24.svg","flower-shop-14.svg","flower-shop-24.svg","food-market-14.svg","food-market-24.svg","forest-14.svg","forest-24.svg","fountain-14.svg","fountain-24.svg","funicular-14.svg","funicular-24.svg","furniture-store-14.svg","furniture-store-24.svg","gallery-14.svg","gallery-24.svg","garage-cooperative-14.svg","garage-cooperative-24.svg","garden-14.svg","garden-24.svg","gasstation-14.svg","gasstation-24.svg","gastro-market-14.svg","gastro-market-24.svg","geyser-14.svg","geyser-24.svg","giftshop-14.svg","giftshop-24.svg","golf-14.svg","golf-24.svg","government-14.svg","government-24.svg","grass-14.svg","grass-24.svg","greengrocery-14.svg","greengrocery-24.svg","hairdressers-14.svg","hairdressers-24.svg","haulier-14.svg","haulier-24.svg","heart-14.svg","heart-24.svg","highspeed-tram-stop-14.svg","highspeed-tram-stop-24.svg","home-14.svg","home-24.svg","home-appliances-14.svg","home-appliances-24.svg","hospital-14.svg","hospital-24.svg","hostels-14.svg","hostels-24.svg","hotels-14.svg","hotels-24.svg","household-supplies-14.svg","household-supplies-24.svg","hydro-14.svg","hydro-24.svg","hypermarket-14.svg","hypermarket-24.svg","industrial-enterprise-14.svg","industrial-enterprise-24.svg","information-14.svg","information-24.svg","it-14.svg","it-24.svg","jewelry-store-14.svg","jewelry-store-24.svg","justice-14.svg","justice-24.svg","kindergarten-14.svg","kindergarten-24.svg","landmark-14.svg","landmark-24.svg","laundry-14.svg","laundry-24.svg","library-14.svg","library-24.svg","liquor-store-14.svg","liquor-store-24.svg","locality-14.svg","locality-24.svg","locker-14.svg","locker-24.svg","malls-14.svg","malls-24.svg","market-14.svg","market-24.svg","marketplace-14.svg","marketplace-24.svg","medical-14.svg","medical-24.svg","medicine-14.svg","medicine-24.svg","medicine-il-14.svg","medicine-il-24.svg","medicine-tr-14.svg","medicine-tr-24.svg","memorable-event-14.svg","memorable-event-24.svg","mobile-phones-14.svg","mobile-phones-24.svg","monument-14.svg","monument-24.svg","mosque-14.svg","mosque-24.svg","mountain-14.svg","mountain-24.svg","museum-14.svg","museum-24.svg","music-store-14.svg","music-store-24.svg","musicclub-14.svg","musicclub-24.svg","nail-studio-14.svg","nail-studio-24.svg","news-14.svg","news-24.svg","night-club-14.svg","night-club-24.svg","office-14.svg","office-24.svg","office-service-14.svg","office-service-24.svg","offline-14.svg","offline-24.svg","online-store-14.svg","online-store-24.svg","opticial-store-14.svg","opticial-store-24.svg","orthodox-church-14.svg","orthodox-church-24.svg","park-14.svg","park-24.svg","pawnshop-14.svg","pawnshop-24.svg","pedestrian-14.svg","pedestrian-24.svg","perfume-shop-14.svg","perfume-shop-24.svg","pet-playground-14.svg","pet-playground-24.svg","petshop-14.svg","petshop-24.svg","photo-14.svg","photo-24.svg","pier-14.svg","pier-24.svg","pizzeria-14.svg","pizzeria-24.svg","planetarium-14.svg","planetarium-24.svg","playground-14.svg","playground-24.svg","police-14.svg","police-24.svg","police-post-14.svg","police-post-24.svg","pool-hall-14.svg","pool-hall-24.svg","port-14.svg","port-24.svg","post-office-14.svg","post-office-24.svg","printing-services-14.svg","printing-services-24.svg","protestant-church-14.svg","protestant-church-24.svg","province-14.svg","province-24.svg","pub-14.svg","pub-24.svg","racing-14.svg","racing-24.svg","railway-station-14.svg","railway-station-24.svg","railway-terminal-14.svg","railway-terminal-24.svg","restaurants-14.svg","restaurants-24.svg","rezervation-14.svg","rezervation-24.svg","route-14.svg","route-24.svg","sanatorium-14.svg","sanatorium-24.svg","school-14.svg","school-24.svg","science-14.svg","science-24.svg","shoe-store-14.svg","shoe-store-24.svg","shooting-14.svg","shooting-24.svg","skating-rink-14.svg","skating-rink-24.svg","ski-resort-14.svg","ski-resort-24.svg","software-14.svg","software-24.svg","spa-14.svg","spa-24.svg","sport-14.svg","sport-24.svg","sport-school-14.svg","sport-school-24.svg","sportcenter-14.svg","sportcenter-24.svg","sports-bar-14.svg","sports-bar-24.svg","spring-14.svg","spring-24.svg","stadium-14.svg","stadium-24.svg","stage-14.svg","stage-24.svg","standpipe-14.svg","standpipe-24.svg","stationery-store-14.svg","stationery-store-24.svg","stenograffia-14.svg","stenograffia-24.svg","street-14.svg","street-24.svg","subway-fallback-14.svg","subway-fallback-24.svg","supermarket-14.svg","supermarket-24.svg","sushi-14.svg","sushi-24.svg","swimming-pool-14.svg","swimming-pool-24.svg","synagogue-14.svg","synagogue-24.svg","tableware-14.svg","tableware-24.svg","tailor-14.svg","tailor-24.svg","taxi-14.svg","taxi-24.svg","tennis-14.svg","tennis-24.svg","theatre-14.svg","theatre-24.svg","ticket-office-14.svg","ticket-office-24.svg","tire-fitting-14.svg","tire-fitting-24.svg","tram-stop-14.svg","tram-stop-24.svg","trash-14.svg","trash-24.svg","travel-agency-14.svg","travel-agency-24.svg","university-14.svg","university-24.svg","urban-leisure-house-of-culture-14.svg","urban-leisure-house-of-culture-24.svg","vet-clinic-14.svg","vet-clinic-24.svg","veterinary-14.svg","veterinary-24.svg","viewpoint-14.svg","viewpoint-24.svg","waterfall-14.svg","waterfall-24.svg","waterpark-14.svg","waterpark-24.svg","wc-14.svg","wc-24.svg","wedding-14.svg","wedding-24.svg","well-14.svg","well-24.svg","wine-14.svg","wine-24.svg","work-14.svg","work-24.svg","ya-gas-station-14.svg","ya-gas-station-24.svg","yoga-14.svg","yoga-24.svg","zoo-14.svg","zoo-24.svg"],service:["bookmark-14.svg","bookmark-list-14.svg","geolocation-14.svg","home-14.svg","home-24.svg","like-14.svg","like-24.svg","lock-24.svg","message-24.svg","my-location-14.svg","personal-14.svg","poll-24.svg","search-14.svg","search-24.svg","show-map-14.svg","web-24.svg","work-14.svg","work-24.svg"]},ge={small:14,normal:24,large:38},he=(Z.a,X.a,J.a,ee.a,ne.a,oe.a,le.a,pe.a,me.a,ae.a,ce.a,_.a,w.a,O.a,k.a,R.a,I.a,x.a,N.a,L.a,A.a,F.a,B.a,c.a,l.a,p.a,m.a,g.a,b.a,Y.a,W.a,W.a,Y.a,W.a,Y.a,"//yastatic.net/s3/front-maps-static/constructor-icons/");function be(e,t){var n=e.type,r=e.name,s=e.size,c=function(e,t){var n=e.toLowerCase().replace(/\s+/g,"-");return"ru"===t.lang&&a[n]?a[n]:"tr"===t.lang&&i[n]?i[n]:o[n]||n}(r,t);if(!c)return null;var u=c+"-"+ge[s]+".svg";return ve[n]&&ve[n].includes(u)?t.staticHost+"static/v18/icons/"+n+"/"+u:null}function ye(e){return""+he+e+".svg"}function _e(e){var t=e.lang;return["ru","uk","kk"].includes(t)}},,,function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return u});var r=n(6),o=n(26),i=n.n(o),a=n(458),s=n(23),c=n(22);function u(e){var t=e.split("?"),n=t[0],o=t[1],a=void 0===o?"":o;return n+"?"+i.a.stringify(Object(r.a)(Object(r.a)({},i.a.parse(a)),{},{from:"mapframe"}))}var l=14;function d(e,t,n){var o,i=c.r({routePoints:e,viaIndexes:[],travelMode:t.travelMode||"auto",activeRouteIndex:0,routerResponse:null,detailedIndex:0,settings:{auto:{ignoreTrafficJams:!1,avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}},startNavigationInApp:!0},n),d=e.some(function(e){return!e.coords})?null===(o=e.find(function(e){return e.coords}))||void 0===o?void 0:o.coords:void 0;return u(s.a(s.k("/",Object(r.a)({ll:d?Object(a.a)(d):void 0,z:d?l:void 0},i)),n))}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={screenshotDialog:99999,ruler:8030,editing:8030,hover:8020,active:8e3,search:{active:8e3,subtitle:7500,title:7e3,base:6500,dot:6e3},dialog:2e3,usermaps:{placemark:3e3,line:2e3,polygon:1e3},discovery:580,routes:550,routePins:{waypoint:8e3,masstransit:7900},masstransitStop:8001,moving:500,masstransitLineStop:510,home:451,work:450,default:400,tooltip:352,masstransitRegion:350,bookmarks:300,minimum:1}},,,function(e,t,n){"use strict";n.d(t,"d",function(){return y}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"h",function(){return p}),n.d(t,"f",function(){return u}),n.d(t,"j",function(){return _});var r=n(26),o=(n(460),"ymapsbm1://pin?"),i="ymapsbm1://org?",a="ymapsbm1://transit/stop?",s="ymapsbm1://geo?",c=/ymapsbm1:\/\/route\/(\w+)/;function u(e){return!!e&&e.startsWith(i)}function l(e){return e&&u(e)?h(e).oid:void 0}function d(e){return e.startsWith(o)}function p(e){return!!e&&e.startsWith(a)}function f(e){return e&&p(e)?h(e).id:void 0}function m(e){return u(e)||d(e)||p(e)}function v(e){return e.startsWith(s)}function g(e){return u(e)||d(e)||p(e)||v(e)}function h(e){return r.parse(e.split("?")[1])}function b(e){return a+r.stringify({id:e})}function y(e){return"direct"===e.type?"direct-"+(e.direct.url||e.coordinates):"collection"===e.type?"collection-"+e.alias+"-"+e.analyticsId:e.uri}function _(e){return function(e){if(e){return{pedestrian:"pedestrian",transit:"masstransit",bicycle:"bicycle",driving:"auto"}[(e.match(c)||[])[1]]}}(e)?e:void 0}},function(e,t,n){"use strict";var r=n(101);t.a=function(e){return null==e?"":Object(r.a)(e)}},function(e,t,n){"use strict";var r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.a=function(e){return r.test(e)}},function(e,t,n){"use strict";var r=n(112),o=n(4),i=n(2),a=n(63),s=n.n(a),c=n(20),u=n(459),l=n(51),d=n(227),p=n(70),f={onClick:"click",onFastClick:"fastclick",onTouchEnd:"touchend",onDoubleClick:"dblclick",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseUp:"mouseup",onMouseDown:"mousedown",onMouseMove:"mousemove"},m=Object(p.a)(d.b,Object(c.b)({shouldWait:!0})),v=function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=void 0,n._handlers={},n._getFeature=function(){return{type:"Feature",id:n._id,geometry:n.props.geometry}},n._addHandler=function(e,t,r){n._handlers[e]=function(e,t,o){e&&"feature"===e.type&&e.feature.id===n._id&&r(o,t)},n.props.map.events.on(f[e],t,n._handlers[e])},n._removeHandler=function(e,t){n.props.map.events.off(f[e],t,n._handlers[e]),delete n._handlers[e]},n._id=t.id||s.a.v4(),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props;t.map.addFeature(this._dataSourceId,this._getFeature(),t.drawingStyle,t.parentGroupId),Object.keys(f).forEach(function(n){t[n]&&e._addHandler(n,e._dataSourceId,t[n])})},n.componentDidUpdate=function(e){var t=this,n=this.props,r=e.dataSourceId?e.dataSourceId:l.d.DEFAULT_GRAPHICS;r!==this._dataSourceId?(n.map.removeFeatureById(r,this._id),n.map.addFeature(this._dataSourceId,this._getFeature(),n.drawingStyle,n.parentGroupId)):((!Object(u.a)(e.drawingStyle,n.drawingStyle)||!Object(u.a)(e.geometry,n.geometry))&&n.map.updateFeature(this._dataSourceId,this._getFeature(),n.drawingStyle),e.parentGroupId!==n.parentGroupId&&n.map.moveFeatureToGroup(this._dataSourceId,this._getFeature().id,n.parentGroupId));Object.keys(f).forEach(function(o){n[o]===e[o]&&r===t._dataSourceId||(e[o]&&t._removeHandler(o,r),n[o]&&t._addHandler(o,t._dataSourceId,n[o]))})},n.componentWillUnmount=function(){var e=this;Object.keys(this._handlers).forEach(function(t){return e._removeHandler(t,e._dataSourceId)}),this.props.map.removeFeatureById(this._dataSourceId,this._id)},n.render=function(){return null},Object(r.a)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||l.d.DEFAULT_GRAPHICS}}]),t}(i.PureComponent);t.a=m(v)},,function(e,t,n){"use strict";var r=n(4),o=(n(149),n(2)),i=n(3),a=n(5),s=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.render=function(){return this.props.children},t}(o.PureComponent),c=n(96),u=n(7),l=Object(a.a)("hover-hint"),d=function(e){function t(t){var n;return(n=e.call(this,t)||this)._target=null,n._showTimerId=0,n._hide=function(){window.clearTimeout(n._showTimerId),n._showTimerId=0,n.setState({isShown:!1})},n._onPopupClose=function(){n._hide()},n._onMouseEnter=function(){n._showTimerId||n.props.isDisabled||(n._showTimerId=window.setTimeout(function(){return n.setState({isShown:!0})},n.props.delay||200))},n._onMouseLeave=function(){n._hide()},n._onClick=function(){(void 0===n.props.hideOnClick||n.props.hideOnClick)&&n._hide()},n._renderPopup=function(){var e=n.props,t=e.isAir?"air":"help",r=Boolean(!e.isDisabled&&(n.state.isShown||e.force));return o.createElement(c.a,{isShown:r,position:e.position,offset:e.offset,type:t,onScroll:e.onScroll||"reposition",getTarget:function(){return n._target||null},onClose:n._onPopupClose,className:e.className,showArrow:e.showArrow,arrowOffset:e.arrowOffset},o.createElement("div",{className:l({type:t,size:e.size||"m"})},e.text))},n.state={isShown:Boolean(t.isInitialShown)},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._target&&(this._target.addEventListener("mouseenter",this._onMouseEnter),this._target.addEventListener("mouseleave",this._onMouseLeave),this._target.addEventListener("click",this._onClick))},n.componentWillUnmount=function(){this._target&&(this._target.removeEventListener("mouseenter",this._onMouseEnter),this._target.removeEventListener("mouseleave",this._onMouseLeave),this._target.removeEventListener("click",this._onClick)),window.clearTimeout(this._showTimerId),this._showTimerId=0},n.componentDidUpdate=function(e){!e.isDisabled&&this.props.isDisabled&&this.state.isShown&&(window.clearTimeout(this._showTimerId),this._showTimerId=0,this.setState({isShown:!1}))},n.render=function(){var e=this,t=this.props;return o.createElement(o.Fragment,null,o.createElement(s,{ref:function(t){return e._target=t?i.findDOMNode(t):null}},t.children),this._renderPopup())},t}(o.Component);t.a=Object(u.b)(d)},function(e,t,n){"use strict";var r=n(6),o=n(26),i=n.n(o),a=(n(94),n(113)),s=n(226);n.d(t,"g",function(){return y}),n.d(t,"k",function(){return _}),n.d(t,"j",function(){return O}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"i",function(){return j}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return I}),n.d(t,"f",function(){return T}),n.d(t,"h",function(){return x});var c={DEFAULT_MARKERS:"defaultMarkers",DEFAULT_GRAPHICS:"defaultGraphics",EDITOR_MARKERS:"editorMarkers",EDITOR_GRAPHICS:"editorGraphics"},u=":customDomLayer(eventBlocker)",l=["map","sat","skl"],d=["map","sat"],p=["map","trf","trfe","stv","indoor","carparks","mrc","mrcpe","personalizedPoi"],f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",m={map:function(e){var t=e.mapTiles,n=e.mapjTiles;return{url:S(t),hotspotsUrl:S(n)}},sat:function(e){return{url:S(e.satTiles)}},skl:function(e){var t=e.sklTiles,n=e.skljTiles;return{url:S(t),hotspotsUrl:S(n)}},stv:function(e){return{url:e.stvTiles.replace("l=stv","l=stv,sta")}},sta:function(e){return{hotspotsUrl:e.staHotspotTiles}},pht:function(e){return{url:e.phtTiles,hotspotsUrl:e.phtHotspotTiles+"&format=json"}},mrc:function(e){return{url:e.mrcTiles+"&camera-direction=front",hotspotsUrl:e.mrcHotspotTiles+"&camera-direction=front"}},mrcpe:function(e){return{url:e.mrcpeTiles+"&camera-direction=front",hotspotsUrl:e.mrcpeHotspotTiles+"&camera-direction=front"}},carparks:function(e){return{url:e.carparksTiles}},personalizedPoi:function(){return{}}},v=["map:ground","sat:ground","skl:ground","personalizedPoi:ground","trf:ground","carparks:ground","mrc:ground","mrcpe:ground","stv:ground","indoor:ground","map:buildings","map:icons","map:labels","personalizedPoi:icons","personalizedPoi:labels","trf:icons","trf:labels","carparks:icons","indoor:icons","indoor:labels","stv:icons","sta:ground","pht:ground","trfa:ground",c.DEFAULT_GRAPHICS,c.DEFAULT_MARKERS,u,c.EDITOR_GRAPHICS,c.EDITOR_MARKERS],g={vector:{transformLayers:{"map:buildings":{opacity:.7}}}};function h(e){var t={vector:{iconsInteractiveArea:e&&function(e){var t=e.uatraits.isMobile,n=e.experiments.ui.vectorExtendTaps;return t&&n?{field:10,minSize:40}:void 0}(e)}};return{"map:buildings":{vector:{objectsInteractivity:!0,modelsAppearingAnimation:{transitionZoom:17,duration:250,limitByZoom:.5}}},"map:icons":t,"indoor:icons":t,"trf:icons":t,"stv:icons":t,"carparks:icons":t,"personalizedPoi:icons":t,"stv:ground":g,"mrc:ground":g,"mrcpe:ground":g}}var b=["map","sat","pht"];function y(e){var t=Object.keys(m).reduce(function(t,n){var r=e.layers["sta"===n?"stv":n],o=r&&r.zoomRange;return t[n]={type:"tile",raster:w(n,r,e),vector:k(n,r,e),clampMapZoom:l.includes(n),zoomRange:o?{min:o[0],max:o[1]}:void 0},t},{}),n=e.hosts,r=e.locale,o=e.uatraits.isMobile;return t.indoor={type:"tile",vector:T({collisionPriority:"low",priority:"low",requestTileSize:o?"X1":"X4",glyphRangeUrl:n.vectorIndoorGlyphs.replace("{{lang}}",r),imageUrl:n.vectorIndoorImages,meshUrl:n.vectorIndoorMeshes,tileUrl:M(n.vectorIndoorTiles.replace("{{lang}}",r),e),indoorPlanUrl:n.vectorIndoorPlans,mapMode:x(e)},e)},Object.keys(c).forEach(function(e){t[c[e]]=e.endsWith("MARKERS")?{type:"markers"}:{type:"geojson"}}),t}function _(e,t,n){return e.replace("%l","lang="+t).replace("%v",n).replace(/%d\|\d+/,function(e){return"{{"+e+"}}"}).replace(/%d/,"{{d|4}}").replace("%c","x={{x}}&y={{y}}&z={{z}}&scale={{scale}}")}function E(e,t){var n;return e+((null===(n=t.mocks)||void 0===n?void 0:n.version)?"&mocks%5Bversion%5D="+t.mocks.version:"")}function w(e,t,n){var r=m[e];if(!t||!r)return{tileUrl:f};var o=r(n.hosts),i=function(e){return _(e,n.locale,t.version)},s=["map","skl","carparks","stv","sta","mrc","mrcpe"].includes(e)?R(n):"",c=o.url?i(o.url)+s:f;return{tileUrl:"map"===e?M(c,n):c,fetchHotspots:o.hotspotsUrl?Object(a.a)(i(o.hotspotsUrl)+s):void 0,transparent:!d.includes(e),hotspotPadding:n.uatraits.isMobile?12:0}}function S(e){return e.replace("%c","v=%v&%c")}function O(e,t,n){for(var r=e.filter(function(e,t,n){return n.indexOf(e)===t}).sort(function(t,n){var r=v.indexOf(t)-v.indexOf(n);return 0===r?e.indexOf(t)-e.indexOf(n):r}).reverse(),o=[],i=r.length-1;i>=0;i--){var a=r[i],s=a.split(":")[0];if(!p.includes(s))break;o.push(a),r.splice(i,1)}return r.reverse(),{topRasterLayers:C(r,n).map(function(e){return e===u?{id:u,type:"customDomLayer",options:{raster:{implementation:t}}}:e}),mainLayers:C(o,n)}}function C(e,t){var n=h(t);return e.map(function(e){return e in n?Object(s.c)(e,n[e]):e})}function k(e,t,n){if(t){var r=n.locale,o=n.hosts;if("personalizedPoi"===e)return T({priority:"medium",tileUrl:M(_(o.tilesApi+"personalized_poi/tiles?l=personalized_poi&%l&v=%v&x={{x}}&y={{y}}&z={{z}}&zmin={{zmin}}&zmax={{zmax}}",n.lang,t.version),n),requestTileSize:"X4",imageUrl:o.tilesApi+"personalized_poi/icons?id={{id}}&scale={{scale}}",glyphRangeUrl:o.tilesApi+"personalized_poi/glyphs?font_id={{fontId}}&range={{range}}",mapMode:x(n),tileRequestWithCredentials:!0,imageRequestWithCredentials:!0,glyphRequestWithCredentials:!0},n);if("carparks"===e){var i,s=(null===(i=n.mocks)||void 0===i?void 0:i.version)?"":"&v=%v";return T({priority:"medium",tileUrl:E(_(o.carparksTileRenderer+"tiles?version=2&l=carparks&%l"+s+"&x={{x}}&y={{y}}&z={{z}}",n.lang,t.version),n),imageUrl:o.carparksTileRenderer+"icons?id={{id}}&scale={{scale}}",mapMode:x(n)},n)}if("stv"===e)return T({priority:"medium",tileUrl:_(o.stvTileRenderer+"tiles?l=sta,stv&x={{x}}&y={{y}}&z={{z}}&%l&v=%v&format=protobuf",n.lang,t.version),imageUrl:o.stvTileRenderer+"icons?id={{id}}&scale={{scale}}",mapMode:x(n)},n);if("mrc"===e||"mrcpe"===e){var c="mrc"===e?o.mrcTiles:o.mrcpeTiles,u="mrc"===e?o.mrcHotspotTiles:o.mrcpeHotspotTiles;return T({priority:"medium",tileUrl:c.replace("%c","x={{x}}&y={{y}}&z={{z}}")+"&camera-direction=front&format=protobuf",hotspots:{ground:Object(a.a)(u.replace("%c","x={{x}}&y={{y}}&z={{z}}")+"&camera-direction=front")},mapMode:x(n)},n)}if("map"===e){var l=n.uatraits.isMobile,d=o.vectorTiles.replace("{{lang}}",r).replace("{{version}}",t.version);return T({collisionPriority:"low",priority:"high",tileBeltSize:1,requestTileSize:l?"X1":"X4",imageUrl:o.vectorImages,tileUrl:E(M(d,n),n),meshUrl:o.vectorMeshes,glyphRangeUrl:o.vectorGlyphs.replace("{{lang}}",r),hotspots:{buildings:{minZoom:16.5}},mapMode:x(n)},n)}}}function j(e){return v.filter(function(t){return t.startsWith(e+":")})}function R(e){var t=Object(r.a)({},e.experiments.rendererParams||{});return Object.keys(e.query).forEach(function(n){n.startsWith("renderer_")&&(t[n.replace(/^renderer_/,"")]=e.query[n])}),Object.keys(t).length>0?"&"+i.a.stringify(t,{indices:!1}):""}function T(e,t){return Object(r.a)(Object(r.a)({},e),{},{imageUrl:I(e.imageUrl,t),tileUrl:I(e.tileUrl,t),meshUrl:I(e.meshUrl,t),indoorPlanUrl:I(e.indoorPlanUrl,t),glyphRangeUrl:I(e.glyphRangeUrl,t)})}function I(e,t){return e?e+R(t):e}function M(e,t){return e.includes(";base64")?e:e+(t.bunker.disableAdsMapTiles?"":"&ads=enabled")}function x(e){return"dark"==(e.query,e.uatraits,"light")?"night":void 0}},,,function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(71),o=n(106),i=36e5,a=6e4,s=2,c={dateTimeDelimeter:/[T ]/,plainTime:/:/,timeZoneDelimeter:/[Z ]/i,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-])(\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function u(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var n=t||{},u=null==n.additionalDigits?s:Object(r.a)(n.additionalDigits);if(2!==u&&1!==u&&0!==u)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var d=function(e){var t,n={},r=e.split(c.dateTimeDelimeter);c.plainTime.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1],c.timeZoneDelimeter.test(n.date)&&(n.date=e.split(c.timeZoneDelimeter)[0],t=e.substr(n.date.length,e.length)));if(t){var o=c.timezone.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),p=function(e,t){var n,r=c.YYY[t],o=c.YYYYY[t];if(n=c.YYYY.exec(e)||o.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=c.YY.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(d.date,u),b=p.year,y=function(e,t){if(null===t)return null;var n,r,o,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=c.MM.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,m(t,o)?(r.setUTCFullYear(t,o),r):new Date(NaN);if(n=c.DDD.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return function(e,t){if(t<1)return!1;var n=f(e);if(n&&t>366)return!1;if(!n&&t>365)return!1;return!0}(t,a)?(r.setUTCFullYear(t,0,a),r):new Date(NaN)}if(n=c.MMDD.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return m(t,o,s)?(r.setUTCFullYear(t,o,s),r):new Date(NaN)}if(n=c.Www.exec(e))return i=parseInt(n[1],10)-1,v(t,i)?l(t,i):new Date(NaN);if(n=c.WwwD.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return v(t,i,u)?l(t,i,u):new Date(NaN)}return null}(p.restDateString,b);if(isNaN(y))return new Date(NaN);if(y){var _,E=y.getTime(),w=0;if(d.time&&(w=function(e){var t,n,r;if(t=c.HH.exec(e))return g(n=parseFloat(t[1].replace(",",".")))?n%24*i:NaN;if(t=c.HHMM.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),g(n,r)?n%24*i+r*a:NaN;if(t=c.HHMMSS.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return g(n,r,o)?n%24*i+r*a+1e3*o:NaN}return null}(d.time),isNaN(w)))return new Date(NaN);if(d.timezone){if(_=function(e){var t,n,r;if(t=c.timezoneZ.exec(e))return 0;if(t=c.timezoneHH.exec(e))return h(r=parseInt(t[2],10))?(n=r*i,"+"===t[1]?-n:n):NaN;if(t=c.timezoneHHMM.exec(e)){r=parseInt(t[2],10);var o=parseInt(t[3],10);return h(r,o)?(n=r*i+o*a,"+"===t[1]?-n:n):NaN}return 0}(d.timezone),isNaN(_))return new Date(NaN)}else _=Object(o.a)(new Date(E+w)),_=Object(o.a)(new Date(E+w+_));return new Date(E+w+_)}return new Date(NaN)}function l(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}var d=[31,28,31,30,31,30,31,31,30,31,30,31],p=[31,29,31,30,31,30,31,31,30,31,30,31];function f(e){return e%400==0||e%4==0&&e%100!=0}function m(e,t,n){if(t<0||t>11)return!1;if(null!=n){if(n<1)return!1;var r=f(e);if(r&&n>p[t])return!1;if(!r&&n>d[t])return!1}return!0}function v(e,t,n){return!(t<0||t>52)&&(null==n||!(n<0||n>6))}function g(e,t,n){return(null==e||!(e<0||e>=25))&&((null==t||!(t<0||t>=60))&&(null==n||!(n<0||n>=60)))}function h(e,t){return null==t||!(t<0||t>59)}},function(e,t,n){"use strict";function r(e){return Math.PI/180*e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(4),o=(n(155),n(2)),i=n(5),a=Object(i.a)("resize-listener"),s=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._measurer=null,t._onResize=function(e){t.props.onResize(e)},t._onIframeLoad=function(){t._measurer.contentWindow.addEventListener("resize",t._onResize)},t._iframeRef=function(e){t._measurer=e},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this._measurer;e.contentWindow?this._onIframeLoad():e.addEventListener("load",this._onIframeLoad)},n.componentWillUnmount=function(){var e=this._measurer;e&&(e.removeEventListener("load",this._onIframeLoad),e.contentWindow&&e.contentWindow.removeEventListener("resize",this._onResize))},n.render=function(){return o.createElement("iframe",{className:a(),tabIndex:-1,ref:this._iframeRef})},t}(o.Component);t.a=s},function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var r=n(8),o=n(14);function i(e,t){return Object(r.a)(Object(r.a)({},e),{geometry:e.geometry&&a(e.geometry,t)})}function a(e,t){switch(e.type){case"Point":return Object(r.a)(Object(r.a)({},e),{coordinates:t(e.coordinates)});case"LineString":return Object(r.a)(Object(r.a)({},e),{coordinates:e.coordinates.map(t)});case"MultiLineString":return Object(r.a)(Object(r.a)({},e),{coordinates:e.coordinates.map(function(e){return e.map(t)})});case"Polygon":return Object(r.a)(Object(r.a)({},e),{coordinates:e.coordinates.map(function(e){return e.map(t)})});case"MultiPolygon":return Object(r.a)(Object(r.a)({},e),{coordinates:e.coordinates.map(function(e){return e.map(function(e){return e.map(t)})})});default:Object(o.c)(new Error("Unexpected geometry type: "+e.type))}}function s(e){var t;return"FeatureCollection"===e.type?(t=[]).concat.apply(t,e.features.map(function(e){return s(e)})):[e]}function c(e){"string"!=typeof e.id&&Object(o.c)(new Error("Feature or collection id must be a string"))}},,,,,function(e,t,n){"use strict";var r=n(16),o=n(2);t.a=function(e){var t=function(t,n){return o.createElement(e,Object(r.a)({},t,{forwardedRef:n||void 0}),t.children)};return o.forwardRef(t)}},function(e,t,n){var r=n(273),o=n(274),i=o;i.v1=r,i.v4=o,e.exports=i},,,function(e,t,n){"use strict";var r=n(33);n(54);n.d(t,"b",function(){return s}),n.d(t,"a",function(){return a});var o=["january","february","march","april","may","june","july","august","september","october","november","december"];function i(e,t){return{april:"апреля",august:"августа",december:"декабря",february:"февраля",january:"января",july:"июля",june:"июня",march:"марта",may:"мая",november:"ноября",october:"октября",september:"сентября"}[o[e]]}function a(e,t,n){void 0===n&&(n={});var a,s=r.e(r.d(t)),c={day:e.getDate(),month:n.isShortMonth?(a=e.getMonth(),{april:"апр",august:"авг",december:"дек",february:"февр",january:"янв",july:"июля",june:"июня",march:"марта",may:"мая",november:"нояб",october:"окт",september:"сент"}[o[a]]):i(e.getMonth()),year:e.getFullYear()};return(void 0!==n.isShortDate?n.isShortDate:e.getFullYear()===s.getFullYear())?(function(params){return params.day+" "+params.month;})(c):(function(params){return params.day+" "+params.month+" "+params.year;})(c)}function s(e,t){return a(e,t)+", "+function(e){var t=e.toTimeString().split(" ")[0],n=r.g(t);if(!n)return"";return""+r.h(n)}(e)}},,,,,function(e,t,n){"use strict";function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return 180/Math.PI*e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(4),o=n(2),i=n(3),a=n(459),s=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getContainer=function(){var e=n.props;return e.containerRef?e.containerRef.current||void 0:e.selector?window.document.querySelector(e.selector)||void 0:window.document.body},n._updateContainer=function(){var e=n._getContainer();e!==n.state.container&&n.setState({container:e})},n.state={},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateContainer()},n.componentDidUpdate=function(e){Object(a.a)(e,this.props)||this._updateContainer()},n.render=function(){var e=this.state;return e.container?i.createPortal(this.props.children,e.container):null},t}(o.Component);t.a=s},function(e,t,n){"use strict";var r=n(4),o=n(2),i=function(e){function t(){return e.apply(this,arguments)||this}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;window.addEventListener(e.type,e.listener,e.options)},n.componentWillUnmount=function(){var e=this.props;window.removeEventListener(e.type,e.listener,e.options)},n.render=function(){return null},t}(o.Component);t.a=i},,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(4),o=n(2),i=n(265),a=n(90),s=512,c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t._listener=void 0,t._attachListener=function(){var e;t._listener=Object(i.a)(t.props.eventHandler,null!==(e=t.props.throttleWait)&&void 0!==e?e:s),t._unsubscribe=t.props.addListener(t._listener)},t._unattachListener=function(){var e;t._unsubscribe(),null===(e=t._listener)||void 0===e||e.cancel()},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._attachListener()},n.componentDidUpdate=function(e){e.eventHandler!==this.props.eventHandler&&(this._unattachListener(),this._attachListener())},n.componentWillUnmount=function(){this._unattachListener()},n.render=function(){return null},t}(o.PureComponent);t.a=Object(a.b)(c)},function(e,t,n){"use strict";n.d(t,"a",function(){return s});n(2);var r=n(52);function o(){return o}var i=Object(r.a)("scroll",{addListener:o,getScrollableNode:function(){return null},scrollId:"",registerStickyElement:o,unregisterStickyElement:o,updateStickyElement:o,getStickyElementsOffsetTop:function(){return 0}}),a=i.connect,s=i.Provider;i.Context;t.b=a},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(266),o=(n(109),function(){return{events:{transitionEnd:i("transition"),animationEnd:i("animation")},styles:{transform:s("transform"),transition:s("transition"),userSelect:s("user-select")},cssStyles:{transform:a("transform"),transformOrigin:a("transform-origin")},has:{touch:"ontouchstart"in window||Boolean(window.navigator.maxTouchPoints),retinaDisplay:window.devicePixelRatio>1,printColorAdjust:null!==c("printColorAdjust"),snapAlign:null!==c("scrollSnapAlign"),objectFit:null!==c("objectFit")}}});function i(e){var t=c(e);return t?t+Object(r.a)(e)+"End":null!==t?e+"end":null}function a(e){var t=c(e);return t?"-"+t+"-"+e:null!==t?e:null}function s(e){var t=c(e);return t?t+u(e):null!==t?e:null}function c(e){var t=window.document.createElement("div");return void 0!==t.style[e]?"":void 0!==t.style["webkit"+u(e)]?"webkit":void 0!==t.style["Moz"+u(e)]?"Moz":void 0!==t.style["ms"+u(e)]?"ms":null}function u(e){return e.split("-").map(function(e){return Object(r.a)(e)}).join("")}},function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 5.992c0-.537.448-.992 1-.992.556 0 1 .444 1 .992V11h5.008c.537 0 .992.448.992 1 0 .556-.444 1-.992 1H13v5.008c0 .537-.448.992-1 .992-.556 0-1-.444-1-.992V13H5.992C5.455 13 5 12.552 5 12c0-.556.444-1 .992-1H11V5.992z" fill="currentColor"/></svg>'},function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z" fill="currentColor"/></svg>'},function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return s});var r=n(8),o=256,i=130,a=32,s=function(e){if("tile"===e.type){var t=Object(r.a)({},e),n=e;return n.raster&&(t.raster=Object(r.a)({},e.raster)),n.vector&&(t.vector=Object(r.a)({},e.vector)),t}return Object(r.a)({},e)}},,function(e,t,n){"use strict";var r=n(6),o=n(73),i=n(4),a=(n(151),n(153),n(2)),s=n(5),c=n(74),u=n(3),l=[],d=function(e,t){var n=e.target,r=t.node,o=t.callback,i=t.stopPropagation,a=t.getExcludedNodes;if(m(r,n))return!i;var s=a&&a();if(s&&(s=Array.isArray(s)?s:[s]).some(function(e){return m(e,n)}))return!i;return o(e),!i},p=function(e){for(var t=l.length-1;t>=0;t--){if(!d(e,l[t]))break}},f=function(e,t){0===l.length&&(window.document.addEventListener("mousedown",p,!0),window.document.addEventListener("touchstart",p,!0));var n=Object(r.a)({node:e},t);return l.push(n),function(){return e=n,void(0===(l=l.filter(function(t){return e!==t})).length&&(window.document.removeEventListener("mousedown",p,!0),window.document.removeEventListener("touchstart",p,!0)));var e}};function m(e,t){return e===t||e.contains(t)}var v=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.callback,n=e.stopPropagation,r=e.getExcludedNodes,o=u.findDOMNode(this);o instanceof Element&&(this._unsubscribe=f(o,{callback:t,stopPropagation:n,getExcludedNodes:r}))},n.componentWillUnmount=function(){this._unsubscribe()},n.render=function(){return a.Children.only(this.props.children)},t}(a.Component),g=n(75),h={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,A:65,D:68,P:80,S:83,W:87},b=["INPUT","SELECT","TEXTAREA"],y=[],_=function(e,t){var n=e.keyCode,r=e.target.tagName,o=t.handlers,i=t.stopPropagation,a=o.find(function(e){return e.key===n}),s=b.includes(r);return!a||!a.allowInEditable&&s?!(a||i):(a.callback(e),e.preventDefault(),!1)},E=function(e){for(var t=y.length-1;t>=0;t--){if(!_(e,y[t]))break}},w=function(e){e.keyCode!==h.PRINT_SCREEN&&E(e)},S=function(e){e.keyCode===h.PRINT_SCREEN&&E(e)},O=function(e,t){0===y.length&&(window.document.addEventListener("keydown",w),window.document.addEventListener("keyup",S));var n={handlers:e,stopPropagation:t};return y.push(n),function(){return e=n,void(0===(y=y.filter(function(t){return e!==t})).length&&(window.document.removeEventListener("keydown",w),window.document.removeEventListener("keyup",S)));var e}},C=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.stopPropagation,n=e.handlers,r=Array.isArray(n)?n.slice():[n];this._unsubscribe=O(r,Boolean(t))},n.componentWillUnmount=function(){this._unsubscribe()},n.render=function(){return null},t}(a.Component),k=n(56),j=n(89),R=n(108),T=n(265),I=n(15),M=n(158),x=n.n(M),P=Object(s.a)("popup"),N=3,z={bottom:{vertical:!0,bottom:!0,center:!0},"bottom-right":{vertical:!0,bottom:!0,right:!0},"bottom-left":{vertical:!0,bottom:!0,left:!0},"right-bottom":{horizontal:!0,right:!0,bottom:!0},right:{horizontal:!0,right:!0,middle:!0},"right-top":{horizontal:!0,right:!0,top:!0},top:{vertical:!0,top:!0,center:!0},"top-right":{vertical:!0,top:!0,right:!0},"top-left":{vertical:!0,top:!0,left:!0},left:{horizontal:!0,left:!0,middle:!0},"left-bottom":{horizontal:!0,left:!0,bottom:!0},"left-top":{horizontal:!0,left:!0,top:!0}},L=[],D=function(e){function t(t){var n;return(n=e.call(this,t)||this)._arrow=void 0,n._popup=a.createRef(),n._popupSize=void 0,n._observer=void 0,n._repositionThrottled=void 0,n._getArrowDimensions=function(){if("tooltip"===n.props.type)return{diagonal:24,height:12};var e=n._arrow?10:0,t=Math.round(e*Math.sqrt(2));return{diagonal:t,height:t/2}},n._getPopupSize=function(){var e=n._popup.current.getBoundingClientRect(),t=n.props.getTarget(),r=n.props.isDropdown&&t?t.getBoundingClientRect().width:e.width;return{width:Math.round(r),height:Math.round(e.height)}},n._getTargetSize=function(){var e=n.props.getTarget();if(e instanceof HTMLElement)return{width:e.offsetWidth,height:e.offsetHeight};if(e&&"getBBox"in e){var t=e.getBBox();return{width:t.width,height:t.height}}return{width:0,height:0}},n._getTargetRect=function(){var e=n.props.getTarget();if(!e)return{top:0,right:0,bottom:0,left:0};var t=n._getTargetSize(),r=e.getBoundingClientRect(),o={top:r.top+A(),left:r.left+U()};return{top:o.top,right:o.left+t.width,bottom:o.top+t.height,left:o.left}},n._isTargetVisible=function(e,t){var r=t.top,o=t.right,i=t.bottom,a=t.left;if(!n.props.checkTargetVisibility)return!0;var s=a+(o-a)/2,c=r+(i-r)/2,u=window.document.elementFromPoint(s,c);return e.contains(u)},n._reposition=function(){var e=n.props,t=e.getTarget();if(e.isShown&&n._popup.current&&t){var r=n._getTargetRect();if(n._isTargetVisible(t,r)){var o=(e.offset?e.offset.main:0)+N,i=e.offset?e.offset.side:0,a=function(){var e=window.document.documentElement,t=U(),n=A(),r=e.clientWidth,o=e.clientHeight,i=Math.max(e.scrollHeight,o)-o;n>i&&(n=i);return{top:n,right:t+r,bottom:n+o,left:t}}(),s=n._getPopupSize(),c=n._getArrowDimensions(),u=!n._popupSize||n._popupSize.width!==s.width||n._popupSize.height!==s.height;n.props.onSizeChange&&u&&n.props.onSizeChange(s),n._popupSize=s;var l,d,p,f=-c.height,m=c.height/2,v=s.width*s.height,g=null,h=[];h=h.concat(n.props.position||"bottom"),e.restrictPosition||(h=h.concat(Object.keys(z)));for(var b=0;b<h.length;b++){var y=h[b],_=z[y],E={top:0,right:0,bottom:0,left:0},w={top:"auto",right:"auto",bottom:"auto",left:"auto"},S=void 0,O=e.arrowOffset||0,C=(e.positionOffsets||{})[y]||{main:0,side:0};if(_.horizontal){_.left?(E.left=r.left-s.width-c.height-o+C.main,w.right=f,S="left"):_.right&&(E.left=r.right+c.height+o+C.main,w.left=f,S="right"),_.middle?E.top=(r.top+r.bottom-s.height)/2+i+C.side:_.top?E.top=Math.max(r.bottom,(r.top+r.bottom+c.height)/2)+m-s.height-i+C.side:_.bottom&&(E.top=Math.min(r.top,(r.top+r.bottom-c.height)/2)-m+i+C.side);var k=(r.top+r.bottom-c.diagonal)/2-E.top+i+C.side+O;w.top=Math.min(Math.max(0,k),s.height-c.diagonal)}else if(_.vertical){_.top?(E.top=r.top-s.height-c.height-o+C.main,w.bottom=f,S="top"):_.bottom&&(E.top=r.bottom+c.height+o+C.main,w.top=f,S="bottom"),_.center?E.left=(r.left+r.right-s.width)/2+i+C.side:_.left?E.left=Math.max(r.right-s.width,(r.left+r.right+c.height)/2)+m-s.width-i+C.side:_.right&&(E.left=Math.min(r.left,(r.left+r.right-c.height)/2)-m+i+C.side);var j=(r.left+r.right-c.diagonal)/2-E.left+i+O+C.side;w.left=Math.min(Math.max(0,j),s.width-c.diagonal)}E.bottom=E.top+s.height,E.right=E.left+s.width;var R=(l=E,d=a,p=void 0,p=Math.max(0,Math.min(l.right,d.right)-Math.max(l.left,d.left))*Math.max(0,Math.min(l.bottom,d.bottom)-Math.max(l.top,d.top)),Math.round(p));if(e.isMinLeftZero&&E.left<0&&_.vertical&&("number"==typeof w.left&&(w.left+=E.left),E.left=0),(!g||R>g.square)&&(g={popupPos:{left:E.left,top:E.top},arrowPos:w,square:R,mainPos:S}),R===v)break}var T=g.popupPos,I={left:Math.floor(T.left),top:Math.floor(T.top)};n.props.isDropdown&&(I.width=n._getTargetSize().width);var M=T.top>0?a.bottom-T.top:void 0;n.setState({style:I,arrowStyle:g.arrowPos,position:g.mainPos,maxContentHeight:e.skipMaxHeight?void 0:M,isShown:!0,isTargetVisible:!0})}else n.setState({isTargetVisible:!1})}},n._onClose=function(e,t){n.props.onClose&&n.props.onClose({reason:t,event:e})},n._onClickOutside=function(e){n.props.isShown&&n._onClose(e,"click-outside")},n._onWindowChange=function(e){n._applyScrollEvent(e)},n._onScroll=function(e,t){t&&n._applyScrollEvent(t)},n._applyScrollEvent=function(e){n.props.isShown&&(n.props.onScroll&&"reposition"!==n.props.onScroll?n._onClose(e,"scroll"):n._repositionThrottled())},n._onEsc=function(e){n.props.isShown&&n._onClose(e,"esc")},n._onShow=function(){L.includes(Object(o.a)(n))||n.props.ninjaMode||L.push(Object(o.a)(n));var e=n._getPopupSize();n.state.isShown&&n._popupSize.width===e.width&&n._popupSize.height===e.height||n._reposition()},n._onHide=function(){L=L.filter(function(e){return e!==Object(o.a)(n)}),n.setState({style:{top:0,left:0},isShown:!1})},n._onHideEnd=function(){n._onHide(),n.props.onHideEnd&&n.props.onHideEnd()},n._getExcludedNodes=function(){var e=n.props,t=e.getExcludedNodes,r=e.hideOnTargetClick,o=e.getTarget,i=[],a=t&&t();a&&(i=i.concat(a));var s=r?null:o();return s&&(i=i.concat(s)),i},n._renderPopup=function(){var e=n.props,t=n.state,o=t.isTargetVisible?"visible":"hidden",i=e.noPointerEvents?"none":"auto",s=Object(r.a)({zIndex:e.zIndex,visibility:o,pointerEvents:i},t.style),c=e.type||"normal",u=P({type:c,position:t.position,dropdown:e.isDropdown,"full-height":e.fullHeight})+(e.className?" "+e.className:""),l=t.maxContentHeight?{maxHeight:t.maxContentHeight}:{};return a.createElement("div",{className:u,style:s,ref:n._popup,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},void 0===e.showArrow||e.showArrow?a.createElement("div",{className:P("arrow",{"arrow-type":e.arrowType}),style:t.arrowStyle,ref:function(e){return n._arrow=e||void 0}},"tooltip"!==c||e.arrowType?null:a.createElement(I.a,{url:x.a})):null,a.createElement("div",{className:P("content",{"full-height":e.fullHeight}),style:l},e.children),e.repositionOnContentResize?a.createElement(k.a,{onResize:n._repositionThrottled}):null,a.createElement(C,{handlers:{key:h.ESC,callback:n._onEsc,allowInEditable:!0}}))},n._repositionThrottled=Object(T.a)(n._reposition,50),n.state={style:{top:0,left:0},arrowStyle:{top:"auto",right:"auto",bottom:"auto",left:"auto"},position:"bottom",isShown:!1,isTargetVisible:!t.checkTargetVisibility},n}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this._observer="IntersectionObserver"in window?new IntersectionObserver(function(){e._repositionThrottled()}):void 0,this.props.checkTargetVisibility&&this._repositionThrottled();var t=this.props.getTarget();t&&this._observer&&this._observer.observe(t)},n.componentDidUpdate=function(e){this.props!==e&&this.props.isShown&&this._repositionThrottled()},n.componentWillUnmount=function(){var e=this;L=L.filter(function(t){return t!==e}),this._repositionThrottled.cancel(),this._observer&&this._observer.disconnect()},n.render=function(){return a.createElement(c.a,null,a.createElement(R.a,{onShow:this._onShow,onHideEnd:this._onHideEnd},this.props.isShown?a.createElement(v,{callback:this._onClickOutside,getExcludedNodes:this._getExcludedNodes},this._renderPopup()):null),a.createElement(g.a,{type:"resize",listener:this._onWindowChange,options:!0}),a.createElement(j.a,{eventHandler:this._onScroll,throttleWait:0}),a.createElement(g.a,{type:"orientationchange",listener:this._onWindowChange,options:!0}),a.createElement(g.a,{type:"layout-change",listener:this._onWindowChange}))},t}(a.Component);function A(){return window.document.documentElement.scrollTop||window.document.body.scrollTop}function U(){return window.document.documentElement.scrollLeft||window.document.body.scrollLeft}D.isShown=function(){return L.length>0};t.a=D},function(e,t,n){"use strict";var r=n(211),o=n(27);var i=n(65),a=n(223),s=n(121),c=n(86);function u(e,t){var n=Object(a.a)(e[0],t),r=n[0],o=n[1],i=Object(a.a)(e[1],t),s=i[0],c=i[1];return[[Math.min(r,s),Math.min(o,c)],[Math.max(r,s),Math.max(o,c)]]}n(264);n.d(t,"a",function(){return v}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return p});var l=23;function d(e,t,n,i,c){void 0===i&&(i=!0);var u=e.center,d=e.zoom,p=e.span,v=e.bounds,b=h(n,t);if(!d){var y=v||function(e){var t=e.center,n=e.span,i=Math.min(Math.max(t[1]*Math.PI/180,-Math.PI/2+o.i),Math.PI/2-o.i),a=Math.max(Math.min(n[1],180),0),s=a*Math.PI/180,c=o.j*Math.log(Math.tan(i/2+Math.PI/4)),u=Math.exp(2*c/o.j),l=(u+1)*Math.tan(Math.min(Math.max(s/2,-Math.PI/2+o.i),Math.PI/2-o.i)),d=-u,p=Math.max(l*l-4*d,0),f=(-l+Math.sqrt(p))/2*1,m=2*(Math.atan(f)-Math.PI/4)*180/Math.PI,v=n[0]/2;return[[Object(r.a)(t[0]-v),m],[Object(r.a)(t[0]+v),m+a]]}({center:u,span:p});d=function(e,t,n,r){void 0===r&&(r=0);var o=Object(s.a)(e,0),i=Math.max(Math.abs(o[1][0]-o[0][0]),1e-10),a=Math.max(Math.abs(o[1][1]-o[0][1]),1e-10),c=Math.min(Math.max(0,Math.min(g(t.width/i),g(t.height/a))),l);return n?Math.floor(c+r+1e-10):Math.round(100*c)/100}(y,b,i,c),u=function(e){return function(e,t,n){var r=Object(s.a)(e,t),o=r[0],i=o[0],c=o[1],u=r[1],l=u[0],d=u[1];return Object(a.a)([(i+l-(n[1]-n[3]))/2,(c+d-(n[0]-n[2]))/2],t)}(e,l,[0,0,0,0])}(y)}return{center:u,zoom:d,span:p=m(v=f(u,d,b)),bounds:v}}function p(e){var t=[e.center[0],e.center[1]],n=e.size,r=h({width:n.x,height:n.y},e.margin),o=f(t,e.zoom,r),i=m(o);return{center:t,zoom:e.zoom,span:i,bounds:o}}function f(e,t,n){var r=Object(i.a)(e,t),o=r[0],s=r[1],c=[[o-n.width/2,s+n.height/2],[o+n.width/2,s-n.height/2]];return[Object(a.a)(c[0],t),Object(a.a)(c[1],t,!1)]}function m(e){var t=e[0],n=t[0],r=t[1],o=e[1],i=o[0],a=o[1];return[Math.abs(i-n),Object(c.a)(a,r,r+360)-r]}function v(e,t){var n=Object(s.a)(e,l),r=Object(s.a)(t,l);return u([[Math.min(n[0][0],r[0][0]),Math.min(n[0][1],r[0][1])],[Math.max(n[1][0],r[1][0]),Math.max(n[1][1],r[1][1])]],l)}function g(e){return Math.log(e)*Math.LOG2E}function h(e,t){return{width:Math.max(e.width-(t?t[1]+t[3]:0),1),height:Math.max(e.height-(t?t[0]+t[2]:0),1)}}},function(e,t,n){"use strict";var r=n(6),o=n(58),i=n(222),a=Object(i.a)(Object.getPrototypeOf,Object),s=n(53),c="[object Object]",u=Function.prototype,l=Object.prototype,d=u.toString,p=l.hasOwnProperty,f=d.call(Object);var m=function(e){if(!Object(s.a)(e)||Object(o.a)(e)!=c)return!1;var t=a(e);if(null===t)return!0;var n=p.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&d.call(n)==f};t.a=function e(t,n){var o=Object(r.a)({},t);return Object.entries(n).forEach(function(t){var n=t[0],r=t[1];o.hasOwnProperty(n)&&m(r)?o[n]=e(o[n],r):o[n]=r}),o}},function(e,t,n){"use strict";var r=n(61),o=n(6),i=n(458),a=n(55),s=n(72);var c=n(454),u=n(37),l=n(36),d="search_",p="",f={fetch:function(e,t){return Object(u.a)("search",{query:v(e,t)},t).then(function(e){return p=e.requestId,e})},batchFetch:function(e,t){var n={requestQueries:e.map(function(e){return v(e,t)})};return Object(u.a)("search/batch",{body:n},t).then(function(e){var t,n=null===(t=e.find(function(e){return Boolean(e)}))||void 0===t?void 0:t.requestId;return n&&(p=n),e})},fetchSearchResult:function(e,t,n){if(void 0===n&&(n={}),"poi"===e.from){if(e.uri)return f.loadPoiByUri(e.uri,t,n).then(function(t){return Object(o.a)(Object(o.a)({},t),{},{items:t.items.map(function(t,n){return Object(o.a)(Object(o.a)({},t),{},{hotspotProperties:e.hotspotProperties,displayCoordinates:e.coordinates&&0===n?e.coordinates:t.displayCoordinates})})})});if(e.coordinates)return f.loadPoiByCoordinates(e.coordinates,t,n).then(function(t){if(l.i(e.hotspotProperties)){var n=t.items[0],r={title:"Парковка",description:n.address,hotspotProperties:e.hotspotProperties,id:n.id,type:n.type,kind:n.kind,requestId:n.requestId,analyticsId:n.analyticsId,address:n.address,coordinates:n.coordinates,displayCoordinates:n.displayCoordinates,encodedCoordinates:n.encodedCoordinates,stops:n.stops,panorama:n.panorama,photos:n.photos,uri:n.uri};t.items=[r]}return t})}if("whatshere"===e.from)return f.loadWhatshere(e,t);var r=Object(o.a)(Object(o.a)({},e),{},{count:1,searchType:"TEXT"});return r.uri&&(r.mode="uri"),f.fetch(r,t)},prepareChainSearchRequest:function(e,t){return f.fetch({count:1,kind:"locality",text:Object(i.a)(e.center,{reverse:!0}),origin:"chain-city"},t).then(function(t){var n={searchType:"TEXT",displayText:e.chain.name,text:"chain_id:("+e.chain.id+")",origin:e.origin||"chain"},r=t.bounds;if(r){var o=function(e){var t=e[0][1],n=[e[1][0]-e[0][0],e[1][1]-t],r=Math.tan(Object(a.a)(t+90)/2),o=Math.tan(Object(a.a)(n[1])/2),i=Math.max((-r*r-r*o)/(r*o-1),0),c=.5*Math.log(i),u=2*(Math.atan(Math.exp(c))-.25*Math.PI);return{center:[(e[0][0]+e[1][0])/2,Object(s.a)(u)],span:n}}(r);n.center=o.center,n.span=o.span}return n})},loadPoiByCoordinates:function(e,t,n){return void 0===n&&(n={}),f.fetch({text:Object(i.a)(e,{reverse:!0}),count:1,origin:n.origin||"poi",clientId:n.clientId,snippets:m(t)},t)},loadPoiByUri:function(e,t,n){return void 0===n&&(n={}),f.fetch({mode:"uri",uri:e,count:1,origin:n.origin||"poi",clientId:n.clientId,snippets:m(t)},t)},loadWhatshere:function(e,t){var n=e.origin,o=Object(r.a)(e,["origin"]);return f.fetch({pin:!0,text:Object(i.a)(o.coordinates,{reverse:!0}),zoom:o.zoom,span:[.001,.001],count:1,origin:n||"poi",addBuildingGeometry:e.addGeometry},t).then(function(e){var t=e.items[0];return t?("poi"===n&&(t.displayCoordinates=t.coordinates),e):null}).catch(function(){return null})}};function m(e){return e.search.snippets.filter(function(e){return"related_adverts/1.x"!==e&&"related_adverts_1org/1.x"!==e})}function v(e,t){var n=e.clientId||"maps",r=e.origin?n+"-"+e.origin:n,a={text:e.text,lang:t.locale,yandex_gid:t.userRegion.id,client_id:e.clientId,origin:r,results:e.count,ctx:e.context,mode:e.mode,lr:e.lr,uri:e.uri,business_oid:Array.isArray(e.id)?e.id.join(","):e.id,z:e.zoom,sort:e.sort,business_filter:e.filters,autoscale:e.autoscale,distinguish_layers:e.distinguishLayers,correct_misspell:e.correctMisspell,geocoder_kind:e.kind,skip:e.skip,rspn:e.restrictSpan,rearr:e.rearr,groupchains_advert:e.groupchains_advert,relev_ranking_formula:e.relev_ranking_formula,maxadv:e.maxadv,eventsBranch:t.query.eventsBranch};return e.addBuildingGeometry&&(a.search_geometry="2"),e.sortOrigin&&(a.sort_origin=e.sortOrigin.join()),e.center&&(a.ll=e.center.join()),e.span&&(a.spn=e.span.join()),e.bbox&&(a.bbox=e.bbox.join("~")),e.snippets?a.snippets=e.snippets:a.snippets=t.search.snippets,t.experiments.ui.groupSameCompanies&&(a.snippets=a.snippets.concat("collapsed_orgs/1.x")),t.experiments.ui.geosearchPinPriority&&(a.snippets=a.snippets.concat("pin_priority/1.x")),a.snippets=a.snippets.join(),e.direct&&(a=Object(o.a)(Object(o.a)({},a),t.advert.direct.params)),e.pin&&(a.geocoder_pin=1),e.type&&(a.type=e.type.join()),e.routeCoordinates&&e.bounds&&e.routeCoordinates.some(function(t){return Object(c.a)(e.bounds,t)})&&(a.business_rll=e.routeCoordinates.map(function(e){return Object(i.a)(e,{fractionDigits:5})}).join("~")),e.clientUsecase&&(a.client_usecase=e.clientUsecase),e.suggestReqid&&"form"===e.origin&&(a.suggest_reqid=e.suggestReqid),e.serpId&&(a.serpid=e.serpId),(e.parentReqId||p||t.searchPreloadedResults)&&(a.parent_reqid=e.parentReqId||p||t.searchPreloadedResults.requestId),e.geoWhere&&(a.geowhere=[].concat(e.geoWhere).reverse().join()),e.businessMode&&(a.business_mode=e.businessMode),"boolean"==typeof e.businessShowClosed&&(a.business_show_closed=e.businessShowClosed?1:0),Object(o.a)(Object(o.a)(Object(o.a)({},a),e.rawParams),function(e){var t=Object(o.a)({},e.experiments.geoSearchParams||{});e.experiments.ui.centralBankCollaboration&&(t.search_experimental_business_show_exp_features="cbrf");var n=e.experiments.boxes;n&&(t["test-buckets"]=n);return Object.keys(e.query).forEach(function(n){n.startsWith(d)&&(t[n]=e.query[n])}),t}(t))}t.a=f},function(e,t,n){"use strict";var r=function(e){return e.split("")},o=n(47),i="[\\ud800-\\udfff]",a="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",c="[^\\ud800-\\udfff]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",d="(?:"+a+"|"+s+")"+"?",p="[\\ufe0e\\ufe0f]?"+d+("(?:\\u200d(?:"+[c,u,l].join("|")+")[\\ufe0e\\ufe0f]?"+d+")*"),f="(?:"+[c+a+"?",a,u,l,i].join("|")+")",m=RegExp(s+"(?="+s+")|"+f+p,"g");var v=function(e){return e.match(m)||[]};t.a=function(e){return Object(o.a)(e)?v(e):r(e)}},function(e,t,n){"use strict";var r=n(69);var o=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},i=n(40),a=n(68),s=1/0,c=r.a?r.a.prototype:void 0,u=c?c.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(i.a)(t))return o(t,e)+"";if(Object(a.a)(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},function(e,t,n){"use strict";var r=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i};t.a=function(e,t,n){var o=e.length;return n=void 0===n?o:n,!t&&n>=o?e:r(e,t,n)}},,,function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r=["overview","menu","prices","inside","posts","gallery","reviews","edadeal","related","booking","events","realty","features","infrastructure"],o=["overview","services","inside","attractions"]},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=6e4;function o(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();t.setSeconds(0,0);var o=t.getTime()%r;return n*r+o}},function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(134),o=n(55),i=n(86),a=n(27),s=n(87),c=n(88);function u(e){return Math.abs(e-Object(c.a)(e)*Math.PI/2)<a.i?Object(c.a)(e)*Math.PI/2:Math.atan((1-a.b)*Math.tan(e))}function l(e,t,n){return function(o){var i=Object(r.a)(e,t,n*o);return{point:i.endPoint,direction:i.endDirection}}}function d(e,t,n){if(e===t||e[0]===t[0]&&e[1]===t[1]){var r=[1,1];return{startPoint:e,startDirection:r,endPoint:t,endDirection:r,distance:0,pathFunction:l(e,r,0)}}e[1]=Object(s.a)(e[1]),t[1]=Object(s.a)(t[1]);var d,p,f,m=Object(o.a)(e[1]),v=Object(o.a)(t[1]),g=Object(o.a)(t[0]-e[0]),h=u(m),b=u(v),y=g,_=y,E=0,w=0;if(0===m&&0===v){var S=Object(i.a)(t[0]-e[0],n?-360:-180,n?360:180);f=[(p=[S>0?1:-1,0])[0],p[1]],w=2*Math.PI*a.j/360*Math.abs(S)}else{var O=void 0,C=void 0,k=void 0,j=void 0,R=void 0,T=void 0,I=void 0;do{O=Math.sqrt(Math.pow(Math.cos(b)*Math.sin(y),2)+Math.pow(Math.cos(h)*Math.sin(b)-Math.sin(h)*Math.cos(b)*Math.cos(y),2)),C=Math.sin(h)*Math.sin(b)+Math.cos(h)*Math.cos(b)*Math.cos(y),R=n?2*Math.PI-Math.atan2(O,C):Math.atan2(O,C),k=Math.cos(h)*Math.cos(b)*Math.sin(y)/Math.sin(R),j=1-Math.pow(k,2),T=Math.cos(R)-2*Math.sin(h)*Math.sin(b)/j,I=a.b/16*j*(4+a.b*(4-3*j)),y=Math.min(Math.max(g+(1-I)*a.b*k*(R+I*Math.sin(R)*(T+I*Math.cos(R)*(2*T*T-1))),-2*Math.PI),2*Math.PI),d=Math.abs(_-y),_=y,E++}while(d>a.i&&E<10);var M=j*(a.j*a.j-a.l*a.l)/(a.l*a.l),x=1+M*(4096+M*(M*(320-175*M)-768))/16384,P=M*(256+M*(M*(74-47*M)-128))/1024,N=P*Math.sin(R)*(T+.25*P*(Math.cos(R)*(2*T*T-1)-1/6*P*T*(4*Math.sin(R)*Math.sin(R)-3)*(4*T*T-3))),z=Math.atan2(Math.cos(b)*Math.sin(y),Math.cos(h)*Math.sin(b)-Math.sin(h)*Math.cos(b)*Math.cos(y)),L=Math.atan2(Math.cos(h)*Math.sin(y),-Math.sin(h)*Math.cos(b)+Math.cos(h)*Math.sin(b)*Math.cos(y));w=a.l*x*(R-N),n&&(z-=Object(c.a)(z-Math.PI)*Math.PI,L-=Object(c.a)(L-Math.PI)*Math.PI),p=[Math.sin(z),Math.cos(z)],f=[Math.sin(L),Math.cos(L)]}return{startPoint:e,startDirection:p,endPoint:t,endDirection:f,distance:w,pathFunction:l(e,p,w)}}},function(e,t,n){"use strict";var r=n(73),o=n(4),i=n(2),a=n(3),s=n(91),c=function(e){function t(t){var n;return(n=e.call(this,t)||this)._node=null,n._getNode=function(){var e=a.findDOMNode(Object(r.a)(n));return e instanceof Element?e:null},n._addListeners=function(e){Object(s.a)().events.animationEnd&&e.addEventListener(Object(s.a)().events.animationEnd,n._onHideAnimationEnd),Object(s.a)().events.transitionEnd&&e.addEventListener(Object(s.a)().events.transitionEnd,n._onHideAnimationEnd)},n._removeListeners=function(e){Object(s.a)().events.animationEnd&&e.removeEventListener(Object(s.a)().events.animationEnd,n._onHideAnimationEnd),Object(s.a)().events.transitionEnd&&e.removeEventListener(Object(s.a)().events.transitionEnd,n._onHideAnimationEnd),e.classList.remove("_animation-hide")},n._onHideAnimationEnd=function(e){var t=e.currentTarget;n._removeListeners(t),n._node=null,n.setState({content:null},n.props.onHideEnd)},n.state={content:t.children},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.children&&this.setState({content:this.props.children},this.props.onShow)},n.componentDidUpdate=function(e){var t=this.props.children;if(t)t!==e.children&&(this._node&&(this._removeListeners(this._node),this._node=null),this.setState({content:t},this.state.content?void 0:this.props.onShow));else{var n=this._getNode();n&&(this._addListeners(n),this._node=n,n.classList.add("_animation-hide")),this.props.onHideStart&&this.props.onHideStart()}},n.componentWillUnmount=function(){this._node&&this._removeListeners(this._node)},n.render=function(){return this.state.content},t}(i.Component);t.a=c},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(157),o=n.n(r),i=n(59);function a(e){var t=function(e){var t,n,r=null!==(t=null===(n=e.szm)||void 0===n?void 0:n.value.split(":"))&&void 0!==t?t:[],o=r[0],i=r[2];if(o&&i){var a=i.split("x"),s=a[0],c=a[1],u=Number(o.replace("_",".")),l=Number(s),d=Number(c);if(!(isNaN(u)||isNaN(l)||isNaN(d)))return{devicePixelRatio:u,viewport:{width:l,height:d}}}}(e);if(t)return{display:t}}function s(e){var t=i.a.get("yp",e);return t?a(o.a.parseYpCookie(t)):void 0}},function(e,t,n){"use strict";t.a=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],o=t[1],i=n[0]-r,a=n[1]-o,s=i*i+a*a,c=0;0!==s&&(c=((e[0]-r)*i+(e[1]-o)*a)/s,c=Math.max(0,Math.min(1,c)));var u=r+c*i,l=o+c*a,d=e[0]-u,p=e[1]-l;return Math.sqrt(d*d+p*p)}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",function(){return o})},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(6),o=n(39);function i(e){var t=function(t,n,r,i){var u=e.replace("{{x}}",String(t)).replace("{{y}}",String(n)).replace("{{z}}",String(r)).replace("{{scale}}","1").replace(/\{\{d\|(\d+)\}\}/,function(e,o){return String((t+n+r)%Number(o)+1)});return Object(o.a)({url:u,signal:i}).then(function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){return[]}return!e||e.error&&404===e.error.code?[]:e.data.features.map(function(e){var t=e.properties.HotspotMetaData.RenderedGeometry;return{type:"rendered",feature:c(e),geometry:"Polygon"===t.type?a(t):s(t)}})})};return t.template=e,t}function a(e){return{type:"Polygon",coordinates:e.coordinates.map(function(e){return e.map(function(e){return{x:e[0],y:e[1]}})})}}function s(e){return{type:"MultiPolygon",coordinates:e.coordinates.map(function(e){return e.map(function(e){return e.map(function(e){return{x:e[0],y:e[1]}})})})}}function c(e){var t,n=e.properties.URIMetaData,o=null===(t=e.properties.HotspotMetaData)||void 0===t?void 0:t.id;return{type:"Feature",id:o?String(o):"",geometry:e.geometry,properties:Object(r.a)(Object(r.a)({},e.properties),{},{uri:(n&&n.URIs[0]||{}).uri})}}},,,,,,,function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}n.d(t,"a",function(){return o})},,,function(e,t,n){"use strict";var r=n(105),o=["overview","timetable","reviews"],i=["stops","timetable"];function a(e){if("services"!==e&&"attractions"!==e)return function(e){return r.a.includes(e||"")}(e)||l(e)?e:void 0}n.d(t,"d",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return d});var s=["overview","related","inside","infrastructure"];function c(e){return!s.includes(e)}function u(e){return Boolean(e&&"reviews"===e)}function l(e){return r.b.includes(e||"")}function d(e){return o.includes(e||"")}function p(e){return d(e)?e:void 0}function f(e){return function(e){return i.includes(e||"")}(e)?e:void 0}function m(e){return e&&"panorama"!==e?e:"overview"}function v(e){return e&&"panorama"!==e&&"gallery"!==e?e:"overview"}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(55),o=n(27),i=n(72),a=n(87),s=n(88);function c(e,t,n){e[1]=Object(a.a)(e[1]);var c=Object(r.a)(e[1]),u=Object(r.a)(e[0]),l=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),d=t[1]/l,p=t[0]/l,f=(1-o.b)*Math.tan(c),m=Object(s.a)(Math.cos(c))*Math.sqrt(1/(1+f*f)),v=Math.sqrt(1-m*m)*Object(s.a)(f),g=Math.atan2(f,d),h=m*p,b=(1-h)*(1+h),y=b*(o.j*o.j/(o.l*o.l)-1),_=1+y*(4096+y*(y*(320-175*y)-768))/16384,E=y*(256+y*(y*(74-47*y)-128))/1024,w=function(e){var t,r=n*e,a=r/(o.l*_),s=g+a/2,c=Math.cos(2*s),l=0,f=0;do{var y=E*Math.sin(a)*(c+.25*E*(Math.cos(a)*(2*c*c-1)-1/6*E*c*(4*Math.sin(a)*Math.sin(a)-3)*(4*c*c-3)));t=y-f,f=y,a=r/(o.l*_)+y,l++}while(Math.abs(t)>o.i&&l<10);var w=v*Math.sin(a)-m*Math.cos(a)*d,S=Math.atan2(v*Math.cos(a)+m*Math.sin(a)*d,(1-o.b)*Math.sqrt(h*h+w*w)),O=Math.atan2(Math.sin(a)*p,m*Math.cos(a)-v*Math.sin(a)*d),C=o.b/16*b*(4+o.b*(4-3*b)),k=O-(1-C)*o.b*h*(a+C*Math.sin(a)*(c+C*Math.cos(a)*(2*c*c-1))),j=Math.atan2(h,-v*Math.sin(a)+m*Math.cos(a)*d);return{point:[Object(i.a)(u+k),Object(i.a)(S)],direction:[Math.sin(j),Math.cos(j)]}},S=w(1);return{startPoint:e,startDirection:t,endPoint:S.point,endDirection:S.direction,distance:n,pathFunction:w}}},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/1d977174b325461b1950173f72485cde.svg"},function(e,t,n){e.exports=n.p+"_/a58d92f3a15af43423f3154908182ee3.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){"use strict";function r(e){try{return decodeURIComponent(e)}catch(t){return""}}t.parseYpCookie=function(e){return e.split("#").reduce(function(e,t){var n=t.split(".");return 3===n.length&&(e[n[1]]={value:r(n[2]),expire:new Date(1e3*Number(n[0]))}),e},{})}},function(e,t,n){e.exports=n.p+"_/c467c7f6b9f09c87cbfd332f54c592c3.svg"},function(e,t){},function(e,t,n){e.exports=n.p+"_/4456c10ecbf5d583bdeb1c3d97ef263a.svg"},function(e,t,n){e.exports=n.p+"_/8ae41e545e0b7d0739c75619398b63bf.svg"},function(e,t,n){e.exports=n.p+"_/9659bbe9fa69477d2a166dabea8ac48d.svg"},function(e,t,n){e.exports=n.p+"_/c61b31295f839ad5761ab64c54f182f0.svg"},function(e,t,n){e.exports=n.p+"_/80c1d1903a722b7ff4ece5dbb64f1f8b.svg"},function(e,t,n){e.exports=n.p+"_/55e8586f6ee1e236775eeb5de3a7d7c8.svg"},function(e,t,n){e.exports=n.p+"_/526b632dc5485eae718acc1a54c8e8b1.svg"},function(e,t,n){e.exports=n.p+"_/c9504bc15d493d33a35111cc69ac6b8a.svg"},function(e,t,n){e.exports=n.p+"_/9f79510c62081a2e8295f974516febd3.svg"},function(e,t,n){e.exports=n.p+"_/33d6b319940be8c3dc7e251a2478efb4.svg"},function(e,t,n){e.exports=n.p+"_/3087f8a7f898f2764b4242a8185f964c.svg"},function(e,t,n){e.exports=n.p+"_/6bf7bf56354d5d2326dcb5d26ccb315f.svg"},function(e,t,n){e.exports=n.p+"_/78fd7e5f9b721a273df35726afb8f72c.svg"},function(e,t,n){e.exports=n.p+"_/4ad220f6afa0590a01904bc61bd8c23a.svg"},function(e,t,n){e.exports=n.p+"_/495897677a950e88ac35bee6acd284f7.svg"},function(e,t,n){e.exports=n.p+"_/455ccd488d8c0aee406d8e8cc689c013.svg"},function(e,t,n){e.exports=n.p+"_/d1dade09981e7cd402c01e1cbcd07475.svg"},function(e,t,n){e.exports=n.p+"_/30dc3931380c1d46fd4ce2e7afaf74e0.svg"},function(e,t,n){e.exports=n.p+"_/fb41b675b9ab147c27b75c1787065148.svg"},function(e,t,n){e.exports=n.p+"_/9f7ea1b9a3434256ba04e9331ebdffe6.svg"},function(e,t,n){e.exports=n.p+"_/54b25b1e22891fc5b5e44daeb089bb9f.svg"},function(e,t,n){e.exports=n.p+"_/7c30015b48e6f4b35c98ba80bb2e24e1.svg"},function(e,t,n){e.exports=n.p+"_/ef59ddb0d5aadae108503cc19c21eef5.svg"},function(e,t,n){e.exports=n.p+"_/dc75aa5ed94b5eb5368064618c4b63e4.svg"},function(e,t,n){e.exports=n.p+"_/7906239a768ecb03bb8133d1113665e0.svg"},function(e,t,n){e.exports=n.p+"_/8524a9d19c44f5446185899c40673241.svg"},function(e,t,n){e.exports=n.p+"_/5634030eb07d818066e71e0501977871.svg"},function(e,t,n){e.exports=n.p+"_/0781e4c2e4d6e030c6f7253e95446159.svg"},function(e,t,n){e.exports=n.p+"_/a70a4c329abea46a3e6b42fdc0b921dc.svg"},function(e,t,n){e.exports=n.p+"_/a36eb164dbb30d75d93941b5d14be75f.svg"},function(e,t,n){e.exports=n.p+"_/a80cd0e70d8d6c04344692ffc29e59ce.svg"},function(e,t,n){"use strict";n(192);var r=n(2),o=n(5),i=n(24),a=n(30),s=Object(o.a)("map-widget-in-maps-button");t.a=function(e){var t=r.createElement(a.a,{name:"logo",size:24,inline:!0,className:s("icon")});return r.createElement(i.a,{view:"air",size:"small",icon:t,url:e.url,target:"_blank"},e.children)}},function(e,t,n){},,function(e,t,n){"use strict";function r(e){return!1}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(8);function o(e){var t=e.getLayers(),n=t.topRasterLayers,o=t.mainLayers;return Object(r.c)(Object(r.c)([],n,!0),o,!0).map(function(e){return e.split(":")[0]}).filter(function(e,t,n){return t===n.indexOf(e)}).map(function(t){var n,r=e.getDataSource(t);return"tile"===(null==r?void 0:r.type)&&(null===(n=null==r?void 0:r.copyrights)||void 0===n?void 0:n.join(" "))}).filter(Boolean).join(" ")}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="hidden"},,,,,,,function(e,t,n){"use strict";n(135),n(137);var r=n(2),o=n(5),i=n(7),a=n(24),s=n(50),c=n(19),u=n(92),l=n.n(u),d=n(93),p=n.n(d),f=(n(159),Object(o.a)("zoom-control"));t.a=Object(i.b)(function(e){return r.createElement("div",{className:f()},r.createElement("div",{className:f("group")},r.createElement("div",{className:f("zoom-in")},r.createElement(s.a,{text:"Приблизить",position:"left",isDisabled:e.disabledZoomIn,isAir:!0},r.createElement(c.a,{name:"zoom_in",logClick:!0},r.createElement(a.a,{view:"air",size:e.size||"medium",icon:r.createElement("div",{className:f("icon"),dangerouslySetInnerHTML:{__html:l.a}}),onClick:e.onZoomIn,disabled:e.disabledZoomIn,pinBottom:!0})))),r.createElement("div",{className:f("zoom-out")},r.createElement(s.a,{text:"Отдалить",position:"left",isDisabled:e.disabledZoomOut,isAir:!0},r.createElement(c.a,{name:"zoom_out",logClick:!0},r.createElement(a.a,{view:"air",size:e.size||"medium",icon:r.createElement("div",{className:f("icon"),dangerouslySetInnerHTML:{__html:p.a}}),onClick:e.onZoomOut,disabled:e.disabledZoomOut,pinTop:!0}))))))})},,function(e,t,n){"use strict";var r=n(102),o=n(47),i=n(100),a=n(46);var s=function(e){return function(t){t=Object(a.a)(t);var n=Object(o.a)(t)?Object(i.a)(t):void 0,s=n?n[0]:t.charAt(0),c=n?Object(r.a)(n,1).join(""):t.slice(1);return s[e]()+c}}("toUpperCase");t.a=s},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(27);function o(e,t,n){void 0===n&&(n=!0);var o=Math.pow(2,t+8),i=n?e[0]%o:e[0],a=2*Math.atan(Math.exp(Math.PI*(1-2*e[1]/o)))-.5*Math.PI;return[360*i/o-180,180*(a+r.c*Math.sin(2*a)+r.d*Math.sin(4*a)+r.e*Math.sin(6*a)+r.f*Math.sin(8*a))/Math.PI]}},function(e,t){var n,r=Object({}).crypto||Object({}).msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var i=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}e.exports=n},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]}},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return u});var r=n(8),o=n(14),i="__empty__",a="default";function s(e){var t={id:e.id,source:e.source?e.source:i,type:e.type?e.type:a,options:{raster:{},vector:{}}};return e.options&&(e.options.raster&&(t.options.raster=Object(r.a)({},e.options.raster)),e.options.vector&&(t.options.vector=Object(r.a)({},e.options.vector))),t}var c=/^(\w+)?(?::(\w+)(?:\((.*)\))?)?$/;function u(e,t){var n=e.match(c);n&&0!==n[0].length||Object(o.c)(new Error("Bad string layer spec '"+e+"'"));for(var i=n[1],a=n[2],s=n[3],u=s?s.split(","):[],l=Object.create(null),d=0,p=u;d<p.length;d++){l[p[d]]=!0}return{id:e,source:i,type:a,options:{raster:Object(r.a)(Object(r.a)({},l),null==t?void 0:t.raster),vector:Object(r.a)(Object(r.a)({},l),null==t?void 0:t.vector)}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(52),o=Object(r.a)("mapFeatureGroup",{}),i=o.connect,a=o.Provider;t.b=i},function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.385 12.42l16.01-7.614a.6.6 0 0 1 .8.8l-7.616 16.009a.6.6 0 0 1-1.11-.068l-2.005-6.011-6.01-2.004a.6.6 0 0 1-.069-1.111z" fill="currentColor"/></svg>'},function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 12c0 5.523 4.477 10 10 10s10-4.477 10-10-4.477-10-10-10-10 4.477-10 10z" fill="#CCC"/><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 12c0 5.523 4.477 10 10 10s10-4.477 10-10-4.477-10-10-10-10 4.477-10 10zm18.333 0a8.333 8.333 0 1 1-16.666 0 8.333 8.333 0 0 1 16.666 0z" fill="#000"/><path d="M9.75 2h2.5c5.514 0 10 4.486 10 10a5.605 5.605 0 0 1-3.976-1.65c-1.018-1.018-1.68-2.104-3.22-3.906C13.694 4.857 11.818 3.25 9.75 3.25c-4.136 0-7.5 3.926-7.5 8.75C1.456 11.059 1 10.005 1 8.875 1 5.085 3.547 2 9.75 2z" fill="#000"/></svg>'},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(6),o=n(4),i=n(2),a=n(97),s=n(22),c=n(23),u=n(41),l=n(460);function d(e){return e.split("~").reduce(function(e,t){var n=t.split(","),r=n[0],o=n[1],i=n[2],a=n.slice(3),s=Object(l.a)(r+","+o);return!o||a.length>0||!s?e:(e.push({coordinates:s,color:i}),e)},[])}var p=n(28),f=n(98),m=n(238),v=n(26),g=n.n(v),h=n(126),b=["","permission_denied","position_unavailable","timeout"],y=function(e){this.code=void 0,this.message=void 0,this.message=e,this.code=b.indexOf(e)},_=6e4,E={ERROR_TYPES:b,getCurrentPosition:function(e,t,n){var r,o;return void 0===n&&(n=_),"denied"===(null===(r=t.query.mocks)||void 0===r?void 0:r.geolocation)?Promise.reject({code:1}):"unavailable"===(null===(o=t.query.mocks)||void 0===o?void 0:o.geolocation)?Promise.reject({code:2}):(e.logEvent("geolocation_request"),S({timeout:n}).then(function(n){var r,o,i=n.coords;e.logEvent("geolocation_success",{accuracy:i.accuracy});var a=C(null===(r=t.query.mocks)||void 0===r?void 0:r.geolocation),s=a?{accuracy:null!==(o=a.accuracy)&&void 0!==o?o:i.accuracy,latitude:a.latitude,longitude:a.longitude,altitude:null,altitudeAccuracy:null,heading:null,speed:null}:i;return w(s,t),s}).catch(function(t){throw e.logEvent("geolocation_fail",{type:E.ERROR_TYPES[t.code]}),t}))},watchPosition:function(e,t,n,o){var i,a;if(void 0===o&&(o=_),"denied"===(null===(i=n.query.mocks)||void 0===i?void 0:i.geolocation))return e.onError("permission_denied"),0;if("unavailable"===(null===(a=n.query.mocks)||void 0===a?void 0:a.geolocation))return e.onError("position_unavailable"),0;t.logEvent("geolocation_watch_request");var s,c,u,l,d,p,f=!1;return s=function(r){var o,i;f||(t.logEvent("geolocation_watch_success",{accuracy:r.coords.accuracy}),f=!0);var a=C(null===(o=n.query.mocks)||void 0===o?void 0:o.geolocation),s=a?{accuracy:null!==(i=a.accuracy)&&void 0!==i?i:r.coords.accuracy,latitude:a.latitude,longitude:a.longitude,altitude:null,altitudeAccuracy:null,heading:null,speed:null}:r.coords;w(s,n),e.onSuccess(s)},c=function(n){var r=E.ERROR_TYPES[n.code];f||(t.logEvent("geolocation_watch_fail",{type:r}),f=!0),e.onError(r)},u={timeout:o},(null===(l=window.yandex)||void 0===l?void 0:null===(d=l.mapsApp)||void 0===d?void 0:d.getCurrentUserLocation)?window.setInterval(function(){return S(u).then(s).catch(c)},null!==(p=null==u?void 0:u.timeout)&&void 0!==p?p:_):window.navigator.geolocation.watchPosition(s,c,Object(r.a)({enableHighAccuracy:!0},u))},clearWatch:function(e){var t,n;(null===(t=window.yandex)||void 0===t?void 0:null===(n=t.mapsApp)||void 0===n?void 0:n.getCurrentUserLocation)?window.clearInterval(e):window.navigator.geolocation.clearWatch(e)},checkPermission:function(){return window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(function(e){return e.state}):Promise.resolve(void 0)}};function w(e,t){e&&(e.accuracy>5e3||((new window.Image).src=t.morda.url+"/gpsave?"+v.stringify({sk:t.xscriptCsrfToken,lat:e.latitude,lon:e.longitude,precision:e.accuracy})))}function S(e){var t,n,o,i=null===(t=window.yandex)||void 0===t?void 0:null===(n=t.mapsApp)||void 0===n?void 0:n.getCurrentUserLocation;return i?Promise.race([i().then(function(e){return"string"==typeof e?JSON.parse(e):e}).catch(function(){throw new y("position_unavailable")}),h.a(null!==(o=null==e?void 0:e.timeout)&&void 0!==o?o:_).then(function(){throw new y("timeout")})]):new Promise(function(t,n){return window.navigator.geolocation.getCurrentPosition(t,n,Object(r.a)({enableHighAccuracy:!0},e))})}var O=/^\d+\.?(\d+)?,\d+\.?(\d+)?(,\d+)?$/;function C(e){if(O.test(e)){var t=e.split(",").map(Number);return{latitude:t[0],longitude:t[1],accuracy:t[2]}}}var k=E,j=n(39),R=n(37),T={getRoadEvents:function(e,t){return Object(R.a)("traffic/getRoadEvents",{query:{id:e}},t)},getRoadEvent:function(e,t){return Object(R.a)("traffic/getRoadEvent",{query:{eventId:e}},t)},getForecast:function(e,t){return Object(R.a)("traffic/getForecast",{query:{id:e}},t)},actual:{getLevel:function(e,t){return Object(R.a)("traffic/getLevelInfo",{query:{ids:e}},t)}},archive:{getMetaData:function(e,t,n){return Object(j.a)({url:n.hosts.trafficArchive+"description/traffic-light",query:{tm:t,ids:e.join(","),l:n.locale},jsonp:!0}).then(function(t){var n=(t.data.features||[]).find(function(t){var n=t.properties;return Boolean(n&&n.HotspotMetaData&&e.includes(n.HotspotMetaData.id))});if(!n)return{level:null};var r=n.properties&&n.properties.JamsMetaData.level;return{level:void 0!==r?r:null}})}}},I=n(7),M=n(63),x=n.n(M);function P(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}var N=n(264),z=n(29),L=n(105),D=F(L.a),A=F(L.b),U={orgpage:[].concat(D,["panorama"]),whatshere:[].concat(A,["panorama","gallery"])};function F(e){return e.filter(function(e){return"overview"!==e})}function q(e,t){return!!t&&U[e].includes(t)}function B(e,t){if("sublanding"in t&&q(e,t.sublanding))return t.sublanding}var H=n(36),W=n(210),G=n(194);function Y(e,t){var n=e.chain,r=t.mapLocation,o=r.center,i=r.span,a=r.zoom,s=V({searchType:"TEXT",text:n?"chain_id:("+n+")":e.text&&String(e.text),displayText:n?e.text:e["display-text"],correctMisspell:e.noreask?0:void 0,origin:e.source||"url",center:Object(l.a)(e.sll)||o,span:Object(l.a)(e.sspn)||i,zoom:parseInt(e.z,10)||a,sort:e.sort,context:e.sctx,filters:e.filter?e.filter.split(";"):void 0},t),c=s[0];if(c&&Object(G.a)(t)&&(c.request.snippets=t.search.snippets.filter(function(e){return"related_adverts/1.x"!==e}),c.request.maxadv=0),c&&e.debug.includes("bounds")&&(c.showDebugBounds=!0),c){var u=H.k(c)?c.results:void 0;if(W.b(null==u?void 0:u.filters)){var d=t.mapLocation;c.mapLocationRequest={center:d.center,zoom:d.zoom,bounds:d.bounds,forceApply:!0}}}return s}function V(e,t){var n=t.searchPreloadedResults;if(n){var r=n.branding;(null==r?void 0:r.displayText)&&(e.displayText=r.displayText);var o=H.j(e.text||"");return[{request:e,results:n,meta:"category"===t.landing.id||"search"===t.landing.id&&(!o||(null==r?void 0:r.displayText))?t.meta:void 0}]}return[{request:e}]}var Z=function(e,t){var n,r;if((null===(n=t.searchPreloadedResults)||void 0===n?void 0:n.exactResult)&&"toponym"===t.searchPreloadedResults.exactResult.type)return[];if(e.where?r=function(e,t){var n=Object(l.a)(e.where);if(!n)return[];return V({searchType:"BUSINESS_LIST",where:n,origin:e.source||"url"},t)}(e,t):e.text&&(r=Y(e,t)),!r||0===r.length)return[];var o=r[r.length-1];return o.request.disallowZoom=!0,t.query["show-filters-panel"]&&(o.filterPanelStack=[{type:"list"},{type:"filter",id:t.query["show-filters-panel"]}]),r};function K(e){return"by"===e.tld&&!(e.authorization&&e.authorization.phone)}var X=n(45),$=n(109),J={common:56,portal:132,portalFocused:58,zero:0,serpWebVerticals:44};var Q=n(65),ee=n(223);var te=function(e){return e.experiments.ui.width640?640:384},ne=function(e){return e.experiments.ui.width640?640:800},re={common:function(){return[70,50,50,50]},collapsed:function(e){return[70,50,50,te(e)+50]}},oe=(J.common,J.portal,{default:function(){return[0,0,0,0]},narrow:function(e){return[0,0,0,te(e)]},wide:function(e){return[0,0,0,ne(e)]}});var ie=n(123),ae=["object/add","entrance/add","address/add","road/add","other/add","transit/stop/add","parking/add","barrier/add","fence/add","crosswalk/add","gate/add","provider/add","assignment/settlement/scheme/add"],se=["object/other","address/edit","entrance/edit","object/edit","object/location/edit","object/name/edit","object/not-found","assignment/barrier/location/edit","assignment/gate/location/edit","assignment/entrance/edit"],ce=["transit/stop/edit","transit/stop/not-found","transit/stop/name/edit","transit/stop/location/edit","transit/stop/route/incorrect","transit/stop/other"],ue=["organization/add"],le=["organization/edit","organization/edit-info","organization/other","organization/closed/permanently","organization/closed/temporary","organization/closed/unknown","organization/opened","organization/moved","organization/closed","organization/location/edit","organization/edit-accessibility"],de=["route/edit","route/edit/better","route/incorrect","route/incorrect/road-closed","route/incorrect/poor-condition","route/incorrect/prohibiting-sign","route/incorrect/obstruction","route/other"],pe=["object/select"],fe=["map/edit"],me=["spot/other"];function ve(e){return ae.includes(e)}function ge(e){return se.includes(e)}function he(e){return ce.includes(e)}function be(e){return ge(e)||he(e)}function ye(e){return ue.includes(e)}function _e(e){return le.includes(e)}function Ee(e){return de.includes(e)}function we(e){return pe.includes(e)}function Se(e){return fe.includes(e)}function Oe(e){return me.includes(e)}function Ce(e){return ve(e)&&"object/add"!==e||Ee(e)&&"route/edit"!==e&&("route/incorrect"!==e||"auto"!==Object(c.j)("rtt"))||Oe(e)||["transit/stop/location/edit","object/location/edit","assignment/barrier/location/edit","assignment/gate/location/edit","entrance/edit","assignment/entrance/edit"].includes(e)}var ke=n(33);function je(e,t){var n,r,o;switch(e){case"mrc":o={type:e,data:null==t?void 0:null===(n=t.mrc)||void 0===n?void 0:n.data};break;case"photos":o={type:e,data:null==t?void 0:null===(r=t.photos)||void 0===r?void 0:r.account.data};break;default:o={type:e}}return o}[].concat(["ru.yandex.yandexnavi","ru.yandex.yandexnavi.inhouse","ru.yandex.yandexnavi.sandbox","ru.yandex.mobile.navigator","ru.yandex.mobile.navigator.inhouse","ru.yandex.mobile.navigator.sandbox"],["web","mobile_maps_android","mobile_maps_ios","serp","tycoon","webview_form","ugc","nyak","ru.yandex.searchplugin","ru.yandex.yandexmaps","ru.yandex.traffic","ru.yandex.traffic.sandbox","ru.yandex.traffic.inhouse","ru.yandex.yandexmaps.debug","ru.yandex.yandexmaps.pr","com.yandex.maps.TestApp","com.yandex.maps.testapp","com.yandex.maps.mrctestapp","com.yandex.maps.mrctestapp.testing","com.yandex.browser","ru.yandex.mobile","ru.yandex.mobile.search","desktop-maps","touch-maps","touch-nmaps"]);var Re="account",Te={isLoaded:!1,isLoading:!1,data:void 0,items:[],areAllLoaded:!1,isReloadNeeded:!1};var Ie=n(0);function Me(e){var t;return(null===(t=e.query["feedback-metadata"])||void 0===t?void 0:t.client_id)||"desktop-maps"}function xe(e){var t,n,r,o=e.query["feedback-metadata"];return{uuid:null==o?void 0:o.uuid,device_id:null==o?void 0:o.device_id,locale:null==o?void 0:o.locale,client_id:Me(e),test_ids:(t=e.experiments,r=null===(n=t.boxes)||void 0===n?void 0:n.split(";").map(function(e){return e.split(",")[0]}).filter(Boolean),(null==r?void 0:r.length)?r:void 0),application_version:null==o?void 0:o.application_version,bebr_session_id:e.counters.analytics.sessionId}}function Pe(e){return{clientContextId:e.query["feedback-client-context"],formContextId:e.query["feedback-context"]}}var Ne={search:Ae,home:function(){return[]},usermaps:function(e){if(!e.userMap)return[];return[{mode:"usermaps",usermap:e.userMap}]},traffic:function(e){var t=e.query;if(t.trfev&&ze(t.l,"trf")&&t.trfev)return[{mode:"traffic",currentTrafficEvent:null}];return[]},"search-result":function(e){return[].concat(Ae(e),Ue(e))},orgpage:function(e){var t=e.query;if(e.orgpagePreloadedResults){var n,r=e.orgpagePreloadedResults,o=r.items,i=r.requestId,a=r.requestCorrectedQuery,s=o[0]||null;return[{mode:"orgpage",result:s,request:{id:s?s.id:t.orgpage.id},requestId:i,requestCorrectedQuery:a,isLoading:!1,meta:"orgpage"===e.landing.id?e.meta:void 0,error:s&&H.h(s)?void 0:"not-found",tab:Object(ie.d)(t.tab),selectedPostId:null===(n=e.query.posts)||void 0===n?void 0:n.pid}]}return[]},discovery:function(e){if(!e.discovery)return[];return[Object(r.a)(Object(r.a)({mode:"discovery",isError:!1},e.discovery),{},{sessionId:"d:"+x.a.v4(),highlightedId:null})]},routes:function(e){var t,n,o,i,a,c,u,l=s.j({config:e}),d=e.query,p=d.rtext,f=d.rt,m=d.via,v=d.rtn,g=d.rtt,h=d.z,b=d.ll,y=d.routes,_=d.uri;if("string"!=typeof p&&"string"!=typeof f&&!X.j(_))return[Object(r.a)({mode:"routes"},l)];var E=null===(t=e.routerResponse)||void 0===t?void 0:t.waypoints.map(function(e){return{coords:e.coordinates,value:e.name||""}});null===(n=e.routerResponse)||void 0===n||null===(o=n.viaIndexes)||void 0===o||o.forEach(function(t,n){var r,o,i=null===(r=e.routerResponse)||void 0===r?void 0:null===(o=r.viaPoints)||void 0===o?void 0:o[n];i&&(null==E||E.splice(t,0,{coords:i.coordinates,value:i.name||""}))});var w=s.i(),S=e.routePoints||E||w,O=l.routerResponse;e.routerResponse&&(O=e.routerResponse,O=s.d(O),O=s.c(O,S));var C=m&&m.split("~").map(Number).filter(Boolean)||(null===(i=e.routerResponse)||void 0===i?void 0:i.viaIndexes)||[],k=S&&S.filter(function(e){var t=e.coords;return Boolean(t)}),j=e.routerResponse&&e.routerResponse.routes[0],R=j&&"taxiInfo"in j&&"error"in j.taxiInfo&&j.taxiInfo.error,T=S&&(null==k?void 0:k.length)===S.length&&(!j||R),I=function(e){var t,n,r=e.query,o=(null===(t=r.routes)||void 0===t?void 0:t.avoidTypes)?r.routes.avoidTypes.split(","):"string"==typeof(null===(n=r.routes)||void 0===n?void 0:n.avoidTypes)?[]:s.a,i=r.routes&&r.routes.avoid&&r.routes.avoid.split(",")||[],a="atm"===r.rtm,c=r.routes&&r.routes.timeDependent&&r.routes.timeDependent.type,u=r.routes&&r.routes.timeDependent&&r.routes.timeDependent.time&&s.h(r.routes.timeDependent.time,ke.d(e)).getTime();return{auto:{ignoreTrafficJams:a,avoid:i,timeDependent:{type:"departure",time:"auto"===r.rtt&&u||void 0}},masstransit:{avoidTypes:o,timeDependent:{type:["departure","arrival"].includes(c)?c:"departure",time:"mt"===r.rtt&&u||void 0}}}}(e),M=v?parseInt(v,10):0,P=null===(a=Object.entries(s.b).find(function(e){return e[1]===g}))||void 0===a?void 0:a[0];return[Object(r.a)(Object(r.a)({},l),{},{mode:"routes",skipApplyBounds:Boolean(h&&b)&&S.filter(function(e){return e.coords}).length>=2,travelMode:(null===(c=O)||void 0===c?void 0:c.type)||P||l.travelMode,activeField:S.findIndex(function(e,t){return!(e.value&&e.coords||C.includes(t))}),activeRouteIndex:(null===(u=O)||void 0===u?void 0:u.routes)&&M<O.routes.length?M:0,activeComparisonMode:y&&y.activeComparisonMode||void 0,viaIndexes:C,sessionId:e.routerResponse?"r:"+x.a.v4():void 0,settings:I,routePoints:S,routerResponse:O,error:T?R||"unable_to_plot_the_route":void 0,mobileViewState:j?"mini":"expanded"})]},panoramas:function(e){var t=We(e),n={};if(t){var o=Object(l.a)(t.point);o&&(n.currentPanorama={isAir:"true"===t.air,direction:Object(l.a)(t.direction)||void 0,point:o,span:Object(l.a)(t.span)||[0,0],historicalPanoramas:[]})}return[Object(r.a)({mode:"panoramas"},n)]},mrc:function(e){var t=e.query.mrc;if(!t||!t.id)return[];return[{mode:"mrc",featureId:t.id,path:null,similar:null,directions:null,isLoading:!1}]},bookmarks:function(e){var t=e.query.bookmarks;if(!(e.authorization||t&&t.uri))return[];return[{mode:"bookmarks",activeFolderId:null,tab:"places"}]},photos:function(e){var t=e.query.photos;if(!t)return[];var n=e.photosInformation||{skipAdvert:!1};if(t.point){var o=Object(l.a)(t.point);return o?[{mode:"photos",meta:Object(r.a)(Object(r.a)({},n),{},{point:o,uri:t.uri})}]:[]}if(t.post&&t.business)return[{mode:"photos",meta:Object(r.a)(Object(r.a)({},n),{},{businessId:t.business,postId:Number(t.post)})}];if(t.business)return[{mode:"photos",meta:Object(r.a)(Object(r.a)({},n),{},{businessId:t.business})}];return[{mode:"photos",meta:Object(r.a)(Object(r.a)({},n),{},{id:t.oid})}]},feedback:function(e){var t=e.query,n=t.feedback||t.fb;if(!n)return[];switch(n){case"add-toponym":n="object/add";break;case"edit-toponym":n="object/edit";break;case"edit-organization":case"organization/duplicate":case"organization/edit-status":n="organization/edit";break;case"add-organization":n="organization/add";break;case"edit-stop":n="transit/stop/edit";break;case"entrance/select":case"entrance/location/edit":case"entrance/name/edit":case"entrance/not-found":n="entrance/edit"}var o=ve(n),i=ge(n),a=he(n),s=ye(n),c=_e(n),u=Ee(n),l=we(n),d=Se(n),p=Oe(n);if(!(o||i||s||c||u||l||a||d||p))return[];var f,m={source:t.source,metadata:xe(e),context:Object(r.a)(Object(r.a)({},Pe(e)),{},{ugcAssignmentId:t.assignment_id})},v=[];if(i||c){var g=e.searchPreloadedResults||e.whatsherePreloadedResults||e.poiPreloadedResults,h=n.startsWith("organization")?"business":"toponym";if(g){var b=g.items[0];b&&b.type===h&&(f=Object(r.a)({type:n,result:b},m),v=Ue(e))}}else if(a){var y=e.masstransitStop;y&&(f=Object(r.a)({type:n,result:y},m),v=Ze(e))}else f=p?Object(r.a)({type:n,uri:t.uri},m):Object(r.a)({type:n},m);if(!f)return[];return v.concat(Object(r.a)({mode:"feedback",mobileViewState:Ce(f.type)?"mini":"expanded"},f))},masstransit:Ze,reviews:function(e){var t,n,r=e.query,o=(null===(t=r.orgpage)||void 0===t?void 0:t.id)||r.oid,i=e.orgpagePreloadedResults||e.searchPreloadedResults||e.poiPreloadedResults,a=null==i?void 0:null===(n=i.items)||void 0===n?void 0:n.find(function(e){return e.id===o});if("add-review"in r&&e.authorization&&!K(e)&&"business"===(null==a?void 0:a.type))return[{result:a,mode:"reviews",type:"editor"}];return[]},"mobile-app-share":function(){return[]},catalog:function(e){var t=e.catalogData;if(t){var n=[{mode:"catalog",region:t.region,isLoading:!1,type:"main",data:t.data}];if(t.selectedId){var r=t.data.groups.find(function(e){return e.id===t.selectedId});r&&n.push({mode:"catalog",region:t.region,isLoading:!1,type:"group",data:r})}return n}return[]},covid:function(e){if(e.query.covid)return[{mode:"covid",data:e.covidData||{type:"error"},isolation:"isolation"===e.query.covid,mobileViewState:"mini"}];return[]},metro:function(e){var t;if(!(null===(t=e.metro)||void 0===t?void 0:t.defaultCity))return[];return[{mode:"metro"}]},event:function(e){var t,n,r=e.query;if(!(null===(t=r.events)||void 0===t?void 0:t.id))return[];if(null===(n=e.events)||void 0===n?void 0:n.cardEvent)return[{event:e.events.cardEvent,eventId:r.events.id,success:!0,mode:"event"}];return[{error:new Error("Failed to load event"),eventId:r.events.id,success:!1,mode:"event"}]},actual:function(e){var t=e.actualData;if("rich"===(null==t?void 0:t.meta.type))return[{mode:"actual",data:t}];return[]},"stories-player":function(e){var t;if(!e.initialStories)return[];var n=e.initialStories,r=n.storyId,o=n.storyType,i=n.storySet,a=n.businessId,s=i.find(function(e){return e.id===r});if(!s)return[];var c=e.orgpagePreloadedResults||e.searchPreloadedResults||e.poiPreloadedResults;return[{mode:"stories-player",storySet:i,activeStory:s,storyType:o,result:a?null==c?void 0:null===(t=c.items)||void 0===t?void 0:t.find(function(e){return e.id===a}):void 0}]},share:function(){return[{mode:"share"}]},"user-profile":Qe,"post-editor":function(){return[]},"stories-editor":function(e){if(!e.stories)return[];return[e.stories.stackItem]},ingrad:function(e){var t,n;return null!==(t=null==e?void 0:null===(n=e.ingradCatalog)||void 0===n?void 0:n.stackItems)&&void 0!==t?t:[]},"ugc-profile":function(e){if(!e.authorization)return[{mode:"user-profile"}];var t="ugc-profile"===e.landing.id?e.landing.type:"impressions",n=function(e,t){var n,o,i,a=t.ugcProfileData,s={mode:"ugc-profile",mobileViewState:"expanded"};return"mrc"===e?Object(r.a)(Object(r.a)({type:e},s),{},{data:(null==a?void 0:null===(n=a.mrc)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.selectedRide)?null==a?void 0:null===(i=a.mrc)||void 0===i?void 0:i.data:void 0}):Object(r.a)({type:e},s)}(t,e);return function(e,t){var n,r,o,i,a=t.ugcProfileData;switch(e){case"mrc":return Boolean((null==a?void 0:null===(n=a.mrc)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.editingRide)||!1);case"photos":return Boolean(null==a?void 0:null===(o=a.photos)||void 0===o?void 0:null===(i=o.account.data)||void 0===i?void 0:i.selectedPhoto);default:return!1}}(t,e)?[n,Object(r.a)(Object(r.a)({},je(t,e.ugcProfileData)),{},{mode:"ugc-profile",mobileViewState:"mini"})]:[n]},booking:function(e){if(!e.mapsBooking)return[];return[Object(r.a)({mode:"booking"},e.mapsBooking.stackItem)]},"booking-panel":function(e){if(!e.mapsBookingPanel)return[];return[Object(r.a)({mode:"booking-panel"},e.mapsBookingPanel.stackItem)]}};function ze(e,t){return Boolean(e&&e.split(",").includes(t))}function Le(e,t){return e&&Ne[e]?Ne[e](t):[]}function De(e){var t,n=e.query,r=(n["display-text"]||n.text||"").toString(),o=e.searchPreloadedResults;o&&(r===o.requestQuery&&(r=o.requestCorrectedQuery),(null===(t=o.branding)||void 0===t?void 0:t.displayText)&&(r=o.branding.displayText));return{formType:{id:"common"},text:r}}function Ae(e){return Z(e.query,e).map(function(t){var n=e.query.feedback?void 0:H.f(t),o=H.c(t);if(n||o)return{mode:"masstransit",stops:{loadingId:n,hasError:!1,data:void 0,tab:"overview"},line:{loadingId:o,hasError:!1,data:void 0,tab:"stops"},masstransitMode:o?"line":"stop",selectedVehicleType:void 0,mobileViewState:o?"expanded":"mini"};var i=e.landing.id,a="category"===i||"search"===i;return Object(r.a)(Object(r.a)({mode:"search"},t),{},{mobileViewState:["expanded","mini","micro"].includes(e.query["view-state"])?e.query["view-state"]:a?"expanded":"mini"})})}function Ue(e){var t=e.query,n=e.landing.id,o="category"===n||"search"===n,i=["expanded","mini","micro"].includes(e.query["view-state"])?e.query["view-state"]:o?"expanded":void 0;if(t.poi){var a,s,c=null!==(a=Object(l.a)(t.poi.point))&&void 0!==a?a:void 0;return c&&e.poiPreloadedResults&&e.poiPreloadedResults.items.length>0&&(e.poiPreloadedResults.items[0].displayCoordinates=c),[{mode:"search-result",request:{coordinates:c,from:"poi",uri:t.poi.uri},response:e.poiPreloadedResults,tab:Object(ie.d)(t.tab),mobileViewState:t.tab?"expanded":"mini",selectedPostId:null===(s=e.query.posts)||void 0===s?void 0:s.pid}]}var u,d=B("whatshere",e.landing);if(t.whatshere){var p=Object(l.a)(t.whatshere.point);return p?[{mode:"search-result",response:e.whatsherePreloadedResults,request:{coordinates:p,from:"whatshere",zoom:Number(t.whatshere.zoom)},tab:Object(ie.e)(d),mobileViewState:"house"===e.landing.id||t.tab?"expanded":"mini"}]:[]}if("biz"===t.ol&&t.oid||t.text&&t.orgpage&&t.orgpage.id){var f,m,v,g,h=Object(ie.d)(null!==(f=B("orgpage",e.landing))&&void 0!==f?f:q("orgpage",t.tab)?t.tab:void 0),b=t.oid||t.orgpage&&t.orgpage.id,y=null===(m=e.searchPreloadedResults)||void 0===m?void 0:m.items.find(function(e){return"business"===e.type&&e.id===b});return[{request:{from:"search",uri:y?X.d(y):void 0,id:b,origin:y?t.source||"url":"restore",serpId:y?void 0:null===(v=e.searchPreloadedResults)||void 0===v?void 0:v.requestSerpId,text:t.text,displayText:t["display-text"]},response:y?H.l(y,e.searchPreloadedResults):t.text?void 0:e.searchPreloadedResults,mapLocationRequest:y?{bounds:y.bounds,center:y.displayCoordinates,skipFirstApply:!0}:void 0,mobileViewState:t.orgpage||t.tab?"expanded":"mini",mode:"search-result",selectedPostId:null===(g=e.query.posts)||void 0===g?void 0:g.pid,tab:h}]}if("geo"===t.ol&&(t.ouri||t.oll||t.oid)){var _,E,w,S,O=t.oid?null===(_=e.searchPreloadedResults)||void 0===_?void 0:_.items.find(function(e){return e.id===t.oid}):void 0,C=O?O.uri:t.ouri,k=O?O.coordinates:Object(l.a)(t.oll);if(!C&&!k)return[];var j=k?null===(E=e.searchPreloadedResults)||void 0===E?void 0:E.items.sort((u=k,function(e,t){return e.coordinates?t.coordinates&&P(e.coordinates,u)>P(t.coordinates,u)?1:-1:1}))[0]:C?null===(w=e.searchPreloadedResults)||void 0===w?void 0:w.items.find(function(e){return C===X.d(e)}):void 0;return t.text||(j=void 0),[{request:{from:"search",uri:C,origin:j?t.source||"url":"restore",serpId:j?void 0:null===(S=e.searchPreloadedResults)||void 0===S?void 0:S.requestSerpId},response:j?H.l(j,e.searchPreloadedResults):t.text?void 0:e.searchPreloadedResults,mapLocationRequest:j?{bounds:j.bounds,center:j.displayCoordinates,skipFirstApply:!0}:void 0,mobileViewState:"mini",mode:"search-result",tab:Object(ie.e)(t.tab)}]}if(t.text&&e.searchPreloadedResults){var R,T,I="chain"===e.landing.id,M="category"===e.landing.id,x=!I&&!M&&!e.experiments.ui.disableCardAutoOpen,N=e.searchPreloadedResults.exactResult,z=1===e.searchPreloadedResults.items.length?e.searchPreloadedResults.items[0]:void 0,L=Y(t,e)[0].request;if(x&&z&&"business"===z.type)return[{request:Object(r.a)({from:"search"},L),response:e.searchPreloadedResults,mapLocationRequest:{bounds:z.bounds,center:z.displayCoordinates,skipFirstApply:!0},mobileViewState:i||"mini",mode:"search-result",tab:"overview",selectedPostId:null===(R=e.query.posts)||void 0===R?void 0:R.pid}];if(N&&"toponym"===N.type)return[{request:Object(r.a)({from:"search"},L),response:e.searchPreloadedResults,mapLocationRequest:{bounds:N.bounds,center:N.displayCoordinates,skipFirstApply:!0},mobileViewState:i||"mini",mode:"search-result",tab:"overview",selectedPostId:null===(T=e.query.posts)||void 0===T?void 0:T.pid}]}return[]}function Fe(e){var t,n=e.query,r="arc"===n.trfm?"traffic#archive":"traffic#actual",o=ze(n.l,"trf"),i=!o||ze(n.l,"trfe"),a=[];if("string"==typeof n.trfst&&(a=n.trfst.split("~").map(function(e){return e.split(":")})),"traffic#actual"===r)t={providerKey:"traffic#actual",state:null};else{var s=(a.find(function(e){return"time"===e[0]})||[])[1],c=(a.find(function(e){return"date"===e[0]})||[])[1],u=(s||"").split(",").slice(0,2).map(Number),l=ke.e(ke.d(e)),d=c?new Date(Number(c)):l,p=l.getHours(),f=l.getMinutes();t={providerKey:"traffic#archive",state:{time:2===u.length&&u.every(function(e){return"number"==typeof e&&isFinite(e)})?u:[p,f],date:isNaN(d.getTime())?l:d}}}return{isLayerEnabled:o,level:null,infoLayerShown:i,settings:t,trafficEvents:null}}function qe(e){var t=e.query;return"add-review"in t?e.authorization?{isOpen:K(e),type:"verification"}:{isOpen:!0,type:"reviews"}:tt(t)?{isOpen:K(e),type:e.authorization?"verification":"feedback",retpath:e.origin+e.originalUrl}:"ugc-profile"!==e.landing.id||e.authorization?{isOpen:!1}:{isOpen:!0,type:"ugcProfile",retpath:e.origin+e.originalUrl}}function Be(e){var t=e.query.pt;return"string"==typeof t&&t?{points:d(t)}:{}}function He(e){return{isLayerEnabled:ze(e.query.l,"pht")}}function We(e){var t,n=e.query;if("stv"!==n.ol&&"sta"!==n.ol||!n.oll){if(n.panorama){var o=n.panorama;t=Object(r.a)(Object(r.a)({},o),{},{air:o.air?"true":"false"})}}else if(t={point:n.oll},"sta"===n.ol&&(t.air="true"),n.ost){var i=n.ost.split("~").reduce(function(e,t){var n=t.split(":"),r=n[0],o=n[1];return"dir"!==r&&"spn"!==r||(e[r]=o),e},{});t.direction=i.dir,t.span=i.spn}return t}function Ge(e){var t=e.query,n=We(e),o={isLayerEnabled:ze(t.l,"stv")||ze(t.l,"sta"),isStreetLayerAvailable:!0,isAirLayerAvailable:!0,loadingPanorama:null};if(n){var i=Object(l.a)(n.point);i&&(o.loadingPanorama=Object(r.a)({direction:Object(l.a)(n.direction)||void 0,isAir:"true"===n.air},n.id?{id:n.id}:{point:i}))}return o}function Ye(e){var t=e.query;return{isLayerEnabled:ze(t.l,"mrc")||ze(t.l,"mrcpe"),isPlaying:!1,graphType:ze(t.l,"mrcpe")?"pedestrian":"road"}}function Ve(e){var t=e.query,n=t.masstransit,r=t.l,o=Boolean(n&&n.layer)||ze(r,"masstransit");return{isFilterLayerEnabled:!e.mocks&&Boolean(e.authorization),isLayerShown:o,isLayerEnabled:e.vehicleType?Boolean(e.vehicles):Boolean(e.layerRegions),layerRegions:e.layerRegions,isLayerEnabledOnAnotherZoom:!1,vehicles:e.vehicles||[],metroJams:e.metroJams}}function Ze(e){var t,n=e.masstransitStop,r=e.masstransitLine,o=e.query,i=o.masstransit,a=o.ol,s=o.oid,c=o.tab,u={loadingId:!i||i.lineId||n?s&&"mtr"===a?s:void 0:i.stopId,hasError:!1,data:n,tab:Object(ie.c)(c)||"overview"},l={loadingId:i&&!r?i.lineId:void 0,hasError:!1,data:r?{color:r.color,threads:r.features,activeThread:r.activeThread,vehicles:[]}:void 0,tab:Object(ie.b)(c)||"stops"};r?t="line":n?t="stop":l.loadingId?t="line":u.loadingId?t="stop":i&&i.vehicleType&&(t="list");var d=i&&i.vehicleType||void 0;return t?[{mode:"masstransit",stops:u,line:l,selectedVehicleType:d,masstransitMode:t,mobileViewState:"list"===t?"expanded":"mini"}]:[]}function Ke(e){if(e.stories)return e.stories.businessesData}function Xe(e){var t;return(null===(t=e.stories)||void 0===t?void 0:t.storiesData)?e.stories.storiesData:{storyCache:{},businessCache:{}}}function $e(e){return{isEnabled:!1,points:("string"==typeof e.query.rl?e.query.rl:"").split("~").reduce(function(e,t){var n=Object(l.a)(t);if(!n)return e;var r=e[e.length-1],o=r?[r.coordinates[0]+n[0],r.coordinates[1]+n[1]]:n;return e.push({coordinates:o,distance:r?r.distance+Object(N.a)(o,r.coordinates):0,showBalloon:!1}),e},[])}}function Je(e){var t;return(null===(t=e.metro)||void 0===t?void 0:t.defaultCity)?{isSchemeReady:!1,isSchemeLoading:!0,selectedCity:e.metro.defaultCity,availableCities:e.metro.availableCities,fromStop:e.metro.fromStop,toStop:e.metro.toStop}:{isSchemeReady:!1}}function Qe(){return[{mode:"user-profile"}]}function et(e){return t=e.ugcProfileData,{assignments:{editOrganizationStatusAssignment:Object(r.a)(Object(r.a)({},Te),null==t?void 0:null===(n=t.assignments)||void 0===n?void 0:n.editOrganizationStatusAssignment),united:Object(r.a)(Object(r.a)({},Te),null==t?void 0:null===(o=t.assignments)||void 0===o?void 0:o.united)},reviews:Object(r.a)(Object(r.a)({},Te),null==t?void 0:t.reviews),feedback:Object(r.a)(Object(r.a)({},Te),null==t?void 0:t.feedback),photos:{account:Object(r.a)(Object(r.a)(Object(r.a)({},Te),null==t?void 0:null===(i=t.photos)||void 0===i?void 0:i.account),{},{data:void 0}),organization:Object(r.a)(Object(r.a)({},Te),null==t?void 0:null===(a=t.photos)||void 0===a?void 0:a.organization),data:{tab:(null==t?void 0:null===(s=t.photos)||void 0===s?void 0:s.data.tab)||Re}},mrc:Object(r.a)(Object(r.a)(Object(r.a)({},Te),null==t?void 0:t.mrc),{},{data:void 0}),impressions:Object(r.a)(Object(r.a)({},Te),null==t?void 0:t.impressions),panoramas:Object(r.a)(Object(r.a)({},Te),null==t?void 0:t.panoramas)};var t,n,o,i,a,s}function tt(e){var t=e.feedback;return t&&(ve(t)||be(t)||ge(t)||ye(t)||_e(t)||["edit-toponym","edit-stop","edit-organization","add-organization","add-toponym","organization/duplicate","entrance/select","entrance/location/edit","entrance/name/edit","entrance/not-found","organization/edit-status"].includes(t)||Ee(t)||he(t)||we(t)||Se(t)||Oe(t))}var nt=function(e){var t,n,o=e.query,i=function(e){var t,n=e.query,r=[];n.photos&&r.push("photos");(n.panorama||"stv"===n.ol||"sta"===n.ol)&&r.push("panoramas");n.mrc&&r.push("mrc");(null===(t=n.events)||void 0===t?void 0:t.id)&&r.push("event");e.business.enableReview&&("add-review"in n||"reviews"===n.tab)&&r.push("reviews");e.query.widget&&r.push("share");e.initialStories&&r.push("stories-player");e.mapsBooking&&r.push("booking");e.mapsBookingPanel&&r.push("booking-panel");!K(e)&&tt(n)&&r.push("feedback");Ue(e).length>0&&r.push("search-result");n.mode&&z.f(n.mode)&&r.push(n.mode);e.discovery&&r.push("discovery");n.orgpage&&r.push("orgpage");n.um&&"usermaps"===e.pageMode&&r.push("usermaps");(n.trfev||n.trfm&&"cur"!==n.trfm)&&r.push("traffic");("mtr"===n.ol||n.masstransit&&(n.masstransit.vehicleType||n.masstransit.stopId||n.masstransit.lineId))&&r.push("masstransit");(n.text||n.ol||n.where)&&r.push("search");(X.j(n.uri)||n.hasOwnProperty("rtext")||n.hasOwnProperty("rt"))&&"routes"!==n.mode&&r.push("routes");n.bookmarks&&r.push("bookmarks");n.covid&&r.push("covid");e.actualData&&r.push("actual");"user-profile"!==e.landing.id&&"ugc-profile"!==e.landing.id||r.push(e.landing.id);e.locationInfo&&r.push("home");e.catalogData&&r.push("catalog");return r}(e),s=i[0],c=i.slice(1),u=z.e(s)?c.find(function(e){return!z.e(e)}):c.includes("routes")?"routes":void 0,l=ze(o.l,"carparks"),d=null===(t=e.notifications)||void 0===t?void 0:t.some(function(e){return e.types.some(function(e){return"emergency"===e})}),p=e.interstitial?"interstitial":e.query["no-daas"]||d?null:"daas",f="covid-map"===e.query.embed||"collapsed"===e.query["view-state"],m=["expanded","mini","micro"].includes(e.query["view-state"])?e.query["view-state"]:void 0,v=[].concat(Le(u,e),Le(s,e)).map(function(e){return Object(r.a)(Object(r.a)({},e),{},{mobileViewState:m||e.mobileViewState||"expanded",id:x.a.v4()})}),g=ke.d(e),h={config:e,stack:v,loadingErrors:[],map:void 0,homePanel:{isOpen:!0,isLoading:!1,locationInfo:e.locationInfo},search:{visitedBusinesses:[],businessesInside:{}},reviews:{businessReviews:{},ranking:"by_relevance_org"},form:De(e),whatsherePreview:null,ruler:$e(e),panoramas:Ge(e),photos:He(e),mrc:Ye(e),addPhotos:{isOpen:!1},feedback:{isCommonFeedbackOpened:""===o.feedback||""===o.fb,allowObjectSelectionOnMap:o.feedback&&we(o.feedback)},ugcProfile:et(e),loginDialog:qe(e),placemarks:Be(e),geolocation:{isStarted:!1,currentPosition:"isUserCoordinates"in e.mapLocation?e.mapLocation.center:null,isAuto:!1,isWatching:!1,lastTimeUpdate:ke.e(g).getTime(),error:null},bodyIndents:e.query.webview?{top:Number(o.safearea_inset_top)||0,bottom:Number(o.safearea_inset_bottom)||0}:null,mapRegion:e.mapRegion,traffic:Fe(e),masstransit:Ve(e),masstransitBookmarks:{hasInitError:!1,highlightedStopId:null,actions:{},stops:null,lines:null},bookmarks:{highlightedId:null,rootFolder:null,hasInitError:!1,hasPlacesInitError:!1,hasActionError:!1,currentAction:null,actions:{},searchResults:{},cachedCoordinates:{}},parking:{isLayerShown:l,isLayerEnabled:!0,center:null},clearHistoryDialogOpened:!1,clearHistorySuccessPopupShown:!1,collapsedSidebar:f,defaultMobileViewState:"expanded",isHeaderFocused:!1,shouldForceOpenSuggest:!1,isHeaderShown:!e.query["no-header"]&&!z.g(e),hotelsBooking:{personsAmount:2},posts:{byBusinessId:{},byId:{}},isFollowingPin:!1,routes:{isMrcPlayerHidden:!1,isRoutePointDragging:!1,temporaryStackData:{cargo:void 0}},promoType:p,stackActionsCount:0,metro:Je(e),actual:{isLoading:!1},notifications:e.notifications,closedNotifications:[],indoor:{levelId:null,plans:null},stories:Xe(e),ingradCatalog:null===(n=e.ingradCatalog)||void 0===n?void 0:n.data,authorizedBusinesses:Ke(e),share:{isExpanded:!1},timeContext:g,mapControlsState:{isMobileControlsHidden:!1,savedPanoramasPhotosLayer:"panorama"},storiesVisitedCache:{},tabs:{}};return h.map=function(e){var t,n=e.config,r=function(e){var t=function(e){var t=Object($.a)(e);if(!t)return{width:1920,height:1080};return t.display.viewport}(e.config),n=function(e){var t=e.config;return z.h(e)?oe.default(t):z.i(e)?oe.wide(t):oe.narrow(t)}(e),r=n[0],o=n[1],i=n[2],a=n[3];return{size:{width:t.width-a-o,height:t.height-r-i},offset:{left:a,top:r}}}(e),o=null!==(t=function(){if("undefined"==typeof window)return;var e=document.querySelector(".map-container");if(!e)return;var t=e.getBoundingClientRect();return{size:{width:e.offsetWidth,height:e.offsetHeight},offset:{top:t.top,left:t.left}}}())&&void 0!==t?t:r,i=function(e){var t=e.config,n=(z.d(e,"ugc-profile"),z.h(e)),r=z.i(e);return n&&!r?re.collapsed(t):re.common(t)}(e);return{isEditing:!1,isInAction:!1,isHoverForceEnabled:!1,isBlackout:!1,isSnapToRoundZoom:!n.uatraits.isMobile,ready:!1,fullReady:!1,type:n.mapType,mode:"raster",camera:{azimuth:0,tilt:0},size:r.size,offset:r.offset,location:a.b(n.mapLocation,i,o.size,!0)}}(h),h},rt=n(99),ot={};function it(e,t,n){return e.uri&&e.coords?function(e,t,n,r){return st(e,n,r).then(function(e){return!e&&t?at(t,n,r):e})}(e.uri,e.coords,t,n):e.uri?st(e.uri,t,n):e.value&&!e.coords?function(e,t,n){return ct(e,function(){return rt.a.fetch({type:["geo"],text:e,count:1,origin:n},t)})}(e.value,t,n):e.coords?at(e.coords,t,n):Promise.resolve(void 0)}function at(e,t,n){return ct(e.join(","),function(){return rt.a.fetch({mode:"reverse",type:["geo"],center:e,count:1,origin:n},t)})}function st(e,t,n){return ct(e,function(){return rt.a.fetch({uri:e,count:1,origin:n},t)})}function ct(e,t){return ot[e]?Promise.resolve(ot[e]):t().then(function(e){return e.items.length>0?e.items[0]:void 0}).then(function(t){var n;t&&(ot[e]=t,Object.keys(ot).length>100&&((n={})[e]=ot[e],ot=n));return t})}n(275);var ut=n(5),lt=n(31),dt=n(19),pt=n(42),ft=n(27),mt=n(134),vt=n(457),gt=n(48);function ht(e){if(0===e.length)return[];for(var t=[e[0]],n=0,r=e[0],o=1;o<e.length;o++){var i=e[o],a=i[0]+n-r[0];if(a>360||a<-360){var s=360*Math.floor(a/360);n-=s,a-=s}a>180?n-=360:a<-180&&(n+=360);var c=[i[0]+n,i[1]];t.push(c),r=c}return t}ft.j,Math.PI,i.PureComponent;var bt=n(30),yt=n(38),_t=Object(ut.a)("geolocation-pin"),Et=(pt.a.minimum,function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=Object(yt.c)(e.config)?"map-placemark-dot-ru":"map-placemark-dot";return i.createElement(i.Fragment,null,i.createElement(dt.a,{name:"geolocation_pin"},i.createElement(lt.a,{coordinates:e.currentPosition,zIndex:pt.a.minimum,nonInteractive:!0},i.createElement("div",{className:_t("placemark")},i.createElement(bt.a,{name:t,size:32})))),null)},t}(i.Component)),wt=Object(I.b)(Et),St=n(61),Ot=(n(279),n(15)),Ct=n(281),kt=n.n(Ct),jt=n(282),Rt=n.n(jt),Tt=Object(ut.a)("map-circle-placemark"),It=function(e){var t=e.color,n=e.size,r=void 0===n?"medium":n,o=e.comma,a=e.caption,s=e.outline,c=Object(St.a)(e,["color","size","comma","caption","outline"]);return i.createElement(lt.a,c,i.createElement("div",{className:Tt({comma:o,size:r,outline:s}),style:{color:t}},i.createElement(Ot.a,{className:Tt("placemark"),url:o?Rt.a:kt.a}),i.createElement("div",{className:Tt("content")},e.children),a?i.createElement("div",{className:Tt("caption")},a):null))},Mt={pmbl:"#177ee6",pmrd:"#f43",pmgn:"#3bb300"},xt=Mt.pmbl,Pt=function(e){return e.points?i.createElement(i.Fragment,null,e.points.map(function(e,t){var n=e.coordinates,r=e.color;return i.createElement(It,{key:t+"_"+n.join(),coordinates:n,color:r&&r in Mt?Mt[r]:xt,nonInteractive:!0,comma:!0})})):null},Nt=(n(283),n(112));function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lt(e,t,n){return(Lt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&zt(o,n.prototype),o}).apply(null,arguments)}var Dt=n(91),At=n(51),Ut=n(20),Ft=n(32),qt=n(56),Bt=n(75),Ht=n(241),Wt=n(459),Gt=n(16),Yt=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._key="",t._applyCursor=function(){var e=t._getCursor();!t.props.src&&e&&e.startsWith("url(")||(t.props.map.container.style.cursor=function(e){if(e.src&&e.basePoint)return'url("'+e.src+'") '+e.basePoint.join(" ")+', url("'+e.src+'"), auto';return e.cursor||"default"}(t.props),t._key=t._getCursor())},t._getCursor=function(){return t.props.map.container.style.cursor||""},t}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._applyCursor()},n.componentDidUpdate=function(){this._applyCursor()},n.componentWillUnmount=function(){this._getCursor()===this._key&&(this.props.map.container.style.cursor="")},n.render=function(){return null},t}(i.Component);var Vt=Object(Ut.b)({shouldWait:!0})(Object(I.b)(Yt)),Zt=n(113),Kt={color:{r:1,g:68/255,b:.2,a:1}},Xt={lightness:-.1,saturation:1};var $t,Jt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handlers={},n._updateLayer=function(e,t){var r=n.props.map;if(!r.destroyed){var o=t&&r.getDataSource(t.layer);t&&t.dataSource&&(o?e&&r.updateTileDataSource(t.layer,t.dataSource):r.addDataSource(t.layer,t.dataSource));var i=r.getLayers(),a=i.topRasterLayers,s=i.mainLayers,c=[].concat(s,a);if(e){var u=Object(At.i)(e.layer);c=c.filter(function(e){return!u.includes(e)})}if(t){var l,d=Object(At.i)(t.layer);(l=c).push.apply(l,d)}r.setLayers(Object(At.j)(c,n.props.ymaps3.EventBlockerLayer,n.props.config)),!e||!e.dataSource||t&&t.dataSource||r.removeDataSource(e.layer)}},n._getHandler=function(e){return function(t,r){var o=n.props,i=t.feature,a=!o.config.uatraits.isTouch;(o.shouldHover?o.shouldHover(i):Boolean(o.onClick))&&("onMouseEnter"===e&&(a&&o.map.setObjectHighlight(function(e){var t;return{object:e,color:(null===(t=e.properties.tags)||void 0===t?void 0:t.includes("building"))?Xt:Kt}}(i)),n.setState({isHover:!0})),"onMouseLeave"===e&&(a&&o.map.setObjectHighlight(void 0),n.setState({isHover:!1})));var s=o[e];s&&s(i,r)}},n.state={isHover:!1},Object.keys(Ft.a).forEach(function(e){return n._handlers[e]=n._getHandler(e)}),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateLayer(void 0,this.props)},n.componentDidUpdate=function(e){this.props.layer===e.layer&&Object(Wt.a)(e.dataSource,this.props.dataSource)||this._updateLayer(e,this.props)},n.componentWillUnmount=function(){this._updateLayer(this.props)},n.render=function(){var e=this,t=Object(At.i)(this.props.layer);return i.createElement(i.Fragment,null,this.state.isHover?i.createElement(Vt,{cursor:"pointer"}):null,t.map(function(t){return i.createElement(Ft.b,Object(Gt.a)({key:t,layer:t},e._handlers))}))},t}(i.Component),Qt=Object(I.b)(Object(Ut.b)({shouldWait:!0})(Jt)),en={failIfMajorPerformanceCaveat:!0,antialias:!1,depth:!0,alpha:!1,stencil:!1};function tn(){try{var e=document.createElement("canvas");e.width=1,e.height=1;var t=e.getContext("webgl",en);if(t)return t}catch(n){}on()}function nn(e){if(void 0===$t){var t=e||tn();t?$t=function(e){for(var t=!0,n=[],r=0,o=["requestAnimationFrame","Worker","URL","Blob","XMLHttpRequest","Set","Map"];r<o.length;r++){var i=o[r];window[i]||(t=!1,n.push("WindowPropertyNotExist-"+i))}"function"!=typeof Math.trunc&&(t=!1,n.push("MathTrunc"));0===e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(t=!1,n.push("MAX_VERTEX_TEXTURE_IMAGE_UNITS"));e.getExtension("OES_vertex_array_object")||(t=!1,n.push("OES_vertex_array_object"));e.getExtension("OES_standard_derivatives")||(t=!1,n.push("OES_standard_derivatives"));var a=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);a&&0!==a.precision||(t=!1,n.push("Highp"));(function(e){if(!e)return!1;var t=e.createShader(e.VERTEX_SHADER);if(!t)return!1;e.shaderSource(t,"#version 100\nattribute vec2 p;\nvoid main() {\n    gl_Position = vec4(p,0,1);\n    gl_PointSize = 1.0;\n}"),e.compileShader(t);var n=e.createShader(e.FRAGMENT_SHADER);if(!n)return!1;e.shaderSource(n,"#version 100\nvoid main() {\n    gl_FragColor = vec4(1, 0, 0, 1);\n}"),e.compileShader(n);var r=e.createProgram();if(!r)return!1;e.attachShader(r,t),e.attachShader(r,n),e.bindAttribLocation(r,0,"p"),e.linkProgram(r);var o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0]),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(r),e.drawArrays(e.POINTS,0,1);var i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteBuffer(o),e.deleteShader(t),e.deleteShader(n),e.deleteProgram(r),255===i[0]})(e)||(t=!1,n.push("TestPoints"));var s=e.getExtension("WEBGL_debug_renderer_info"),c=s&&e.getParameter(s.UNMASKED_RENDERER_WEBGL);"string"==typeof c&&c.indexOf("SwiftShader")>-1&&(t=!1,n.push("SoftwareRendering"));return{supported:t,reasonsFailed:n}}(t):on()}return $t}function rn(){return $t?$t.supported:window.WebGLRenderingContext?(n=navigator.userAgent,!(!(/YandexSearch\//.test(n)||/YaApp/.test(n)||/YaBrowser\/[0-9][0-9.]* YaApp_iOS\/[0-9][0-9.]*/.test(n))&&!/MiuiBrowser\//.test(n)&&/Mac OS X [0-9_]+;.*HTC[_/ ]/.test(n)||/Mac OS X 10_[0-8][^0-9]/.test(navigator.userAgent)||/SamsungBrowser\//.test(n)||(t=null===(e=navigator.userAgent)||void 0===e?void 0:e.match(/WebKit\/?(\d+)/i),Boolean(t&&Number(t[1])<537))||function(){var e,t=null===(e=navigator.userAgent)||void 0===e?void 0:e.match(/Chrome\/(\d+)/i);return!!t&&Number(t[1])<57}())||(on(),!1)):(on(),!1);var e,t,n}function on(){$t={supported:!1,reasonsFailed:["HasWebGl"]}}var an,sn=n(83),cn=n(207),un="undefined"==typeof window,ln=[],dn=0,pn=3e3,fn=2e4,mn=5e3;function vn(){un=!0,ln.forEach(function(e){return e()}),an&&an.disconnect()}function gn(){var e=window.performance.now();e>fn?vn():(dn?pn-(e-dn):pn)<=0?vn():setTimeout(gn,1e3)}un||Object(cn.a)(function(){if(!window.PerformanceLongTaskTiming||!window.performance||!window.performance.now)return void setTimeout(vn,mn);(an=new window.PerformanceObserver(function(e){var t=e.getEntries().pop();t&&(dn=t.startTime+t.duration)})).observe({entryTypes:["longtask"]}),gn()});var hn,bn=function(e){un?e():ln.push(e)},yn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onUpdate=function(){var e=n.props.map.zoom;n.state.zoom!==e&&n.setState({zoom:e})},n._renderLayer=function(){var e,t=n.props,r=t.config,o=Object(St.a)(t,["config"]),a=n.state.zoom,s=(null===(e=r.layers.personalizedPoi)||void 0===e?void 0:e.zoomRange)||[],c=s[0],u=s[1];return a<c||a>u?null:i.createElement(Qt,Object(Gt.a)({},o,{layer:"personalizedPoi"}))},n.state={zoom:t.map.zoom},n}return Object(o.a)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,this._renderLayer(),i.createElement(Ft.b,{onUpdate:this._onUpdate}))},t}(i.Component),_n=Object(I.b)(Object(Ut.b)({shouldWait:!0})(yn)),En=function(){return Promise.all([n.e("ymaps").then(n.bind(null,464)),n.e("ymaps").then(n.bind(null,461)),n.e("ymaps").then(n.t.bind(null,462,7))]).then(function(e){var t=e[0],n=e[1].EventBlockerLayer,o=e[2];return[Object(r.a)(Object(r.a)({},t),{},{EventBlockerLayer:n}),o.default]})},wn=function(e,t){return Promise.all([n.e("ymaps-vector").then(n.bind(null,468)),n.e("ymaps-vector").then(n.t.bind(null,463,7))]).then(function(e){var n=e[0],r=e[1];return function(e){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Lt(n.VectorMapEngine,[r.default,t||{},e].concat(i))}}})},Sn=300,On=function(e){function t(t){var n;(n=e.call(this,t)||this)._isMapCreated=!1,n._ymaps3=void 0,n._loadAction=void 0,n._loadDelayStart=void 0,n._ref=i.createRef(),n._location=void 0,n._camera=void 0,n._map=void 0,n._onMapUpdateDebounced=void 0,n._filter=void 0,n._onYmaps3Load=function(e){var t=e[0],r=e[1];n._ymaps3=t,t.errorLoggerFactory(function(e){var t=new r;return t.initErrors(e),t.logError}),n._createMap()},n._handleMapLocationRequest=function(e){var t=n._map;if(n._location&&e&&t){var r=n._location,o="bounds"in e?Object(a.b)({bounds:e.bounds},n.props.margin,n._getSize(),t.isSnapToRoundZoom):void 0,i=r.center,s=r.zoom;o?i=o.center:"center"in e&&(i=e.center),o?s=o.zoom:"zoom"in e&&e.zoom&&(s=e.zoom),s===r.zoom&&Object(vt.a)(i,r.center)||t.animateCenterAndZoom(i,s,e.duration||0)}},n._createMap=function(){var e=n.props,t=n.state,r=n._isElementProvided?e.element:n._ref.current;if(r&&!n._isMapCreated&&n._ymaps3){n._isMapCreated=!0,e.config.query["disable-vector-force"]?(Ie.a.set("disable_vector_force",!0),n.setState({isVectorDisabledForce:!0})):Ie.a.get("disable_vector_force")&&n.setState({isVectorDisabledForce:!0});var o=e.locationRequest,i=o&&"center"in o&&o.center||e.initialLocation.center,a=o&&"zoom"in o&&o.zoom||e.initialLocation.zoom;n._location={center:i,zoom:a},n._camera=e.initialCamera||{azimuth:0,tilt:0};var s=Object(At.g)(e.config),c=n._getMapMode(),u=n._ymaps3.YaMap,l=Object.values(At.d),d=Object(At.j)(l,n._ymaps3.EventBlockerLayer,e.config),p=d.topRasterLayers,f=d.mainLayers,m=new u({mode:c,element:r,center:i,zoom:a,margin:e.margin,zoomRange:{min:2,max:21},dataSources:s,topRasterLayers:p,mainLayers:f,behaviors:e.behaviors,manageZoomRounding:!e.disableZoomRounding,eventObjectsFilter:e.eventObjectsFilter,disableRasterPreload:e.config.uatraits.isMobile,nonRotatableRasterSources:At.c});if(window.yandex_map=m,m.events.clickTimeout=300,m.events.waitHotspotsTimeout=1e3,n.props.disableZoomRounding&&(m.behaviors.snapToRoundZoom=!1),Object(Dt.a)().has.touch?n._ymaps3.loadHotspotsForViewport(m):n._ymaps3.loadHotspotsByPointerPosition(m),e.vector&&e.config.isVectorEnabled&&!t.isVectorDisabledForce)if(rn()){var v=wn(e.config.experiments.ui),g=new Promise(function(e,t){setTimeout(function(){var n=tn();n&&nn(n).supported||t(new Error("Vector is not supported")),e(n)})});Promise.all([v,g]).then(function(e){var t=e[0],n=e[1];m.destroyed||m.provideVectorMapEngineFactory(t(n))}).catch(function(){n.setState({isVectorSupported:!1})})}else n.setState({isVectorSupported:!1});n._map=m,n._onMapUpdate(),n._onZoomRoundingChange(),n._onMapSizeChange(),n._addFilter(),e.onReady&&e.onReady(m),n._handleMapLocationRequest(o),n.forceUpdate()}},n._addFilter=function(){var e=n.props.getFilter;e&&(n._filter=e(n._ymaps3),n._map.addObjectFilter(n._filter))},n._onMapUpdate=function(){var e=n._map;if(!e.isInAction){var t=[e.center[0],e.center[1]];(n._location.zoom!==e.zoom||!Object(vt.a)(n._location.center,t))&&(n._location={zoom:Math.round(100*e.zoom)/100,center:t},n._onLocationChange()),n._camera.azimuth===e.azimuth&&n._camera.tilt===e.tilt||(n._camera={azimuth:e.azimuth,tilt:e.tilt},n.props.onCameraChange&&n.props.onCameraChange(n._camera))}},n._onLocationChange=function(){var e=n.props.onLocationChange;if(e){var t=Object(a.b)(n._location,n.props.margin,n._getSize()),o=t.bounds,i=t.span;e(Object(r.a)(Object(r.a)({},n._location),{},{bounds:o,span:i}))}},n._onMapSizeChange=function(){n.props.onSizeChange&&n.props.onSizeChange(n._getSize(),n._map.offset)},n._getSize=function(){var e=n._map.size;return{width:e.x,height:e.y}},n._onResize=function(){var e=n._map;e&&e.resize()},n._onDragStart=function(){n.setState({isDragged:!0})},n._onDragEnd=function(){n.setState({isDragged:!1})},n._onZoomRoundingChange=function(){n.props.onZoomRoundingChange&&n._map&&n.props.onZoomRoundingChange(n._map.isSnapToRoundZoom)},n._renderLayers=function(){var e=n.props;return"satellite"===e.type?i.createElement(Qt,{layer:"sat"}):"hybrid"===e.type?i.createElement(i.Fragment,null,i.createElement(Qt,{layer:"sat"}),i.createElement(Qt,{layer:"skl",onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}})):i.createElement(i.Fragment,null,i.createElement(Qt,{layer:"map",onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}}),!e.config.bunker.disablePersonalizedPoi&&e.config.authorization&&"vector"===n._getMapMode()?i.createElement(_n,{onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}}):null)},n.state={isDragged:!1,isVectorSupported:!0,isVectorDisabledForce:!1};var o=n.props.updateTimeout||Sn;return n._onMapUpdateDebounced=Object(Ht.a)(n._onMapUpdate,o),"undefined"!=typeof window&&(t.delayLoad?(n._loadDelayStart=Date.now(),Object(sn.d)("mapLoadDelay",n._loadDelayStart),bn(function(){n._loadAction||(Object(sn.d)("mapLoadDelayCompleted",Date.now()-n._loadDelayStart),n._loadAction=p.a.create(En(),{success:n._onYmaps3Load}))})):n._loadAction=p.a.create(En(),{success:n._onYmaps3Load})),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._createMap()},n.componentDidUpdate=function(e){!e.delayLoad||this.props.delayLoad||this._loadAction||(Object(sn.d)("mapLoadDelayAborted",Date.now()-this._loadDelayStart),this._loadAction=p.a.create(En(),{success:this._onYmaps3Load}));var t=this._map;if(!t)return this._createMap();var n=this.props;n.behaviors&&!Object(Wt.a)(n.behaviors,e.behaviors)&&t.behaviors.setEnabled(n.behaviors);var r=n.locationRequest;r!==e.locationRequest&&this._handleMapLocationRequest(r),Object(Wt.a)(n.margin,e.margin)||(t.setMargin(n.margin),this._onLocationChange());var o=this._getMapMode();t.setMode(o),n.getFilter!==e.getFilter&&(this._filter&&(t.removeObjectFilter(this._filter),this._filter=void 0),this._addFilter())},n.componentWillUnmount=function(){p.a.cancel(this._loadAction),this._onMapUpdateDebounced.cancel(),this._map&&this._map.destroy()},n._getMapMode=function(){var e=this.props.config.isVectorEnabled&&!this.state.isVectorDisabledForce;return this.state.isVectorSupported&&this.props.vector&&e?"vector":"raster"},n.render=function(){var e=this.props,t=this.state;return i.createElement(i.Fragment,null,this._isElementProvided?null:i.createElement("div",{className:e.className,ref:this._ref}),i.createElement(Ut.a,{value:{map:this._map,ymaps3:this._ymaps3}},e.children,this._renderLayers(),i.createElement(Ft.b,{onUpdate:this._onMapUpdateDebounced,onDragStart:this._onDragStart,onInertiaStart:this._onDragEnd,onDragEnd:this._onDragEnd,onResize:this._onMapSizeChange,onZoomRoundingChanged:this._onZoomRoundingChange}),this.state.isDragged?i.createElement(Vt,{cursor:"grabbing"}):null),i.createElement(qt.a,{onResize:this._onResize}),i.createElement(Bt.a,{type:"resize",listener:this._onResize}),t.isVectorDisabledForce?i.createElement(dt.a,{name:"disable_vector_force"}):null)},Object(Nt.a)(t,[{key:"_isElementProvided",get:function(){return"element"in this.props}}]),t}(i.Component),Cn=Object(I.b)(On),kn=n(70),jn=n(128),Rn=n.n(jn),Tn={getLayers:function(e,t){var n=(hn=hn||{}).requests||[],r=n.push(function(e,t){return{layerIds:e.layers,center:e.center?e.center.map(function(e){return e.toFixed(8)}).join(","):void 0,zoom:e.zoom&&Math.round(e.zoom),span:e.span?e.span.map(function(e){return e.toFixed(8)}).join(","):void 0,locale:t.locale,lang:t.lang}}(e,t))-1,o=hn.promise||function(e){return new Promise(function(t,n){Rn()(function(){var r=hn.requests;hn=void 0,function(e,t){return Object(R.a)("layers/info",{query:{requests:e}},t)}(r,e).then(t).catch(n)})})}(t);return hn={promise:o,requests:n},o.then(function(e){return e[r]})},getLayer:function(e,t){var n=e.layer,o=Object(St.a)(e,["layer"]);return o.zoom&&!In(n,o.zoom,t)?Promise.resolve(void 0):Tn.getLayers(Object(r.a)({layers:[n]},o),t).then(function(e){return e[n]})},checkStaticZoomRange:In};function In(e,t,n){var r=n.layers[e];if(!r)return!0;var o="zoomRange"in r&&r.zoomRange;return!o||t>=o[0]&&t<=o[1]}var Mn=Tn,xn=Object(kn.a)(I.b,Object(Ut.b)({shouldWait:!0}))(function(e){function t(t){var n;return(n=e.call(this,t)||this)._updateDebounced=void 0,n._loadAction=void 0,n._update=function(){var e=n.props,t=e.map.getLayers(),r=t.topRasterLayers,o=t.mainLayers,i=[].concat(r,o).map(function(e){return e.split(":")[0]}),a=At.a.filter(function(e){return i.includes(e)});p.a.cancel(n._loadAction);var s=Object(Wt.a)(a,["map"])?Promise.resolve({map:{copyrights:["© "+"Яндекс"]}}):Mn.getLayers({layers:a,center:e.map.center,zoom:e.map.zoom},e.config);n._loadAction=p.a.create(s,{success:n._onDataLoad})},n._onDataLoad=function(e){var t=n.props.map;Object.entries(e).forEach(function(e){var n=e[0],o=e[1];if(o){var i=t.getDataSource(n),a=Object(r.a)({},i);if("zoomRange"in o&&o.zoomRange){var s=o.zoomRange,c=s[0],u=s[1];a.zoomRange={min:c,max:u}}a.copyrights="copyrights"in o?o.copyrights:void 0,Object(Wt.a)(i,a)||t.updateTileDataSource(n,a)}})},n._updateDebounced=Object(Ht.a)(n._update,500),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateDebounced()},n.componentWillUnmount=function(){this._updateDebounced.cancel(),p.a.cancel(this._loadAction)},n.render=function(){return i.createElement(Ft.b,{onUpdate:this._updateDebounced})},t}(i.Component)),Pn="_map_ready",Nn=Object(ut.a)("map-widget-map-component"),zn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onReady=function(){window.document.body.classList.add(Pn),n.setState({isReady:!0})},n.state={isReady:!1},n}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(Cn,{className:Nn(),type:e.config.mapType,initialLocation:e.location,vector:e.config.isVectorEnabled,isPoiEnabled:e.isPoiEnabled,onReady:this._onReady,locationRequest:e.locationRequest,margin:e.margin,onPoiClick:e.onPoiClick,onLocationChange:e.onLocationChange,onSizeChange:e.onSizeChange},i.createElement(xn,null),this.state.isReady?e.children:null)},t}(i.Component),Ln=Object(I.b)(zn);n(285);var Dn=function(e){var t=null,n=null,r=!1,o=!1,i=-1;function a(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];if(o)return r=!0,t=c,void(n=this);e.apply(this,c),o=!0,i=window.requestAnimationFrame(function(){o=!1,r&&(r=!1,n=null,t=null,a.apply(n,t))})}return a.scheduled=o,Object.defineProperty(a,"scheduled",{get:function(){return o}}),a.cancel=function(){window.cancelAnimationFrame(i),i=-1,o=!1,r=!1,n=null,t=null},a},An=n(74),Un=n(203),Fn=Object(Ut.b)(),qn=200,Bn=Fn(function(e){function t(t){var n;return(n=e.call(this,t)||this)._targetZoom=void 0,n._getState=function(){var e=n.props.map;if(!e)return{zoomOutIsEnabled:!1,zoomInIsEnabled:!1};var t=Math.round(100*e.zoom)/100;return{zoomOutIsEnabled:t>e.zoomRange.min,zoomInIsEnabled:t<e.zoomRange.max}},n._updateButtons=function(){n.setState(n._getState())},n._changeZoom=function(e){var t=n.props.map;if(t){var r,o=null!==(r=n._targetZoom)&&void 0!==r?r:t.zoom;n._targetZoom=o+e;var i=n._targetZoom;t.animateCenterAndZoom(t.center,n._targetZoom,qn).then(function(){i===n._targetZoom&&(n._targetZoom=void 0)})}},n._onZoomIn=function(e){e.preventDefault(),n._changeZoom(1)},n._onZoomOut=function(e){e.preventDefault(),n._changeZoom(-1)},n.state=n._getState(),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){!e.map&&this.props.map&&this._updateButtons()},n.render=function(){return i.createElement(i.Fragment,null,i.createElement(Ft.b,{onUpdate:this._updateButtons,onZoomRangeChange:this._updateButtons}),i.createElement(Un.a,{onZoomIn:this._onZoomIn,onZoomOut:this._onZoomOut,disabledZoomIn:!this.state.zoomInIsEnabled,disabledZoomOut:!this.state.zoomOutIsEnabled,size:this.props.size}))},t}(i.PureComponent)),Hn=(n(287),n(458)),Wn=n(195),Gn=Object(kn.a)(I.b,Object(Ut.b)({shouldWait:!0})),Yn=12,Vn=Object(ut.a)("map-copyrights"),Zn=Gn(function(e){function t(t){var n;return(n=e.call(this,t)||this)._rightOffset=void 0,n._update=function(){n.setState({maxWidth:n.props.map.container.offsetWidth-n._rightOffset,copyrights:Object(Wn.a)(n.props.map)})},n._getAdvertItem=function(e){return!e.advertLandingUrl||e.query.embed?null:{type:"advert",text:"Разместить рекламу",href:e.advertLandingUrl+"?utm_source=webmaps&utm_medium=copyright&utm_campaign=webmaps_copyright",noprint:!0}},n._getNmapsItem=function(e){var t=n.props.location;return e.hosts.nmaps&&t&&!e.query.embed?{type:"nmap",text:"Редактировать карту",href:e.hosts.nmaps+"#!/?"+g.a.stringify({ll:Object(Hn.a)(t.center),z:t.zoom}),noprint:!0}:null},n._getTermsItem=function(e,t){return{type:t?"terms_short":"terms",text:t?"Условия":"Условия использования",href:e.agreementUrl+"?lang="+e.lang}},n._getCopyrightsItem=function(){return{type:"copyrights",text:n.state.copyrights,shrink:!0}},n._getRightHoldersItem=function(e){return{type:"right_holders",text:"Правообладатели",href:e.rightHoldersUrl+"?lang="+e.lang}},n._getSupportItem=function(e){return{type:"support",text:"Справка",href:e.feedback.helpUrl+"?lang="+e.lang}},n._getMapsApiItem=function(e){return e.apiManual.mapsApiUrl?{type:"maps_api",text:"API Карт",href:e.apiManual.mapsApiUrl+"/?utm_source=mapscopyrights&utm_medium=referral&utm_campaign=b2bpromo"}:null},n._renderBlock=function(e,t){return i.createElement("div",{className:Vn("block",{type:e})},t.map(function(e){var t=e.href?"a":"div";return i.createElement(dt.a,{name:e.type,logClick:Boolean(e.href),key:e.type},i.createElement(t,{className:Vn("item",{shrink:e.shrink,noprint:e.noprint,type:e.type}),href:e.href,target:"_blank"},e.text))}))},n._renderBlocks=function(){var e=n.props,t=e.config;return e.copyrightOnly?n._renderBlock("copyrights-only",[n._getCopyrightsItem(),n._getTermsItem(t)]):i.createElement(i.Fragment,null,n._renderBlock("copyrights",[n._getCopyrightsItem(),n._getRightHoldersItem(t)]),n._renderBlock("links",[{type:"ya",text:"© "+"Яндекс"},n._getAdvertItem(t),n._getNmapsItem(t),n._getMapsApiItem(t),n._getSupportItem(t),n._getTermsItem(t),n._getTermsItem(t,!0)].filter(function(e){return Boolean(e)})))},n.state={maxWidth:0,copyrights:Object(Wn.a)(n.props.map)},n._rightOffset=n.props.right-Yn,n}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.copyrightOnly?"copyrights-only":"map"===e.layer?"scheme":"satellite";return i.createElement(dt.a,{name:"map_copyrights"},i.createElement("div",{className:Vn({type:t,"show-all":"covid-map"===e.config.query.embed}),style:{maxWidth:this.state.maxWidth,right:this._rightOffset}},this._renderBlocks(),i.createElement(Ft.b,{onResize:this._update,onCopyrightsChange:this._update})))},t}(i.PureComponent)),Kn=(n(289),n(24)),Xn=n(50),$n=(n(291),function(e){var t=e.view,n=e.withoutMargin,r=e.inverse,o=Object(ut.a)("spinner-view_"+t);return i.createElement("div",{className:o({"without-margin":n,inverse:r})},i.createElement("div",{className:o("circle")}))}),Jn=n(228),Qn=n.n(Jn),er=(n(293),Object(ut.a)("map-geolocation-control")),tr=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._onClick=function(e){e.preventDefault(),t.props.onClick()},t._renderIcon=function(){return t.props.isLoading?i.createElement("div",{className:er("spinner")},i.createElement($n,{view:"small",withoutMargin:!0})):i.createElement("div",{className:er("icon"),dangerouslySetInnerHTML:{__html:Qn.a}})},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement("div",{className:er({noprint:!0})},i.createElement(Xn.a,{text:"Моё местоположение",position:"left",isAir:!0},i.createElement(dt.a,{name:"geolocation",logClick:!0},i.createElement(Kn.a,{view:"air",size:e.size||"medium",icon:this._renderIcon(),onClick:this._onClick,disabled:e.isLoading,checked:e.isChecked}))))},t}(i.Component),nr=Object(I.b)(tr);n(294),n(296),n(298);function rr(e,t){if(void 0===t&&(t=1/0),t<1)throw new Error("Can't round to significance of "+t+".");var n=Math.round(e).toString(),r=Math.max(0,n.length-t),o=Math.round(e/Math.pow(10,r));return Number(o+new Array(r).fill("0").join(""))}function or(e){if(e>100)return Math.round(e);var t=Math.pow(10,e>10?1:2);return Math.round(e*t)/t}var ir=Object(ut.a)("map-scale-line"),ar=function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=function(e){var t=Object(Q.a)(e.center,e.zoom),n=t[0],r=t[1],o="width"===e.dimension?1:0,i="height"===e.dimension?1:0,a=Object(ee.a)([n-o*e.maxSize/2,r-i*e.maxSize/2],e.zoom),s=Object(ee.a)([n+o*e.maxSize/2,r+i*e.maxSize/2],e.zoom),c=Object(N.a)(a,s),u=rr(c,1);return{size:Math.abs(c)>1e-7?Math.round(u*e.maxSize/c):e.maxSize,distance:u}}({center:e.center,zoom:e.zoom,dimension:"width",maxSize:75}),n=t.size,r=t.distance,o={};return o.width=n+"px",i.createElement("div",{className:ir(),style:o},i.createElement("div",{className:ir("label")},function(e){return e>900?(function(params){return params.distance+" км";})({distance:rr(e/1e3,2)}):(function(params){return params.distance+" м";})({distance:rr(e,2)})}(r)),i.createElement("div",{className:ir("line")}))},t}(i.PureComponent),sr=Object(I.b)(ar),cr=Object(ut.a)("map-widget-map-scale-line-view"),ur=function(e){return i.createElement("div",{className:cr()},i.createElement(sr,{center:e.location.center,zoom:e.location.zoom}))},lr=(n(299),n(301)),dr=n.n(lr),pr=Object(ut.a)("map-widget-ruler-control-view"),fr=function(e){return i.createElement("div",{className:pr()},i.createElement(Xn.a,{text:"Линейка",position:"left",isAir:!0},i.createElement(Kn.a,{icon:i.createElement("div",{className:pr("icon"),dangerouslySetInnerHTML:{__html:dr.a}}),view:"air",size:"small",onClick:function(){return e.updateRuler({isEnabled:!e.isEnabled})},checked:e.isEnabled})))},mr=(n(302),n(86));var vr=7,gr=4,hr={closed:"Перекрытие движения",drawbridge:"Развод моста",reconstruction:"Дорожные работы",accident:"ДТП",police:"Камера",other:"Прочее",chat:"Прочее",danger:"Опасный участок"};function br(e){return e||0===e?e>=vr?"red":e>=gr?"yellow":"green":"gray"}var yr=n(229),_r=n.n(yr),Er=(n(304),Object(ut.a)("traffic-raw-icon")),wr=Object(I.b)(function(e){var t=e.checked?br(e.level):"none";return i.createElement("div",{className:Er({color:t})},i.createElement("div",{className:Er("icon"),dangerouslySetInnerHTML:{__html:_r.a}}),i.createElement("div",{className:Er("text")},e.checked?e.level:null))}),Sr=Object(ut.a)("map-widget-traffic-control-view"),Or=function(e){var t=i.createElement(wr,{checked:e.isActive,level:e.level});return i.createElement("div",{className:Sr()},i.createElement(Kn.a,{onClick:e.onClick,icon:t,size:"small",view:"air"},e.hasText?"Пробки":null))},Cr=(n(305),n(307),Object(ut.a)("layout-control")),kr=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._root=i.createRef(),t}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=this._root.current.clientHeight,n=this._root.current.clientWidth;e.onUpdate&&e.onUpdate(e.type,{height:t,width:n})},n.render=function(){var e=this.props,t=!e.visible;return i.createElement(dt.a,{group:!0,hidden:t},i.createElement("div",{ref:this._root,className:Cr({hidden:t}),"data-type":e.type},e.children))},t}(i.Component),jr=Object(ut.a)("layout-control-group"),Rr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._root=i.createRef(),n._onResizeThrottled=void 0,n._onUpdate=function(){var e=n.props,t=n._root.current.clientHeight,r=n._root.current.clientWidth;e.height>0&&t>0||e.onUpdate(e.type,{height:t,width:r})},n._onResize=function(){n._onUpdate()},n._onResizeThrottled=Dn(n._onResize),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=this._root.current.clientHeight,n=this._root.current.clientWidth;e.onUpdate(e.type,{position:e.position,height:t,width:n})},n.componentDidUpdate=function(e){this.props.position!==e.position&&this.props.onUpdate(this.props.type,{position:this.props.position})},n.render=function(){var e=this.props,t=!e.visible;return i.createElement(dt.a,{group:!0,hidden:t},i.createElement("div",{ref:this._root,className:jr({side:e.side||"right",hidden:t,animated:e.animated}),"data-type":e.type,style:{transform:"translateY("+e.top+"px)"}},i.createElement(kr,{type:e.type,visible:!0},e.children),i.createElement(qt.a,{onResize:this._onResizeThrottled})))},t}(i.Component),Tr=n(120);function Ir(e){for(var t,n={},o=[],i=0,a=Object(Tr.a)(e.controlsOrder);!(t=a()).done;){var s=t.value,c=s[0],u=s[1],l=0,d=e.controlGroups[c];if(d&&(0!==d[e.dimension]||u)){var p=!n[d.type];p&&(l+=d[e.dimension]+e.betweenMargin);var f=void 0;u&&e.controls&&(l+=(f=e.controls[u])?f[e.dimension]:0);var m=i+l;if(m>e.viewport+e.betweenMargin)break;p&&(n[c]=Object(r.a)({},d)),f&&(n[c][e.dimension]+=f[e.dimension],o.push(f.type)),i=m}}return{controlGroups:n,controls:o}}var Mr=function(e,t,n){var o={top:xr(n.betweenMargin),center:xr(n.betweenMargin),bottom:xr(n.betweenMargin)};e.forEach(function(e){o[e.position].height+=e.height+n.betweenMargin}),o.top.height=Math.max(o.top.height,0),o.center.height=Math.max(o.center.height,0),o.bottom.height=Math.max(o.bottom.height,0),o.top.top=n.topSizes.minTop;var i=o.top.top+o.top.height+n.betweenMargin;return o.bottom.top=Nr(n.topSizes.maxTop-o.bottom.height,i,n.topSizes.maxTop),o.center.top=Nr(n.topSizes.middle-Math.round(o.center.height/2),i,o.bottom.top-n.betweenMargin-o.center.height),e.reduce(function(e,i){var a,s=o[i.position],c=s.top,u=Math.abs(i.top-c),l=u>20&&u<300&&n.enableAnimation,d=Object(r.a)(Object(r.a)({},t[i.type]),{},{animated:l,top:c});return s.top+=i.height+n.betweenMargin,Object(r.a)(Object(r.a)({},e),{},((a={})[i.type]=d,a))},{})};function xr(e){return{top:0,height:-e,width:-e}}function Pr(e,t){return Object.values(e).filter(function(e){return Boolean(e)}).sort(function(e,n){return t.indexOf(e.type)-t.indexOf(n.type)})}function Nr(e,t,n){return Math.max(Math.min(e,n),t)}var zr=Object(ut.a)("map-widget-layout-view"),Lr=12,Dr=10,Ar=305,Ur=["zoom","rulers","top-controls","geolocation"],Fr=["open-in-maps-medium","open-in-maps-small","open-in-maps-tiny"],qr=["open-in-maps-medium","open-in-maps-small","open-in-maps-tiny"],Br=[["zoom"],["top-controls"],["geolocation"]],Hr=[["open-in-maps-medium"],["open-in-maps-small"],["open-in-maps-tiny"],["search"]],Wr=[["open-in-maps-small"]],Gr=[["open-in-maps-medium"]],Yr=zr("portal"),Vr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._repositionThrottled=void 0,n._root=i.createRef(),n._getFittingBottomLayout=function(){var e,t=n.state,r=((null===(e=n._root.current)||void 0===e?void 0:e.clientWidth)||0)-Ar,o=Object.keys(Ir({controlsOrder:Gr,viewport:r,controlGroups:t.controlGroups,betweenMargin:Lr,dimension:"width"}).controlGroups),i=Object.keys(Ir({controlsOrder:Wr,viewport:r,controlGroups:t.controlGroups,betweenMargin:Lr,dimension:"width"}).controlGroups);return 1===o.length?["open-in-maps-medium"]:1===i.length?["open-in-maps-small"]:["open-in-maps-tiny","rulers"]},n._reposition=function(){var e,t=n.state,o=(null===(e=n._root.current)||void 0===e?void 0:e.clientHeight)||0,i=Dr,a=i+o,s=Nr(a,i,o),c=Math.round((a+i)/2),u=n._getFittingBottomLayout(),l=Ir({controlsOrder:Hr.filter(function(e){var t=e[0];return!qr.includes(t)||u.includes(t)}),viewport:o,controlGroups:t.controlGroups,betweenMargin:Lr,dimension:"height"}),d=Ir({controlsOrder:Br,viewport:o,controlGroups:t.controlGroups,betweenMargin:Lr,dimension:"height"}),p=Pr(l.controlGroups,Fr),f=Pr(d.controlGroups,Ur),m=Mr(f,n.state.controlGroups,{betweenMargin:Lr,topSizes:{maxTop:s,minTop:i,middle:c},enableAnimation:!0}),v=Mr(p,n.state.controlGroups,{betweenMargin:Lr,topSizes:{maxTop:s,minTop:i,middle:c},enableAnimation:!0}),g=[].concat(Object.keys(m),Object.keys(v)),h=Object(r.a)(Object(r.a)(Object(r.a)({},t.controlGroups),m),v);Object(Wt.a)(t.controlGroups,h)&&Object(Wt.a)(t.visibleControlGroups,g)||n.setState({visibleControlGroups:g,controlGroups:h})},n._onControlGroupUpdate=function(e,t){n.setState(function(n){var o;return Object(r.a)(Object(r.a)({},n),{},{controlGroups:Object(r.a)(Object(r.a)({},n.controlGroups),{},(o={},o[e]=Object(r.a)(Object(r.a)({type:e},n.controlGroups[e]),t),o))})},n._reposition)},n._getControlGroups=function(){return[{type:"top-controls",position:"top",side:"right",children:n._renderTopControls()},{type:"zoom",position:n.state.visibleControlGroups.length<=2?"top":"center",side:"right",children:n._renderZoomControls()},{type:"geolocation",position:"center",side:"right",children:n._renderGeolocationControl()},{type:"open-in-maps-medium",position:"bottom",side:"left",children:n._renderInMaps("medium")},{type:"open-in-maps-small",position:"bottom",side:"left",children:n._renderInMaps("small")},{type:"open-in-maps-tiny",position:"bottom",side:"left",children:n._renderInMaps("tiny")},{type:"search",position:"top",side:"left",children:n.props.search.render()}]},n._renderGeolocationControl=function(){return i.createElement("div",{className:zr("geolocation")},i.createElement(nr,{onClick:n.props.geolocation.onClick,isLoading:n.props.geolocation.isStarted,size:"small"}))},n._renderTopControls=function(){return i.createElement("div",{className:zr("top-controls")},n._renderRuler(),n._renderTrafficControl())},n._renderTrafficControl=function(){return i.createElement(Or,Object(Gt.a)({},n.props.traffic,{hasText:!0}))},n._renderRuler=function(){return i.createElement("div",{className:zr("ruler")},i.createElement(fr,n.props.ruler))},n._renderInMaps=function(e){return i.createElement("div",{className:zr("maps-links")},n.props.inMaps.render(e))},n._renderZoomControls=function(){return i.createElement("div",{className:zr("zoom-controls")},i.createElement(Bn,{size:"small"}))},n.state={visibleControlGroups:[],controlGroups:{}},n._repositionThrottled=Dn(n._reposition),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._repositionThrottled()},n.render=function(){var e=this,t=this._getControlGroups();return i.createElement("div",{className:zr()},i.createElement("div",{className:zr("layout")},i.createElement("div",{ref:this._root,className:zr("controls")},t.map(function(t){var n,r,o,a,s;return i.createElement(Rr,Object(Gt.a)({},t,{key:t.type,visible:e.state.visibleControlGroups.includes(t.type),animated:null===(n=e.state.controlGroups[t.type])||void 0===n?void 0:n.animated,height:null!==(r=null===(o=e.state.controlGroups[t.type])||void 0===o?void 0:o.height)&&void 0!==r?r:0,top:null!==(a=null===(s=e.state.controlGroups[t.type])||void 0===s?void 0:s.top)&&void 0!==a?a:0,onUpdate:e._onControlGroupUpdate}))})),i.createElement("div",{className:zr("bottom-layout")},i.createElement("div",{className:zr("copyrights")},i.createElement(Zn,{right:100,copyrightOnly:!0})),i.createElement("div",{className:zr("scale-line")},i.createElement(ur,{location:this.props.location}))),i.createElement(qt.a,{onResize:this._repositionThrottled})),i.createElement("div",{className:Yr}))},t}(i.Component),Zr=function(e){return i.createElement(An.a,{selector:"."+Yr},e.children)},Kr=Object(I.b)(Vr),Xr=(n(309),n(107));function $r(e,t,n,r,o){void 0===r&&(r=e(t)),void 0===o&&(o=e(n));var i,a,s,c=Math.PI/60,u=Math.PI/4,l=[],d=Math.abs(Object(mr.a)(Math.atan2(r.direction[0],r.direction[1])-Math.atan2(o.direction[0],o.direction[1]),-Math.PI,Math.PI)),p=0;if(Math.abs(d-Math.PI)<1e-10){var f=[r.point[0],90*r.direction[1]],m=[o.point[0],90*r.direction[1]];l.push(f,m,o.point)}else if(d>c)if((a=Math.ceil(d/c))<u/c||n-t==0){i=(n-t)/a;for(var v=1;v<=a;v++)l.push(e(t+i*v).point)}else s=e(p=t+(i=(n-t)/2)),l=(l=l.concat($r(e,t,p,r,s))).concat($r(e,p,n,s,o));else l.push(o.point);return l}function Jr(e){return function(e){for(var t=[e[0]],n=1;n<e.length;n++){var r=t[n-1],o=e[n];r[0]>0&&o[0]<0&&r[0]>90&&o[0]<0?t.push([o[0]+360,o[1]]):r[0]<0&&o[0]>0&&r[0]<-90&&o[0]>0?t.push([o[0]-360,o[1]]):t.push(o)}return t}(function(e,t,n){for(var r=Object(Xr.a)(e,t,n),o=r.pathFunction,i=r.startPoint,a=r.startDirection,s=r.endPoint,c=r.endDirection,u=[i],l=0;l<3;l++)u=u.concat($r(o,l/3,(l+1)/3,0===l?{point:i,direction:a}:void 0,2===l?{point:s,direction:c}:void 0));return u}(e[0],e[1]))}n(311),n(313);var Qr=n(96),eo=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._ref=i.createRef(),t._onMapUpdate=function(){t.forceUpdate()},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.coordinates,r=Object(St.a)(t,["coordinates"]);return i.createElement(i.Fragment,null,i.createElement(lt.a,{coordinates:n,nonInteractive:!0},i.createElement("div",{ref:this._ref}),i.createElement(Qr.a,Object(Gt.a)({type:"balloon"},r,{getTarget:function(){return e._ref.current}}),r.children)),i.createElement(Ft.b,{onUpdate:r.isShown?this._onMapUpdate:void 0}))},t}(i.PureComponent),to=n(315),no=n.n(to),ro=n(316),oo=n.n(ro),io=Object(ut.a)("ruler-balloon"),ao={main:10,side:0},so={"delete-points":{title:"Удалить все точки?",description:"Чтобы удалить только одну точку, нажмите на неё дважды.",confirmation:"Удалить все"},close:{title:"Выключить линейку?",description:"Вы уверены, что хотите удалить все точки и выключить линейку?",confirmation:"Выключить"}},co=function(e){function t(t){var n;return(n=e.call(this,t)||this)._clearAndDisableRuler=function(){var e,t;n.props.deletePoints(),null===(e=(t=n.props).disableRuler)||void 0===e||e.call(t)},n._openPopup=function(e){n.setState({popupType:e})},n._closePopup=function(){n.setState({popupType:null})},n._clearRuler=function(){n.props.deletePoints()},n._renderPopup=function(){var e=n.state.popupType;if(!e)return null;var t=n.props;return i.createElement(eo,{coordinates:t.coordinates,position:["top","bottom","left","right"],offset:ao,showArrow:!1,isShown:!0},i.createElement(dt.a,{name:"popup",nodeState:{type:e}},i.createElement("div",{className:io("popup")},i.createElement("div",{className:io("title")},so[e].title),i.createElement("div",{className:io("description")},so[e].description),i.createElement("div",{className:io("buttons")},i.createElement("div",{className:io("confirm")},i.createElement(dt.a,{name:"confirm",logClick:!0},i.createElement(Kn.a,{view:"primary",size:"small",onClick:"delete-points"===e?n._clearRuler:n._clearAndDisableRuler},so[e].confirmation))),i.createElement("div",{className:io("cancel")},i.createElement(dt.a,{name:"cancel",logClick:!0},i.createElement(Kn.a,{view:"secondary-blue",size:"small",onClick:n._closePopup},"Отмена")))))))},n._renderTooltip=function(){return i.createElement("div",{className:io("tooltip-wrapper")},i.createElement("div",{className:io("tooltip")},i.createElement("div",{className:io("label")},(e=n.props.distance)>900?(function(params){return params.distance+" км";})({distance:or(e/1e3)}):(function(params){return params.distance+" м";})({distance:or(e)})),n._renderControls()));var e},n._renderControls=function(){return n.props.showControls?i.createElement(dt.a,{name:"controls"},i.createElement("div",{className:io("controls")},n.props.disableRuler?i.createElement(Xn.a,{text:"Очистить точки",position:"bottom",size:"s",isAir:!0},i.createElement(dt.a,{name:"remove_all_points",logClick:!0},i.createElement("div",{className:io("trash"),onClick:function(){return n._openPopup("delete-points")}},i.createElement(Ot.a,{className:io("trash-icon"),url:oo.a})))):null,i.createElement(Xn.a,{text:"Выключить линейку",position:"bottom",size:"s",isAir:!0},i.createElement(dt.a,{name:"turn_off_ruler",logClick:!0},i.createElement("div",{className:io("close"),onClick:function(){return n._openPopup("close")}},i.createElement(Ot.a,{className:io("close-icon"),url:no.a})))))):null},n.state={popupType:null},n}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(lt.a,{coordinates:e.coordinates,zIndex:pt.a.ruler+1,dataSourceId:e.dataSourceId,blockEvents:!0},i.createElement("div",{className:io()},this.state.popupType?this._renderPopup():this._renderTooltip()))},t}(i.Component);n(317);function uo(e,t){var n=t[0],r=t[1],o=[n[1]-r[1],r[0]-n[0],n[0]*r[1]-r[0]*n[1]],i=[o[1],-o[0],e[1]*o[0]-e[0]*o[1]],a=o[0]*i[1]-i[0]*o[1];return[(i[2]*o[1]-o[2]*i[1])/a,(i[0]*o[2]-o[0]*i[2])/a]}var lo=n(111);function po(e,t,n,r,o){for(var i=0;i<e.length-1;i++){var a=[e[i],e[i+1]];if(Object(lo.a)(Object(Q.a)(t,r),Object(Q.a)(a[0],r),Object(Q.a)(a[1],r))<n/2){var s=uo(t,[a[0],a[1]]);return o?{point:s,segmentIndex:i}:s}}}var fo,mo=Object(ut.a)("map-line-editor"),vo=pt.a.editing-3,go=pt.a.editing-1,ho=pt.a.editing-2,bo=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setLayers=function(e){var t=n.props.map,r=t.getLayers(),o=r.topRasterLayers,i=r.mainLayers,a=[].concat(o,i),s=n.props.config.uatraits.isMobile?"click":"fastclick";n.props.editorLayerOwner?(a.push(At.b),fo=n.props.editorLayerOwner,t.events.on(s,At.b,n._onEditorLayerClick)):e&&(e.editorLayerOwner===fo&&(a=a.filter(function(e){return e!==At.b}),fo=void 0),t.events.off(s,At.b,n._onEditorLayerClick)),t.setLayers(Object(At.j)(a,n.props.ymaps3.EventBlockerLayer,n.props.config))},n._onEditorLayerClick=function(e,t){n.props.onPointAdd(t.coordinates,n.props.points.length)},n._updatePoint=function(e,t,r){n.props.onPointUpdate&&void 0!==t&&n.props.onPointUpdate(e,t,Boolean(r))},n._onMouseMove=function(e){var t=n.props.map.convertScreenToWorldCoordinates(e).coordinates;if(n.props.onLineMouseMove&&n.props.onLineMouseMove(e,{coordinates:t}),n.props.polyLineCoordinates&&n.props.isActive&&void 0===n.state.draggingPoint){var r=Math.max.apply(Math,n.props.lineStyle.stroke.map(function(e){return e.width||0})),o=po(n.props.polyLineCoordinates,t,r,n.props.map.zoom,!0);o&&"point"in o&&n.setState({previewPoint:o})}},n._onNewPointDragStart=function(){var e=n.state,t=n.props;if(e.previewPoint){var r=function(e,t,n){for(var r=0,o=0;o<e.length-1;o++){var i=t[r];if(i&&Object(vt.a)(i,e[o],15e-7)&&(r+=1),o===n)return r}return r}(t.polyLineCoordinates,t.points,e.previewPoint.segmentIndex)||void 0;void 0!==r&&e.previewPoint.point&&(n.setState({draggingPoint:{index:r,point:e.previewPoint.point}}),t.onPointAdd(e.previewPoint.point,r))}},n._onExistingPointDragStart=function(e){n.props.points[e]&&n.setState({draggingPoint:{index:e,point:n.props.points[e]}})},n._onDragMove=function(e){var t=e.coordinates,r=n.state;r.draggingPoint&&(n.setState({draggingPoint:{index:r.draggingPoint.index,point:t}}),n._updatePoint(t,r.draggingPoint.index))},n._onDragEnd=function(){var e=n.state;e.draggingPoint&&(n.setState({draggingPoint:void 0,previewPoint:void 0}),n._updatePoint(e.draggingPoint.point,e.draggingPoint.index,!0))},n._onPointDoubleClick=function(e){n.props.isActive&&n.props.onPointRemove&&n.props.onPointRemove(e)},n._onPointClick=function(e){n.props.onPointClick&&n.props.onPointClick(e)},n._renderDraggingOrPreviewPoint=function(){var e=n.state,t=n.props,r=e.draggingPoint||e.previewPoint;if(!r||!t.isActive||t.config.uatraits.isMobile)return null;var o="segmentIndex"in r;return i.createElement(lt.a,{coordinates:r.point,onDragStart:n._onNewPointDragStart,onDragMove:n._onDragMove,onDragEnd:n._onDragEnd,onMouseMove:n._onMouseMove,onMouseLeave:t.onPreviewPointMouseLeave,onClick:t.onPreviewPointClick,zIndex:o?vo:go,draggable:t.isActive,dataSourceId:At.d[t.editorLayerOwner?"EDITOR_MARKERS":"DEFAULT_MARKERS"],blockEvents:!0},o?i.createElement("div",{className:mo("preview-point")},t.previewPointElement):n.props.renderPointElement("index"in r&&r.index||0))},n._renderPoints=function(){return n.props.points.map(function(e,t){return i.createElement(lt.a,{key:t,onDragStart:function(){return n._onExistingPointDragStart(t)},onDragMove:n._onDragMove,onDragEnd:n._onDragEnd,onDoubleClick:function(){return n._onPointDoubleClick(t)},onClick:function(){return n._onPointClick(t)},coordinates:e,draggable:n.props.isActive,zIndex:ho,dataSourceId:At.d[n.props.editorLayerOwner?"EDITOR_MARKERS":"DEFAULT_MARKERS"],blockEvents:!0,nonInteractive:!n.props.isActive},n.state.draggingPoint&&n.state.draggingPoint.index===t?null:n.props.renderPointElement(t))})},n.state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._setLayers()},n.componentDidUpdate=function(e){e.editorLayerOwner!==this.props.editorLayerOwner&&this._setLayers(e)},n.render=function(){var e=this.props.editorLayerOwner?"EDITOR_GRAPHICS":"DEFAULT_GRAPHICS";return i.createElement(i.Fragment,null,this._renderDraggingOrPreviewPoint(),this._renderPoints(),i.createElement(gt.a,{drawingStyle:this.props.lineStyle,geometry:{type:"LineString",coordinates:this.props.polyLineCoordinates},onMouseMove:this._onMouseMove,onMouseEnter:this.props.onLineMouseEnter,onMouseLeave:this.props.onLineMouseLeave,dataSourceId:At.d[e],onClick:this.props.onPreviewPointClick}))},t}(i.Component);var yo=Object(Ut.b)({shouldWait:!0})(Object(I.b)(bo)),_o=n(319),Eo=n.n(_o),wo={stroke:[{color:"#666",width:3,opacity:.7},{color:"#fff",width:5,opacity:.7}],simplificationRate:0},So=Object(ut.a)("ruler-view"),Oo=function(e){function t(t){var n;return(n=e.call(this,t)||this)._caclGeodesicLine=function(){var e=n.props.points,t=e[0],r=e.slice(1),o=function(e){return[e[0],Math.min(Math.max(e[1],-85),85)]};return r.reduce(function(e,t){var n=t.coordinates;return[].concat(e,Jr(ht([e.pop(),o(n)])))},t?[o(t.coordinates)]:[])},n._onPointAdd=function(e,t){n._updatePoints(t,e)},n._onPointUpdate=function(e,t){n._updatePoints(t,e,!0)},n._onPointRemove=function(e){n._updatePoints(e,void 0,!0)},n._updatePoints=function(e,t,o){if(n.props.onUpdate){var i=n.props.points,a=i.slice(0,e);t&&a.push({coordinates:t,distance:Co(t,a[a.length-1]),showBalloon:i[e]&&i[e].showBalloon}),i.slice(e+(o?1:0)).forEach(function(e){a.push(Object(r.a)(Object(r.a)({},e),{},{distance:Co(e.coordinates,a[a.length-1])}))}),n.props.onUpdate(a)}},n._togglePointBalloon=function(e){if(n.props.onUpdate){var t=n.props.points,o=Object(r.a)(Object(r.a)({},t[e]),{},{showBalloon:!t[e].showBalloon}),i=[].concat(t.slice(0,e),[o],t.slice(e+1));n.props.onUpdate(i)}},n._renderBalloon=function(e,t){var r=t===n.props.points.length-1;return 0===t||!e.showBalloon&&!r?null:i.createElement(co,{key:t,coordinates:e.coordinates,distance:e.distance,showControls:r,dataSourceId:n.props.isEnabled?At.d.EDITOR_MARKERS:void 0,disableRuler:n.props.disableRuler,deletePoints:n.props.deletePoints})},n._renderPoint=function(){return i.createElement("div",{className:So("point")},i.createElement(Ot.a,{url:Eo.a}))},n.state={geodesicLine:n._caclGeodesicLine()},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){e.points!==this.props.points&&this.setState({geodesicLine:this._caclGeodesicLine()})},n.render=function(){var e=this.props.points;return i.createElement(i.Fragment,null,i.createElement(yo,{previewPointElement:i.createElement("div",{className:So("preview-point")}),renderPointElement:this._renderPoint,polyLineCoordinates:this.state.geodesicLine,points:e.map(function(e){return e.coordinates}),lineStyle:wo,isActive:Boolean(this.props.onUpdate),onPointAdd:this._onPointAdd,onPointUpdate:this._onPointUpdate,onPointRemove:this._onPointRemove,onPointClick:this._togglePointBalloon,editorLayerOwner:this.props.isEnabled?"ruler":void 0}),e.map(this._renderBalloon))},t}(i.Component);function Co(e,t){return t?t.distance+Object(N.a)(e,t.coordinates):0}Oo.displayName="RulerComponent";var ko=Object(I.b)(Oo),jo=function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(ko,{points:e.ruler.points,isEnabled:e.ruler.isEnabled,onUpdate:function(t){return e.updateRuler({points:t})},deletePoints:function(){return e.updateRuler({points:[]})},disableRuler:function(){return e.updateRuler({points:[],isEnabled:!1})}})},t}(i.Component),Ro=n(121),To=n(200),Io="Expected a function";function Mo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Io);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(Mo.Cache||To.a),n}Mo.Cache=To.a;var xo=Mo,Po=n(119),No=n(104),zo=function(e){return i.createElement(No.a,{type:"mapNode"},i.createElement(dt.a,e,e.children))},Lo=n(453),Do=n(127),Ao={getTimings:function(e,t){var n=new RegExp("/tiles\\?.*l=("+e.join("|")+")"),r=Do.a.getResourcesTimings(function(e){return n.test(e)}).filter(function(e){var n=v.parse(e.name),r=[[256*Number(n.x),256*Number(n.y)],[256*(Number(n.x)+1),256*(Number(n.y)+1)]];return Object(Lo.a)(t,r)&&e.responseEnd<6e5&&e.responseEnd>0&&e.duration<6e5&&e.duration>=0});if(0!==(r=r.filter(function(e,t){var n=e.name;return r.findIndex(function(e){return e.name===n})===t})).length){r.sort(function(e,t){return t.responseEnd-e.responseEnd});var o=r.reduce(function(e,t){return e+t.duration},0);return{averageDuration:Math.round(o/r.length),minLoadEnd:Math.round(r[r.length-1].responseEnd),medianaLoadEnd:Math.round(r[Math.floor(r.length/2)].responseEnd),maxLoadEnd:Math.round(r[0].responseEnd)}}}},Uo=function(e){return e.ready?i.createElement(No.a,{type:"timingNode"},i.createElement(dt.a,{name:e.type,nodeState:Object(r.a)({ready:e.ready},e.extraState)},e.children)):null},Fo=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){if(!t.isTimingLogged){var e=this.props,n=e.config.pageMode;"search-result"===e.config.pageMode&&(n="search"),"metro_page"===e.type&&(n="metro"),function(e){switch(e){case"routes_page":return"routes";case"org_page":return"orgpage";case"discovery_page":return"discovery";case"home_page":return"home";case"panorama_page":return"panoramas";case"photos_page":return"photos";case"search_card_page":case"search_list_page":return"search";case"traffic_page":return"traffic";case"masstransit_stop_page":case"masstransit_route_page":return"masstransit";case"catalog_page":return"catalog";case"metro_page":return"metro"}}(e.type)===n&&(t.isTimingLogged=!0,z.h(nt(e.config))||this.setState({ready:Do.a.getTimeToNow()}))}},n.render=function(){var e=this.props.type;return"undefined"==typeof window?null:i.createElement(Uo,{type:e,ready:this.state.ready,extraState:{show:window.timingsMarks&&e in window.timingsMarks?window.timingsMarks[e]:this.state.ready}})},t}(i.PureComponent);Fo.isTimingLogged=!1;var qo=Object(I.b)(Fo),Bo=!0,Ho=function(e){function t(t){var n;(n=e.call(this,t)||this)._asyncRoadEventAction=void 0,n._memoizedCreateHotspotFetchFunction=xo(Zt.a),n._onTilesReady=function(){if(!n.state.tilesReady){var e=n.props,t=Object(Ro.a)(e.mapLocation.bounds,e.mapLocation.zoom);if(n.setState({tilesReady:!0}),Bo){var r=Ao.getTimings(["trf"],t);r&&n.setState({tilesTimings:r}),Bo=!1}}},n._countTrafficModeChange=function(){Po.a.reachGoal("traffic")},n._shouldHover=function(e){return void 0!==e.geometry},n._renderLayer=function(){var e=n.props,t=e.config;if(!t.layers.trf||!e.version)return null;var r=e.data,o=t.layers.trf.zoomRange?{min:t.layers.trf.zoomRange[0],max:t.layers.trf.zoomRange[1]}:void 0;switch(r.providerKey){case"traffic#actual":var a=t.hosts.traffic+"1.1/tiles?trf&%n&%l&%c&tm=%v",s=e.infoLayerShown?n._memoizedCreateHotspotFetchFunction(Object(At.e)(Object(At.k)(a.replace("%n","l=trje")+"&format=json",t.lang,e.version),t)):void 0,c=e.infoLayerShown?"trf,trfe":"trf";return i.createElement(Qt,{layer:"trf",dataSource:{type:"tile",vector:Object(At.f)({priority:"medium",tileUrl:Object(At.k)(t.hosts.traffic+"2.x/tiles?trf&l="+c+"&%l&x={{x}}&y={{y}}&z={{z}}&tm=%v&format=protobuf",t.lang,e.version),imageUrl:t.hosts.traffic+"icons/{{id}}?scale={{scale}}&id={{id}}",glyphRangeUrl:t.hosts.vectorGlyphs.replace("{{lang}}",t.lang),mapMode:Object(At.h)(t)},t),raster:{tileUrl:Object(At.e)(Object(At.k)(a.replace("%n","l="+c),e.config.lang,e.version),t),fetchHotspots:s,transparent:!0},zoomRange:o},onClick:n.props.onActualEventClick,shouldHover:n._shouldHover});case"traffic#archive":return i.createElement(Qt,{layer:"trfa",dataSource:{type:"tile",raster:{tileUrl:Object(At.e)(Object(At.k)(t.hosts.trafficArchive+"tiles?trj&l=trf&%l&%c&tm=%v",t.lang,e.version),t),transparent:!0},zoomRange:o}});default:return null}};var r=t.config.query;return Bo=Bo&&r.l&&r.l.split(",").includes("trf"),n.state={tilesReady:!1},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._countTrafficModeChange()},n.componentDidUpdate=function(e){var t=this.props;e.data.providerKey!==t.data.providerKey&&this._countTrafficModeChange()},n.componentWillUnmount=function(){p.a.cancel(this._asyncRoadEventAction),Bo=!1},n.render=function(){var e=this.props,t=this.state;return i.createElement(i.Fragment,null,i.createElement(Ft.b,{onReady:this._onTilesReady}),this._renderLayer(),i.createElement(zo,{name:"traffic_layer",nodeState:{providerKey:e.data.providerKey}}),i.createElement(Uo,{type:"traffic_tiles",ready:t.tilesTimings?t.tilesTimings.averageDuration:void 0,extraState:t.tilesTimings}),this.state.tilesReady?i.createElement(qo,{type:"traffic_page"}):null)},t}(i.Component),Wo=Object(I.b)(Ho),Go=(n(320),n(454)),Yo=10,Vo=32,Zo=22;n(230),n(323);var Ko=n(265),Xo=n(89),$o=n(90),Jo=function(e){var t=this;this._listeners=[],this._ref=void 0,this.addListener=function(e){return t._listeners.push(e),e(t._ref.current,null),function(){return t._removeListener(e)}},this._removeListener=function(e){t._listeners=t._listeners.filter(function(t){return t!==e})},this.fire=function(e){t._listeners.forEach(function(n){return n(t._ref.current,e)})},this._ref=e},Qo=Object(ut.a)("scroll"),ei={},ti=64,ni={passive:!0},ri=function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=x.a.v4(),n._onResizeThrottled=void 0,n._onMouseMoveThrottled=void 0,n._container=i.createRef(),n._content=null,n._wrap=i.createRef(),n._scrollbar=null,n._scrollbarThumb=null,n._height=void 0,n._ratio=1,n._startPageY=0,n._startScrollTop=0,n._emitter=void 0,n._onSelectStart=null,n._getContainer=function(){return n.props.containerRef||n._container},n._onScroll=function(e){n._emitter.fire(e)},n._onResize=function(){n._wrap.current&&n._content&&(n._height=n._wrap.current.clientHeight,n._ratio=n._height/n._content.clientHeight,"dynamic"===n.props.width&&n._fixContentWidth(),n._scrollbarThumb&&(n._updateScrollbarThumbPosition(n._getContainer().current.scrollTop),n._scrollbarThumb.style.height=100*n._ratio+"%"),n._showHideScrollbar(n._ratio<1))},n._onScrollSelf=function(){var e=n._getContainer().current;if(e){var t=n.props;n._scrollbarThumb&&n._updateScrollbarThumbPosition(e.scrollTop),t.cacheKey&&(ei[t.cacheKey]=e.scrollTop),t.onScroll&&t.onScroll(e.scrollTop),t.onScrollToEnd&&e.clientHeight+e.scrollTop>=e.scrollHeight&&t.onScrollToEnd()}},n._onWheel=function(e){n._getContainer().current.scrollTop=n._getContainer().current.scrollTop+e.deltaY},n._onScrollbarClick=function(e){var t=n._getContainer().current,r=n._scrollbarThumb;e.pageY<r.getBoundingClientRect().top?t.scrollTop-=n._height:t.scrollTop+=n._height},n._onMouseDown=function(e){var t=n._wrap.current,r=n._getContainer().current;t&&r&&(window.addEventListener("mouseup",n._onMouseUp,ni),window.addEventListener("mousemove",n._onMouseMoveThrottled,ni),t.classList.add("_pressed"),n._startPageY=e.pageY,n._startScrollTop=r.scrollTop,n._onSelectStart=r.onselectstart,r.onselectstart=function(e){e.preventDefault()})},n._onMouseUp=function(){var e=n._wrap.current,t=n._getContainer().current;e&&t&&(n._removeMouseListeners(),e.classList.remove("_pressed"),t.onselectstart=n._onSelectStart)},n._onMouseMove=function(e){var t=n._getContainer().current;n._scrollbar&&(t.scrollTop=n._startScrollTop+(e.pageY-n._startPageY)/n._ratio)},n._removeMouseListeners=function(){window.removeEventListener("mouseup",n._onMouseUp,ni),window.removeEventListener("mousemove",n._onMouseMoveThrottled,ni)},n._updateScrollbarThumbPosition=function(e){n._scrollbarThumb.style.setProperty(Object(Dt.a)().styles.transform,"translate3d(0, "+Math.ceil(e*n._ratio)+"px, 0)")},n._fixContentWidth=function(){var e=n._getContainer().current,t=n._content,r=e.offsetWidth-e.clientWidth;t.style.marginRight=-r+"px"},n._showHideScrollbar=function(e){var t=n._scrollbar;t&&(t.style.display=e?"flex":"none")},n._restoreScrollPosition=function(){var e=n.props,t=n._getContainer().current,r=e.cacheKey&&ei[e.cacheKey]||0;t.scrollTop!==r&&(0===r?t.scrollTop=r:Rn()(function(){return t.scrollTop=r}))},n._onResizeThrottled=Object(Ko.a)(n._onResize,ti),n._onMouseMoveThrottled=Object(Ko.a)(n._onMouseMove,ti),n._emitter=new Jo(n._getContainer()),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._onResize(),setTimeout(this._onResize,0),this._restoreScrollPosition(),this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(this._getContainer().current),this._getContainer().current.addEventListener("scroll",this._onScroll,ni),this._emitter.fire(null)},n.componentDidUpdate=function(e){var t=this.props;e.cacheKey!==t.cacheKey&&this._restoreScrollPosition()},n.componentWillUnmount=function(){this._removeMouseListeners(),this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(null),this._getContainer().current.removeEventListener("scroll",this._onScroll,ni),this._emitter.fire(null),this._onResizeThrottled.cancel(),this._onMouseMoveThrottled.cancel()},n.render=function(){var e=this,t=this.props;return i.createElement("div",{className:Qo({width:t.width||"narrow",disabled:t.disabled,"full-height":t.fullHeight}),ref:this._wrap},i.createElement("div",{className:Qo("container"),ref:this._getContainer()},i.createElement("div",{className:Qo("content"),ref:function(t){return e._content=t}},i.createElement($o.a,{value:{addListener:this._emitter.addListener,getScrollableNode:function(){return e._getContainer().current},scrollId:this._id,registerStickyElement:this.props.registerStickyElement,unregisterStickyElement:this.props.unregisterStickyElement,updateStickyElement:this.props.updateStickyElement,getStickyElementsOffsetTop:this.props.getStickyElementsOffsetTop}},t.children,i.createElement(Xo.a,{eventHandler:this._onScrollSelf,throttleWait:ti})),i.createElement(qt.a,{onResize:this._onResizeThrottled})),i.createElement(qt.a,{onResize:this._onResizeThrottled}),t.config.uatraits.isTablet?null:i.createElement("div",{className:Qo("scrollbar",{noprint:!0}),ref:function(t){return e._scrollbar=t},onWheel:this._onWheel},i.createElement("div",{className:Qo("scrollbar-track"),onClick:this._onScrollbarClick}),i.createElement("div",{className:Qo("scrollbar-thumb"),ref:function(t){return e._scrollbarThumb=t},onMouseDown:this._onMouseDown}))),i.createElement(Bt.a,{type:"resize",listener:this._onResizeThrottled,options:ni}))},t}(i.Component),oi=Object(I.b)(ri),ii=Object(ut.a)("scroll"),ai={},si={passive:!0},ci=function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=x.a.v4(),n._container=i.createRef(),n._emitter=void 0,n._provider=void 0,n._getContainer=function(){return n.props.containerRef||n._container},n._onScroll=function(e){n._getContainer().current&&n._emitter.fire(e)},n._restoreScrollPosition=function(){var e=n.props,t=n._getContainer().current,r=e.cacheKey&&ai[e.cacheKey]||0;t.scrollTop!==r&&window.requestAnimationFrame(function(){return t.scrollTop=r})},n._onScrollSelf=function(){var e=n._getContainer().current;if(e){var t=n.props;t.cacheKey&&(ai[t.cacheKey]=e.scrollTop),t.onScroll&&t.onScroll(e.scrollTop),t.onScrollToEnd&&e.clientHeight+e.scrollTop>=e.scrollHeight&&t.onScrollToEnd()}},n._emitter=new Jo(n._getContainer()),n._provider={addListener:n._emitter.addListener,getScrollableNode:function(){return n._getContainer().current},registerStickyElement:n.props.registerStickyElement,unregisterStickyElement:n.props.unregisterStickyElement,updateStickyElement:n.props.updateStickyElement,getStickyElementsOffsetTop:n.props.getStickyElementsOffsetTop,scrollId:n._id},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(this._getContainer().current),this._restoreScrollPosition(),this._getContainer().current.addEventListener("scroll",this._onScroll,si),this._emitter.fire(null)},n.componentDidUpdate=function(e){var t=this.props;e.cacheKey===t.cacheKey&&(e.cacheKey||t.cacheKey)||this._restoreScrollPosition()},n.componentWillUnmount=function(){this._getContainer().current.removeEventListener("scroll",this._onScroll,si),this._emitter.fire(null)},n.render=function(){var e=this.props;return i.createElement("div",{className:ii({width:e.width||"narrow",disabled:e.disabled,native:e.native,"full-height":e.fullHeight})},i.createElement("div",{className:ii("container"),ref:this._getContainer()},i.createElement("div",{className:ii("content")},i.createElement($o.a,{value:this._provider},e.children,i.createElement(Xo.a,{eventHandler:this._onScrollSelf,throttleWait:64})))))},t}(i.Component),ui=function(e){function t(t){var n;return(n=e.call(this,t)||this)._stickyListeners=void 0,n._stickyHeights=void 0,n._stickyRefs=void 0,n._registerStickyElement=function(e,t,r){n._stickyHeights[e]=0,n._stickyRefs[e]=t,n._stickyListeners[e]=r,n._calcStickyPositions(Math.max(e-1,0))},n._unregisterStickyElement=function(e){delete n._stickyHeights[e],delete n._stickyRefs[e]},n._updateStickyElement=function(e,t){n._stickyHeights[e]=t,n._calcStickyPositions(e)},n._calcStickyPositions=function(e){for(var t=0,r=0;r<=e;r++)"number"==typeof n._stickyHeights[r]&&(t+=n._stickyHeights[r]);for(var o=e+1;o<n._stickyHeights.length;o++){var i,a;null===(i=(a=n._stickyListeners)[o])||void 0===i||i.call(a,t),"number"==typeof n._stickyHeights[o]&&(t+=n._stickyHeights[o])}},n._isNodeWithinStickyElement=function(e){return n._stickyRefs.some(function(t){var n;return null===(n=t.current)||void 0===n?void 0:n.contains(e)})},n._getStickyElementsOffsetTop=function(){return n._stickyHeights.filter(Boolean).reduce(function(e,t){return e+t},0)},n._stickyListeners=[],n._stickyHeights=[],n._stickyRefs=[],n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e,t;null===(e=(t=this.props).setIsNodeWithinStickyElementRef)||void 0===e||e.call(t,this._isNodeWithinStickyElement)},n.componentWillUnmount=function(){var e,t;null===(e=(t=this.props).setIsNodeWithinStickyElementRef)||void 0===e||e.call(t,void 0)},n.render=function(){var e=this.props.native?ci:oi;return i.createElement(e,Object(Gt.a)({},this.props,{getStickyElementsOffsetTop:this._getStickyElementsOffsetTop,registerStickyElement:this._registerStickyElement,unregisterStickyElement:this._unregisterStickyElement,updateStickyElement:this._updateStickyElement}))},t}(i.Component),li=Object(I.b)(ui),di=(n(325),Object(ut.a)("close-button")),pi=function(e){var t=e.color,n=void 0===t?"black":t,r=e.offset,o=void 0===r?"small":r,a=e.onClick,s=e.circle,c=e.relative,u=e.usePortal,l=i.createElement("div",{className:di({color:n,circle:s,relative:c,offset:"string"==typeof o?o:void 0}),onClick:a,style:"string"==typeof o?{}:o},i.createElement(bt.a,{inline:!0,name:s?"close":"cross",size:s?24:16}));return u?i.createElement(An.a,{selector:".body"},l):l},fi=Object(ut.a)("map-widget-content-view"),mi=300,vi={top:10,right:8},gi=function(e){function t(t){var n;return(n=e.call(this,t)||this)._containerRef=null,n._scrollRef=i.createRef(),n._updateMapLocation=function(){var e;if(n.props.updateLocationRequest){var t=n.state.maxHeight||n.state.height,r=null===(e=n._containerRef)||void 0===e?void 0:e.offsetWidth;if(t&&r){var o,i,a,s="panel"===n.props.displayType?(o=n.props.mapLocation,i=n.props.coordinates,(a=Object(Q.a)(i,o.zoom))[1]+=Vo,Object(ee.a)(a,o.zoom)):function(e,t,n,r){var o,i=e.bounds,a=Object(Go.a)(i,t)?e.center:t,s=Object(Go.a)(i,t)?t:e.center,c=Object(Q.a)(a,e.zoom),u=Object(Q.a)(s,e.zoom),l=i.map(function(t){return Object(Q.a)(t,e.zoom)}),d=u[0]-l[0][0],p=l[1][0]-u[0],f=u[1]-l[1][1],m=Math.min(d,p),v=[].concat(c),g=Math.ceil(n.width/2);if(m<g){var h=g-m;d>=p?v[0]+=h:v[0]-=h}var b=n.height+(null!==(o=null==r?void 0:r.main)&&void 0!==o?o:0);return f<b&&(v[1]-=b-f+Yo),Object(ee.a)(v,e.zoom)}(n.props.mapLocation,n.props.coordinates,{width:r,height:t},n.props.offset);n.props.updateLocationRequest({center:s,duration:mi})}}},n._updateWidthHeight=function(){var e,t,r,o;n._containerRef&&n.setState({height:n._containerRef.clientHeight,width:"balloon"===n.props.displayType?n._containerRef.clientWidth:void 0,maxHeight:"balloon"===n.props.displayType?(e=n.props.mapLocation,t=n._containerRef.clientHeight,r=e.bounds.map(function(t){return Object(Q.a)(t,e.zoom)}),o=r[0][1]-r[1][1]+Zo,o<t?o:t):Math.ceil(n.props.mapSize.height/2)},function(){return n._updateMapLocation()})},n._setContainerRef=function(e){n._containerRef=e,n._updateWidthHeight()},n._renderContainer=function(){return i.createElement("div",{className:fi("container"),ref:n._setContainerRef,style:{height:n.state.height,maxHeight:n.state.maxHeight,width:n.state.width}},i.createElement(li,{width:"dynamic",containerRef:n._scrollRef},i.createElement("div",{className:fi("frame")},n.props.children)))},n.state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this;e.coordinates===this.props.coordinates&&e.displayType===this.props.displayType||this.setState({height:void 0,width:void 0,maxHeight:void 0},function(){t._updateWidthHeight()})},n.render=function(){var e=this.props;return"balloon"===e.displayType?i.createElement(eo,{coordinates:e.coordinates,key:e.coordinates.join(),position:"top",restrictPosition:!0,type:"normal",skipMaxHeight:!0,offset:e.offset,isShown:!0},i.createElement("div",{className:fi("balloon")},i.createElement(pi,{offset:vi,onClick:e.onClose}),this._renderContainer())):i.createElement(Zr,null,i.createElement("div",{className:fi("panel"),key:e.coordinates.join()},i.createElement(pi,{offset:vi,onClick:e.onClose}),this._renderContainer()))},t}(i.Component),hi=(n(327),n(66)),bi=Object(ut.a)("traffic-road-event-content-view"),yi=function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=this.props.event;if(!t.position)return null;var n,r=t.time_start||t.time_end,o=t.time_start_value&&t.tzOffset&&Object(ke.a)(new Date(1e3*Number(t.time_start_value)),t.tzOffset)||void 0,a=t.time_end_value&&t.tzOffset&&Object(ke.a)(new Date(1e3*Number(t.time_end_value)),t.tzOffset)||void 0;return i.createElement("div",{className:bi()},i.createElement("div",{className:bi("title")},(n=this.props.event.type||"other")&&hr[n]||hr.other),t.description?i.createElement("div",{className:bi("description"),dangerouslySetInnerHTML:{__html:t.description}}):null,r?i.createElement("div",{className:bi("time"),dangerouslySetInnerHTML:{__html:o&&a?Object(hi.b)(o,e.config)+" &mdash; "+Object(hi.b)(a,e.config):o?Object(hi.b)(o,e.config):""}}):null,t.author?i.createElement("div",{className:bi("source")},i.createElement("span",{className:bi("source-label")},"Источник"),t.link?i.createElement("a",{className:bi("source-link"),href:t.link.href,target:"_blank"},t.author.name):null):null)},t}(i.Component),_i=Object(I.b)(yi);function Ei(e){var t,n;return(null===(t=e.query.l)||void 0===t?void 0:t.includes("trfe"))||(null===(n=e.userMap)||void 0===n?void 0:n.isTrafficShown)}function wi(e){return"atm"===e.query.rtm}function Si(e){var t;return null!==(t={auto:"auto",mt:"masstransit",pd:"pedestrian",bc:"bicycle"}[e.query.rtt])&&void 0!==t?t:"auto"}var Oi={providerKey:"traffic#actual",state:null},Ci={main:16,side:0},ki=function(e){function t(t){var n,r;return(r=e.call(this,t)||this)._loadTrafficLayerAction=void 0,r._loadTrafficLevelAction=void 0,r._updateTrafficLayerTimer=-1,r._updateTrafficLayer=function(){var e=r.props;p.a.cancel(r._loadTrafficLayerAction),r._loadTrafficLayerAction=p.a.create(Promise.all([Mn.getLayer({layer:"trf",center:r.props.mapLocation.center,zoom:r.props.mapLocation.zoom},e.config),Mn.getLayer({layer:"trf"},e.config)]),{success:r._onTrafficLayerDataLoad})},r._onTrafficLayerDataLoad=function(e){var t=e[0],n=e[1],o=r.props;n&&r.setState({version:n.version}),t&&t.timezone?(p.a.cancel(r._loadTrafficLevelAction),r._loadTrafficLevelAction=p.a.create(T.actual.getLevel(t.timezone.ids,o.config),{success:function(e){r.props.onTrafficLevelChange(e.level)},fail:function(){return r.props.onTrafficLevelChange(null)}})):r.props.onTrafficLevelChange(null)},r._getDisplayType=function(){return r.props.mapSize.width*r.props.mapSize.height>16e4?"balloon":"panel"},r._renderContent=function(){return r.props.content?i.createElement(gi,{displayType:r._getDisplayType(),mapLocation:r.props.mapLocation,coordinates:r.props.content.data.coordinates,onClose:r.props.resetContentData,updateLocationRequest:r.props.updateLocationRequest,offset:Ci,mapSize:r.props.mapSize},i.createElement(_i,{event:r.props.content.data.event})):null},r.state={version:null===(n=t.config.layers.trf)||void 0===n?void 0:n.version},r}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this._updateTrafficLayer(),this._updateTrafficLayerTimer=window.setInterval(function(){return e._updateTrafficLayer()},12e4)},n.componentDidUpdate=function(e){e.mapLocation!==this.props.mapLocation&&this._updateTrafficLayer()},n.componentWillUnmount=function(){window.clearInterval(this._updateTrafficLayerTimer),p.a.cancel(this._loadTrafficLayerAction),p.a.cancel(this._loadTrafficLevelAction)},n.render=function(){var e=this.props,t=this.state;return i.createElement(i.Fragment,null,i.createElement(Wo,{mapLocation:e.mapLocation,version:t.version,infoLayerShown:Ei(e.config),data:Oi,onActualEventClick:this.props.onActualEventClick}),this._renderContent())},t}(i.Component),ji=Object(I.b)(ki);var Ri=n(85);function Ti(e){var t=[[0,0],[0,0]];e.length&&(t=function(e,t,n){var r=[[1/0,1/0],[-1/0,-1/0]],o=e.length;return[0,1].forEach(function(i){if(n[i]){e.sort(function(e,t){return e[i]-t[i]});var a=0;e.forEach(function(n,s){var c=s+1,u=c===o?e[0]:e[c],l=Object(mr.a)(u[i]-n[i],0,t);l>=a&&(a=l,r[0][i]=u[i],r[1][i]=n[i])}),r[0][i]>r[1][i]&&(r[1][i]+=t)}else e.forEach(function(e){r[0][i]=Math.min(r[0][i],e[i]),r[1][i]=Math.max(r[1][i],e[i])})}),r}(e.map(function(e){return Object(Q.a)(e,ft.g)}),Object(Ri.a)(ft.g),ft.k).map(function(e){return Object(ee.a)(e,ft.g)}));return t}n(329);var Ii,Mi,xi=n(3),Pi=n(240),Ni=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=i.createRef(),n._calcSizes=function(e){return new Promise(function(t){n.setState({render:e},function(){var e=n._ref.current.children[0],r=e.offsetWidth,o=e.offsetHeight;t({width:r,height:o})})})},n.state={render:function(){return null}},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.setCalcSizes(this._calcSizes)},n.render=function(){return i.createElement("div",{ref:this._ref},this.state.render())},t}(i.PureComponent);var zi=function(e){var t=function(){var t,n;return Mi||(t=window.document.createElement("div"),n=Object(Pi.a)(),t.setAttribute("style","position: absolute; top: -1000px; left: -1000px"),window.document.body.appendChild(t),Mi=new Promise(function(e){xi.render(i.createElement(I.a,{value:n},i.createElement(Ni,{setCalcSizes:e})),t)})),Mi.then(function(t){return t(e)})};return Ii=Ii?Ii.then(t):t()},Li=7,Di=-10,Ai=-30,Ui=-12,Fi=-24,qi=8,Bi=10,Hi={};function Wi(e,t){if(!t.offset||!t.size)return{left:0,right:0,bottom:0,top:0};var n=t.offset[0],r=t.offset[0],o=t.offset[1],i=t.offset[1]+t.size.height;return"MASSTRANSIT"===e.pinType&&(n+=e.rotated?-t.size.width:-Li,r+=e.rotated?Li:t.size.width),"CONSTRUCTION"===e.pinType&&(n+=Di,r=r+t.size.width+Di,o+=Ai,i+=Ai),"ROUTEPOINT"===e.pinType&&(n-=t.size.width/2,r+=t.size.width/2,o=o+qi-10,i+=qi),"SPECIAL"===e.pinType&&(n+=Ui,r=r+t.size.width+Ui,o+=Fi,i+=Fi),{left:n,right:r,top:o,bottom:i}}function Gi(e,t,n){return Promise.all(e.map(function(e){return function(e,t,n){var r=Vi(e);return Hi[r]=Hi[r]||zi(function(){return t(e)}),Hi[r].then(function(t){var r=Object(Q.a)(n.bounds[0],n.zoom),o=Object(Q.a)(e.coordinates,n.zoom);return{size:t,offset:[o[0]-r[0],o[1]-r[1]]}})}(e,t,n)})).then(function(t){return e.map(function(n,r){return function(e,t,n){var r=e[n],o=t[n];if(!o.offset||!o.size)return[];var i=Wi(r,o);return i.left===i.right||i.top===i.bottom?[]:e.reduce(function(e,n,o){if(r===n)return e;var a=t[o];if(!a.offset||!a.size)return e;var s=Wi(n,a);return s.left===s.right||s.top===s.bottom?e:Object(Lo.a)([[i.left,i.top],[i.right,i.bottom]],[[s.left,s.top],[s.right,s.bottom]])?e.concat(o):e},[])}(e,t,r)})})}function Yi(e,t,n){return Gi(e,t,n).then(function(e){return e.every(function(e){return 0===e.length})})}function Vi(e){switch(e.pinType){case"CONSTRUCTION":return e.coordinates.join(",")+e.pinType;case"MASSTRANSIT":return(e.balloonItems&&String(e.balloonItems.length)||"0")+(e.text||"")+(e.dotSize||"")+(e.rotated||"")+e.pinType+e.coordinates.join(",")+e.pinIndex;case"ROUTEPOINT":return(String(e.index)||0)+(e.value||"")+e.pinType+(e.isLast&&"last");case"SPECIAL":return e.coordinates.join(",")+e.position+e.pinType}}function Zi(e){switch(e.pinType){case"CONSTRUCTION":case"MASSTRANSIT":return Vi(e);case"ROUTEPOINT":return(String(e.index)||0)+e.pinType+(e.isLast&&"last");case"SPECIAL":return Vi(e)}}var Ki,Xi={ROUTEPOINT:"ROUTEPOINT",MASSTRANSIT:"MASSTRANSIT",CONSTRUCTION:"CONSTRUCTION",SPECIAL:"SPECIAL"},$i=2,Ji=50,Qi=300,ea=.25,ta=function(e){function t(t){var n;return(n=e.call(this,t)||this)._updateMapLocationThrottled=void 0,n._validityChecksCounter=0,n._processingTimeout=0,n._routeComponentProcessingFunction=function(e,t){return 1===e.length?Promise.resolve(e):function(e,t,n){return t.reduce(function(e,t){return e.then(function(e){return e.optimized?e:n(e.pins,t)})},Promise.resolve({pins:e,optimized:!1}))}(e.sort(function(e,t){return e.pinIndex>t.pinIndex?1:-1}),n.props.algoSteps,t).then(function(e){return e.pins})},n._updatePins=function(){n._validityChecksCounter=0,window.clearTimeout(n._processingTimeout),n._validateDrawing(n.props.unprocessedPins.map(function(e,t){return Object(r.a)({pinIndex:t},e)}))},n._collectAndProcessGroups=function(e){var t=n.state.mapLocation;Gi(e,n.props.getNodeByPin,t).then(function(r){var o=function(e){for(var t=new Array(e.length).map(function(){return!1}),n=[],r=0;r<e.length;r++)if(!t[r]){var o=[r],i=[r];for(t[r]=!0;o.length>0;)for(var a=e[o.pop()],s=0;s<a.length;++s){var c=a[s];t[c]||(t[c]=!0,o.push(c),i.push(c))}n.push(i)}return n}(r).map(function(r){var o=r.map(function(t){return e[t]});return n._routeComponentProcessingFunction(o,function(e,r){return function e(t,n,r,o,i){return new Promise(function(a){if(1===t.length)a({pins:t,optimized:!0});else if(i>Bi)a({pins:t,optimized:!1});else{var s=n(t);Yi(s.pins,r,o).then(function(t){t?a({pins:s.pins,optimized:!0}):s.isFinished?s.isFinished&&a({pins:s.pins,optimized:!1}):a(e(s.pins,n,r,o,i++))})}})}(e,r,n.props.getNodeByPin,t,0)})});Promise.all(o).then(function(e){var t=e.reduce(function(e,t){return e.concat(t)});n._validateDrawing(t)})})},n._updateMapLocation=function(){var e=n.props.map.zoom;Math.abs(n.state.mapLocation.zoom-e)<ea||n.setState({mapLocation:Object(a.c)(n.props.map)})},n._onMapUpdate=function(){n._updateMapLocationThrottled()},n._validateDrawing=function(e){n._validityChecksCounter+=1,n._validityChecksCounter>=$i?n.setState({pinsToDraw:e}):Yi(e,n.props.getNodeByPin,n.state.mapLocation).then(function(t){t?n.setState({pinsToDraw:e}):n._processingTimeout=window.setTimeout(function(){return n._collectAndProcessGroups(e)},Ji)})},n.state={pinsToDraw:[],mapLocation:Object(a.c)(n.props.map)},n._updateMapLocationThrottled=Object(Ko.a)(n._updateMapLocation,Qi),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._validityChecksCounter=0,this._validateDrawing(this.props.unprocessedPins.map(function(e,t){return Object(r.a)({pinIndex:t},e)}))},n.componentDidUpdate=function(e,t){this.state.mapLocation.zoom===t.mapLocation.zoom&&this.props.unprocessedPins===e.unprocessedPins||this._updatePins()},n.componentWillUnmount=function(){window.clearTimeout(this._processingTimeout)},n.render=function(){var e=this;return i.createElement(i.Fragment,null,this.state.pinsToDraw.map(function(t){var n=e.props.getMapPlacemarkProps(t);return n?i.createElement(lt.a,Object(Gt.a)({key:Zi(t)},n),e.props.getNodeByPin(t)):null}),i.createElement(Ft.b,{onUpdate:this._onMapUpdate}))},t}(i.Component),na=Object(Ut.b)({shouldWait:!0})(ta),ra=n(331),oa=n.n(ra),ia=n(332),aa=n.n(ia),sa=n(333),ca=n.n(sa),ua=n(334),la=n.n(ua),da=function(e){function t(){return e.apply(this,arguments)||this}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;if(!Ki){var t=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._uris=[],t}Object(o.a)(t,e);var n=t.prototype;return n.test=function(e,t){var n=t&&t.get("uri");return!n||!this._uris.includes(n)},n.add=function(e){this._uris.push(e),this._emit("update")},n.remove=function(e){this._uris=this._uris.filter(function(t){return t!==e}),this._emit("update")},t}(e.ymaps3.eventify().with());Ki=new t,e.map.addObjectFilter(Ki)}Ki.add(this.props.uri)},n.componentDidUpdate=function(e){this.props.uri!==e.uri&&(Ki.remove(e.uri),Ki.add(this.props.uri))},n.componentWillUnmount=function(){Ki.remove(this.props.uri)},n.render=function(){return null},t}(i.Component),pa=Object(Ut.b)({shouldWait:!0})(da),fa=(n(335),n(337)),ma=n.n(fa),va=Object(ut.a)("masstransit-route-pin-view"),ga=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._onClick=function(e){var n=t.props,r=e||n.balloonItems&&n.balloonItems[0].stopId;r&&n.onClick&&n.onClick({coordinates:n.coordinates,id:r})},t._renderBalloonItem=function(e){var n=Boolean("underground"===e.iconType&&e.city),r=n?e.iconType+"-"+e.city:e.iconType,o=n?"small":"normal",a=yt.a({type:"masstransit",name:r,size:o},t.props.config);return i.createElement("div",{className:va("balloon-item",{type:e.iconType}),style:{backgroundColor:"underground"!==e.iconType?e.color:void 0},onClick:function(){return t._onClick(e.stopId)}},a?i.createElement(Ot.a,{className:va("balloon-icon"),url:a}):null,["suburban","aeroexpress"].includes(e.iconType)?null:i.createElement("div",{className:va("balloon-text"),style:{backgroundColor:e.color}},e.text))},t._renderBalloon=function(){var e=t.props.balloonItems;return e?i.createElement("div",{className:va("balloon")},t._renderBalloonItem(e[0]),e[1]?i.createElement(i.Fragment,null,i.createElement(Ot.a,{url:ma.a,className:va("arrow")}),t._renderBalloonItem(e[1])):null):null},t._renderText=function(){return t.props.text?i.createElement("span",{className:va("text"),onClick:function(){return t._onClick()}},t.props.text):null},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.balloonItems&&t.balloonItems[t.balloonItems.length-1].color||t.dotColor,r=t.dotSize||"normal";return i.createElement("div",{className:va({rotated:t.rotated,double:t.balloonItems&&2===t.balloonItems.length,clickable:Boolean(t.onClick)})},i.createElement("div",{className:va("container")},i.createElement("div",{className:va("dot",{size:r}),style:{background:n},onClick:function(){return e._onClick()}}),this._renderBalloon()),this._renderText())},t}(i.PureComponent),ha=Object(I.b)(ga),ba=(n(338),n(452)),ya=n(340),_a=n.n(ya),Ea=n(341),wa=n.n(Ea),Sa=Object(ut.a)("waypoint-pin-view"),Oa=function(e){function t(t){var n;(n=e.call(this,t)||this)._getServiceIconUrl=function(){var e=n.props;return e.serviceType&&"geolocation"!==e.serviceType?yt.a({type:"service",name:e.serviceType,size:e.mobileChooseMode?"normal":"small"},e.config):null},n._getRubricIconUrl=function(){var e=n.props;if(e.searchResult){var t,r;if("categories"in e.searchResult&&e.searchResult.categories)t=null===(r=e.searchResult.categories[0])||void 0===r?void 0:r.class;else"kind"in e.searchResult&&(t=e.searchResult.kind);if(t)return yt.a({type:"rubrics",name:t,size:e.mobileChooseMode?"normal":"small"},e.config)||void 0}},n._renderText=function(){if(!n.props.text)return null;var e=Object(ba.a)(n.props.text,{length:40});return i.createElement("div",{className:Sa("text")},e.split(" ").map(function(e,t){return i.createElement("span",{key:t,className:Sa("word")},e)}))},n._renderWaypoint=function(){var e=n.props,t=n.state;return i.createElement(i.Fragment,null,i.createElement(Ot.a,{url:e.mobileChooseMode?wa.a:_a.a,className:Sa("pin-icon")}),i.createElement(Ot.a,{url:t.currentIconUrl,key:t.currentIconUrl,className:Sa("rubric-icon",{"mobile-choose":e.mobileChooseMode,current:!0,type:e.serviceType})}),t.temporaryIconUrl?i.createElement(Ot.a,{url:t.temporaryIconUrl,key:t.temporaryIconUrl,className:Sa("rubric-icon",{"mobile-choose":e.mobileChooseMode,temporary:!0})}):null,n._renderText())},n._renderIntermediatePoint=function(){var e=n.props;return i.createElement(i.Fragment,null,i.createElement("div",{className:Sa("content")},i.createElement("span",{className:Sa("index")},e.index)),n._renderText())};var r=yt.a({type:"rubrics",name:"fallback",size:t.mobileChooseMode?"normal":"small"},t.config),o=n._getServiceIconUrl()||n._getRubricIconUrl()||r;return n.state={temporaryIconUrl:null,currentIconUrl:o},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props,n=this._getServiceIconUrl()||this._getRubricIconUrl();(t.serviceType||t.searchResult!==e.searchResult)&&n&&n!==this.state.currentIconUrl&&this.setState({temporaryIconUrl:this.state.currentIconUrl,currentIconUrl:n})},n.render=function(){var e=this.props,t=0===e.index,n=!t&&!e.isLast&&!e.mobileChooseMode;return e.serviceType,i.createElement("div",{className:Sa({disabled:e.disabled,first:t,last:e.isLast,intermediate:n,"mobile-choose":e.mobileChooseMode})},n?this._renderIntermediatePoint():this._renderWaypoint())},t}(i.Component),Ca=Object(I.b)(Oa),ka=n(67);function ja(e){return"CONSTRUCTION"===e.pinType&&["STAIRS_UP","STAIRS_DOWN","STAIRS_UNKNOWN"].includes(e.type)}function Ra(e){if(e.filter(function(e){return"CONSTRUCTION"===e.pinType&&["STAIRS_UP","STAIRS_DOWN","STAIRS_UNKNOWN"].includes(e.type)}).length<2)return{pins:e,isFinished:!0};var t=e.findIndex(function(e){return ja(e)}),n=Object(f.a)(e[t],{type:"STAIRS_UNKNOWN"});return{pins:e.filter(function(e){return!ja(e)}).concat(n),isFinished:!0}}function Ta(e){if(e.filter(function(e){return"CONSTRUCTION"===e.pinType}).length<2)return{pins:e,isFinished:!0};var t=e.findIndex(function(e){return"CONSTRUCTION"===e.pinType});return{pins:e.filter(function(e){return"CONSTRUCTION"!==e.pinType}).concat(e[t]),isFinished:!0}}function Ia(e){return{pins:e.filter(function(e){return"CONSTRUCTION"!==e.pinType}),isFinished:!0}}function Ma(e){return{pins:e.filter(function(e){return"MASSTRANSIT"!==e.pinType||"balloonItems"in e&&e.balloonItems||"dotSize"in e}),isFinished:!0}}function xa(e){var t=e.findIndex(function(e){return"MASSTRANSIT"===e.pinType&&e.balloonItems});if(-1!==t){var n=[].concat(e),r=n[t];return n[t]=Object(f.a)(n[t],{balloonItems:void 0,dotColor:r.balloonItems&&r.balloonItems[r.balloonItems.length-1].color,dotSize:"none",rotated:!1,text:void 0}),{pins:n,isFinished:!1}}return{pins:e,isFinished:!0}}function Pa(e){return{pins:e.filter(function(e){var t;return"MASSTRANSIT"!==e.pinType||!e.balloonItems||"metro-exit"!==(null===(t=e.balloonItems[0])||void 0===t?void 0:t.iconType)}),isFinished:!0}}function Na(e){var t=Fa(e);return t?Ua(t,e):{pins:e,isFinished:!0}}function za(e){var t=e.reduce(function(e,t,n){return"MASSTRANSIT"===t.pinType?e.concat(n):e},[]);return Ua(t.length>2?t.slice(0,3):t.slice(0,2),e)}function La(e){var t=Fa(e);return t?function(e,t){var n=e[0],o=e[1],i=t[n],a=t[o];if("MASSTRANSIT"!==i.pinType||"MASSTRANSIT"!==a.pinType)return{pins:t,isFinished:!0};if(!i.balloonItems||!a.balloonItems)return{pins:t,isFinished:!0};var s=i.balloonItems[0].initialText===a.balloonItems[0].initialText&&i.balloonItems[0].color===a.balloonItems[0].color;return t[o]=s?Object(f.a)(a,Object(r.a)(Object(r.a)({},i),{},{pinIndex:a.pinIndex,rotated:!1})):Object(f.a)(a,{rotated:!1,text:"",balloonItems:[i.balloonItems[0],a.balloonItems[0]]}),{pins:t.filter(function(e){return e.pinIndex!==i.pinIndex}),isFinished:!1}}(t,e):{pins:e,isFinished:!0}}function Da(e){var t=e.findIndex(function(e,t,n){var r=n[t+1];return r&&"MASSTRANSIT"===e.pinType&&"MASSTRANSIT"===r.pinType&&e.text===r.text}),n=-1!==t?[e[t],e[t+1]]:[];return 2===n.length&&"MASSTRANSIT"===n[0].pinType&&"MASSTRANSIT"===n[1].pinType?n[0].balloonItems&&1===n[0].balloonItems.length&&n[1].balloonItems&&1===n[1].balloonItems.length&&n[0].balloonItems[0].color!==n[1].balloonItems[0].color?{pins:e,isFinished:!0}:{pins:[].concat(e.filter(function(e){return!n.includes(e)}),[n[1]]),isFinished:!0}:{pins:e,isFinished:!0}}function Aa(e){return{pins:e.map(function(e){return"MASSTRANSIT"!==e.pinType||!e.balloonItems||2===e.balloonItems.length||e.first?e:"MASSTRANSIT"!==e.pinType||1!==e.balloonItems.length||e.first?e:Object(f.a)(e,{balloonItems:void 0,dotColor:e.balloonItems&&e.balloonItems[e.balloonItems.length-1].color,dotSize:"none",rotated:!1,text:void 0})}),isFinished:!0}}function Ua(e,t){var n=e.map(function(e){return t[e].rotated?1:0}),r=Math.pow(2,n.length)-1,o=parseInt(n.join(""),2);return o<r?((o+1).toString(2).padStart(n.length,"0").split("").map(Number).map(Boolean).forEach(function(n,r){t[e[r]]=Object(f.a)(t[e[r]],{rotated:n})}),{pins:t,isFinished:!1}):{pins:t,isFinished:!0}}function Fa(e){for(var t=e.map(function(e,t){return{pin:e,index:t}}).filter(function(e){var t=e.pin;return"MASSTRANSIT"===t.pinType&&t.balloonItems&&1===t.balloonItems.length}),n=[],r=1;r<t.length;r++)if(t[r-1].pin.pinIndex===t[r].pin.pinIndex-1){n.push(t[r-1],t[r]);break}return n.length>0?[n[0].index,n[1].index]:null}function qa(e){var t=e.findIndex(function(e){return"MASSTRANSIT"===e.pinType&&e.balloonItems&&2===e.balloonItems.length});if(-1===t)return{pins:e,isFinished:!0};var n=e[t];if("MASSTRANSIT"!==n.pinType||!n.balloonItems||2!==n.balloonItems.length)return{pins:e,isFinished:!0};var r={pinIndex:n.pinIndex-1,balloonItems:[n.balloonItems[0]],coordinates:n.balloonItems[0].initialCoordinates,last:!0,pinType:Xi.MASSTRANSIT,rotated:!1,text:n.balloonItems[0].initialText},o={pinIndex:n.pinIndex,balloonItems:[n.balloonItems[1]],coordinates:n.balloonItems[1].initialCoordinates,first:!0,pinType:Xi.MASSTRANSIT,rotated:!1,text:n.balloonItems[1].initialText},i=[].concat(e);return i.splice(t,1,r,o),{pins:i,isFinished:!1}}function Ba(e){return{pins:[].concat(e).map(function(e){return Object(f.a)(e,{rotated:!1})}),isFinished:!0}}function Ha(e){if(e.filter(function(e){return"ROUTEPOINT"===e.pinType&&e.value}).length>1){var t=e.findIndex(function(e){return"ROUTEPOINT"===e.pinType&&e.value&&0!==e.index&&!e.isLast}),n=[].concat(e);if(-1!==t)return n[t]=Object(f.a)(n[t],{value:""}),{pins:n,isFinished:!1};var r=e.findIndex(function(e){return"ROUTEPOINT"===e.pinType&&e.value&&0===e.index});if(-1!==r)return n[r]=Object(f.a)(e[r],{value:""}),{pins:n,isFinished:!0}}return{pins:e,isFinished:!0}}function Wa(e){return e.length<2?{pins:e,isFinished:!0}:{pins:e.filter(function(e){return!("SPECIAL"===e.pinType&&"end"===e.position)}),isFinished:!0}}function Ga(e){if(e.length<2)return{pins:e,isFinished:!0};var t=e.filter(function(e){return"SPECIAL"!==e.pinType}),n=e.filter(function(e){return"SPECIAL"===e.pinType&&"TOLL_ROAD"===e.type}),r=e.filter(function(e){return"SPECIAL"===e.pinType&&"FORD_CROSSING"===e.type}),o=e.filter(function(e){return"SPECIAL"===e.pinType&&"RUGGED_ROAD"===e.type});return n.length&&t.push(n[0]),r.length&&t.push(r[0]),o.length&&t.push(o[0]),{pins:t,isFinished:!0}}function Ya(e){return e.length<2?{pins:e,isFinished:!0}:{pins:e.filter(function(e){return!("SPECIAL"===e.pinType&&"RUGGED_ROAD"===e.type)}),isFinished:!0}}function Va(e){return e.length<2?{pins:e,isFinished:!0}:{pins:e.filter(function(e){return"SPECIAL"!==e.pinType}),isFinished:!0}}var Za={FORD_CROSSING:{ru:{begin:"poi-alerts-ford-crossing",end:"poi-alerts-ford-crossing-end"}},RUGGED_ROAD:{ru:{begin:"poi-alerts-road-rugged",end:"poi-alerts-rugged-end"}},TOLL_ROAD:{ru:{begin:"poi-alerts-pay-ru",end:"poi-alerts-pay-end-ru"},tr:{begin:"poi-alerts-pay-tr",end:"poi-alerts-pay-end-tr"},uk:{begin:"poi-alerts-pay-uah",end:"poi-alerts-pay-end-uah"},en:{begin:"poi-alerts-pay-usd",end:"poi-alerts-pay-end-usd"}}},Ka={STAIRS_UP:oa.a,STAIRS_DOWN:aa.a,STAIRS_UNKNOWN:ca.a,GATES:la.a},Xa=Object(ut.a)("route-pins-view"),$a=function(e){function t(t){var n;return(n=e.call(this,t)||this)._updatePins=function(){n.setState({pins:[].concat(n._getRoutePointPins(),n._getMasstransitPins(),n._getConstructionPins(),n._getSpecialRoadPins())})},n._getUpdatedWaypointCoordinates=function(e,t){var r=n.props,o=r.routePoints.filter(function(e,t){return!r.viaIndexes.includes(t)})[t];return r.routePoints.map(function(t){return o===t?e:t.coords})},n._onDragStart=function(){n.props.setDragging(!0)},n._onDragMove=function(e,t){var r=n.props,o=n._getUpdatedWaypointCoordinates(e,t);r.onRoutePointsChange&&r.onRoutePointsChange(o,{viaIndexes:r.viaIndexes,isRough:!0})},n._onDragEnd=function(e,t){var r=n.props;r.setDragging(!1);var o=n._getUpdatedWaypointCoordinates(e,t);r.onRoutePointsChange&&r.onRoutePointsChange(o,{viaIndexes:r.viaIndexes,isRough:!1})},n._getMasstransitPins=function(){var e=n.props;return e.activeRoute&&"paths"in e.activeRoute?e.activeRoute.paths.reduce(function(t,n){return t.concat((r=n.segments,e.config,r.reduce(function(e,t){var n;if(!t.edgePoints||!t.transports)return e;var r,o,i=t.stops&&t.stops[0],a=t.stops&&t.stops[t.stops.length-1];return e.push({balloonItems:[Qa(t.transports,t.edgePoints[0],i)],pinType:Xi.MASSTRANSIT,coordinates:t.edgePoints[0],rotated:!1,first:!0,text:null==i?void 0:i.name},{pinType:Xi.MASSTRANSIT,dotColor:Ja(t.transports),coordinates:t.edgePoints[1]}),(null==a?void 0:null===(n=a.exit)||void 0===n?void 0:n.name)&&e.push({pinType:Xi.MASSTRANSIT,balloonItems:[(r=a.exit,o=a,{iconType:"metro-exit",color:"#666",text:r.name,initialCoordinates:r.coordinates,initialText:r.name,stopId:null==o?void 0:o.id})],coordinates:a.exit.coordinates,rotated:!1,dotSize:"small",text:"Выход"}),e.push({pinType:Xi.MASSTRANSIT,balloonItems:[Qa(t.transports,t.edgePoints[1],a)],coordinates:t.edgePoints[1],rotated:!1,last:!0,text:null==a?void 0:a.name}),e},[])));var r},[]):[]},n._getMapPlacemarkProps=function(e){var t;switch(e.pinType){case"CONSTRUCTION":return{coordinates:e.coordinates,zIndex:pt.a.routes};case"MASSTRANSIT":return{coordinates:e.coordinates,zIndex:pt.a.routePins.masstransit,blockEvents:!0};case"ROUTEPOINT":var r=n.props,o=e;return o.coords?{zIndex:0===o.index?pt.a.routePins.waypoint+1:o.isLast?pt.a.routePins.waypoint+2:pt.a.routePins.waypoint,coordinates:o.coords,draggable:r.draggable&&!o.disabled&&(!r.draggableIndexes||(null===(t=r.draggableIndexes)||void 0===t?void 0:t.includes(o.index))),onDragStart:n._onDragStart,onDragEnd:function(e){var t=e.coordinates;return n._onDragEnd(t,o.index)},onDragMove:function(e){var t=e.coordinates;return n._onDragMove(t,o.index)}}:null;case"SPECIAL":return{zIndex:pt.a.routes,coordinates:e.coordinates}}return null},n._getConstructionPins=function(){var e=n.props;return e.activeRoute&&"constructions"in e.activeRoute?e.activeRoute.constructions.map(function(e){return Object(r.a)(Object(r.a)({},e),{},{pinType:Xi.CONSTRUCTION})}):[]},n._getSpecialRoadPins=function(){var e=n.props;return e.activeRoute&&"specialRoadPoints"in e.activeRoute&&e.activeRoute.specialRoadPoints?e.activeRoute.specialRoadPoints.map(function(e){return Object(r.a)(Object(r.a)({},e),{},{pinType:Xi.SPECIAL})}):[]},n._getRoutePointPins=function(){var e=n.props,t="taxi"===e.travelMode,o=s.p(e.travelMode,e.config),i=e.routePoints.every(function(e){return!e.coords||Boolean(e.input)})&&!e.isRoutePointDragging;return e.routePoints.filter(function(t,n){return!e.viaIndexes.includes(n)}).map(function(e,n,a){var s=t&&0!==n&&n!==a.length-1||n>=o-1&&n!==a.length-1;return Object(r.a)(Object(r.a)({},e),{},{pinType:Xi.ROUTEPOINT,coordinates:e.coords||[0,0],disabled:s,showText:i,index:n,isLast:n===a.length-1})})},n._getConstructionNode=function(e){return i.createElement("div",{className:Xa("construction",{type:e.type})},i.createElement(Ot.a,{url:Ka[e.type]}))},n._getSpecialRoadPinNode=function(e){var t=n.props.config,r=Za[e.type],o=r[t.lang],a=Object(yt.c)(t)?r.ru:r.en,s=r.ru;return i.createElement("div",{className:Xa("special-road",{type:e.type,position:e.position})},i.createElement(bt.a,{name:(o||a||s)[e.position],size:24}))},n._getMasstransitPinNode=function(e){var t=n.props,r=!t.activeRoute||"isIntercityRoute"in t.activeRoute&&t.activeRoute.isIntercityRoute?void 0:t.onStopClick;return i.createElement(ha,Object(Gt.a)({},e,{onClick:r}))},n._getWaypointPinNode=function(e){return i.createElement(Ca,{text:e.showText?e.value:void 0,index:e.index,isLast:e.isLast,disabled:e.disabled,searchResult:e.searchResult,serviceType:e.serviceType})},n._getRouteItemPinNode=function(e){switch(e.pinType){case"CONSTRUCTION":return n._getConstructionNode(e);case"MASSTRANSIT":return n._getMasstransitPinNode(e);case"ROUTEPOINT":return n._getWaypointPinNode(e);case"SPECIAL":return n._getSpecialRoadPinNode(e)}return null},n._getAlgoSteps=function(){var e=[Ra,Ta,Ia],t=n.props.activeRoute&&"masstransit"===n.props.activeRoute.type?[Ma,Da,Na,Pa,Ba,Na,La,Aa,qa,Aa,Ba,za,Ba,xa]:[];return[].concat(e,t,[Ha],[Wa,Ga,Ya,Va])},n.state={pins:[]},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.activeRoute===e.activeRoute&&this.props.routePoints===e.routePoints||this._updatePins()},n.componentDidMount=function(){this._updatePins()},n.render=function(){return i.createElement(i.Fragment,null,i.createElement(na,{unprocessedPins:this.state.pins,getNodeByPin:this._getRouteItemPinNode,getMapPlacemarkProps:this._getMapPlacemarkProps,algoSteps:this._getAlgoSteps()}),this.state.pins.filter(function(e){return e.pinType===Xi.ROUTEPOINT}).map(function(e){var t,n=e.uri||(null===(t=e.searchResult)||void 0===t?void 0:t.uri);return n?i.createElement(pa,{key:n,uri:n}):null}))},t}(i.Component);function Ja(e){var t=s.n(e);return ka.e(t)}function Qa(e,t,n){var r=s.n(e);return{iconType:r.type,color:Ja(e),city:r.city,text:"underground"===r.type&&r.undergroundLineNumber?r.undergroundLineNumber:r.name,initialCoordinates:t,initialText:null==n?void 0:n.name,stopId:null==n?void 0:n.id}}var es=Object(I.b)($a),ts=n(196),ns=n(227),rs=Object(kn.a)(ns.b,Object(Ut.b)({shouldWait:!0}))(function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=void 0,n._id=x.a.v4(),t.map.addGroup(n._dataSourceId,n._id,t.style,t.parentGroupId),n}Object(o.a)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){this.props.map.removeGroupAndChildren(this._dataSourceId,this._id)},n.render=function(){return i.createElement(ns.a,{value:{parentGroupId:this._id}},this.props.children)},Object(Nt.a)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||At.d.DEFAULT_GRAPHICS}}]),t}(i.PureComponent)),os={main:4,underlay:8,dash:[5,10]},is="#6000ff",as="#b3b3b3",ss=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getStrokeStyleByType=function(e){return{simplifyPalette:!1,width:os.main,dash:os.dash,opacity:"undergroundWalk"===e?.5:1,palette:t.props.activeRoute.colorizeInfo.map(function(t){var n=t.type,r=t.count;return{color:n===e?"binding"===n?as:is:ts.a,count:r}})}},t._getActiveStyle=function(){return[t._getStrokeStyleByType("undergroundWalk"),t._getStrokeStyleByType("walk"),t._getStrokeStyleByType("binding"),{width:os.underlay,color:"#fff"}]},t._getInactiveStyle=function(){return[{width:os.main,color:"#6d6d6d"},{width:os.underlay,color:"#fff"}]},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props;return i.createElement(rs,{style:{opacity:.6}},i.createElement(gt.a,{key:t.activeRoute.uuid,drawingStyle:{stroke:this._getActiveStyle(),cursor:"default",zIndex:10},geometry:s.o(t.activeRoute),onFastClick:function(e,n){return t.onRouteClick(t.activeRoute,n.coordinates)}}),t.inactiveRoutes?t.inactiveRoutes.map(function(n){return i.createElement(gt.a,{key:n.uuid,drawingStyle:{stroke:e._getInactiveStyle(),cursor:"pointer"},geometry:s.o(n),onFastClick:function(e,r){return t.onRouteClick(n,r.coordinates)}})}):null)},t}(i.Component),cs=n(342),us=n.n(cs),ls=n(343),ds=n.n(ls),ps=n(344),fs=n.n(ps),ms=n(345),vs=n.n(ms),gs=n(346),hs=n.n(gs),bs=n(347),ys=n.n(bs),_s=n(348),Es=n.n(_s),ws=n(349),Ss=n.n(ws),Os=n(350),Cs=n.n(Os),ks=n(351),js=n.n(ks),Rs=n(352),Ts=n.n(Rs),Is=n(353),Ms=n.n(Is),xs=n(354),Ps=n.n(xs),Ns=n(355),zs=n.n(Ns),Ls=n(356),Ds=n.n(Ls),As=n(357),Us=n.n(As),Fs=n(358),qs=n.n(Fs),Bs=n(359),Hs=n.n(Bs),Ws=n(360),Gs=n.n(Ws),Ys=n(361),Vs=n.n(Ys),Zs={start:[us.a],middle:["",ds.a,fs.a,vs.a,hs.a,ys.a,Es.a,Ss.a,Cs.a,js.a].concat(new Array(40).fill(Vs.a)),finish:["",Ts.a,Ms.a,Ps.a,zs.a,Ds.a,Us.a,qs.a,Hs.a,Gs.a].concat(new Array(40).fill(Gs.a))};var Ks=Object(I.b)(function(e){return e.cursor?i.createElement(Vt,{src:(t=e.cursor,n=t.split("_"),r=n[0],o=n[1],Zs[r][Number(o)]),basePoint:[32,44]}):null;var t,n,r,o}),Xs="#737ce6",$s="#54b235",Js={stroke:[{width:4,color:"#6d6d6d"},{width:8,color:"#fff"}],cursor:"pointer"},Qs=17,ec=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getBicycleActiveDrawingStyle=function(){var e=t.props.mapLocation.zoom>=Qs,n={width:s.q(t.props.mapLocation.zoom).main,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map(function(t){return{count:t.count,color:["PEDESTRIAN","PEDESTRIAN_UNDERGROUND"].includes(t.type)&&e?ts.a:"AUTO"===t.type?Xs:$s}})},r={width:e?4:0,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map(function(e){return{count:e.count,color:"PEDESTRIAN"===e.type?Xs:ts.a}}),dash:[5,10]},o={width:e?4:0,opacity:.5,palette:(t.props.activeRoute.colorizeInfo||[]).map(function(e){return{count:e.count,color:"PEDESTRIAN_UNDERGROUND"===e.type?Xs:ts.a}}),dash:[5,10]};return{stroke:[{width:1.5,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map(function(e){return{count:e.count,color:"BICYCLE"===e.type?"#fff":ts.a}}),dash:[2,4]},n,r,o,{width:s.q(t.props.mapLocation.zoom).underlay,color:"#fff"}],cursor:"default",zIndex:10}},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(rs,{style:{opacity:1}},i.createElement(gt.a,{drawingStyle:this._getBicycleActiveDrawingStyle(),geometry:s.o(e.activeRoute),onFastClick:function(t,n){return e.onRouteClick(e.activeRoute,n.coordinates)}}),e.inactiveRoutes?i.createElement(rs,{style:{opacity:.6}},e.inactiveRoutes.map(function(t){return i.createElement(gt.a,{key:t.uuid,drawingStyle:Js,geometry:s.o(t),onFastClick:function(n,r){return e.onRouteClick(t,r.coordinates)}})})):null)},t}(i.Component),tc=(n(362),n(68));var nc=function(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(void 0===s?a==a&&!Object(tc.a)(a):n(a,s)))var s=a,c=i}return c},rc=n(237),oc=n(199),ic=1,ac=2;var sc=function(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var c=(s=n[o])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var d=new rc.a;if(r)var p=r(u,l,c,e,t,d);if(!(void 0===p?Object(oc.a)(l,u,ic|ac,r,d):p))return!1}}return!0},cc=n(44);var uc=function(e){return e==e&&!Object(cc.a)(e)},lc=n(236);var dc=function(e){for(var t=Object(lc.a)(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,uc(o)]}return t};var pc=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var fc=function(e){var t=dc(e);return 1==t.length&&t[0][2]?pc(t[0][0],t[0][1]):function(n){return n===e||sc(n,e,t)}},mc=n(40),vc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gc=/^\w*$/;var hc=function(e,t){if(Object(mc.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Object(tc.a)(e))||(gc.test(e)||!vc.test(e)||null!=t&&e in Object(t))},bc=500;var yc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_c=/\\(\\)?/g,Ec=function(e){var t=xo(e,function(e){return n.size===bc&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(yc,function(e,n,r,o){t.push(r?o.replace(_c,"$1"):n||e)}),t}),wc=n(46);var Sc=function(e,t){return Object(mc.a)(e)?e:hc(e,t)?[e]:Ec(Object(wc.a)(e))},Oc=1/0;var Cc=function(e){if("string"==typeof e||Object(tc.a)(e))return e;var t=e+"";return"0"==t&&1/e==-Oc?"-0":t};var kc=function(e,t){for(var n=0,r=(t=Sc(t,e)).length;null!=e&&n<r;)e=e[Cc(t[n++])];return n&&n==r?e:void 0};var jc=function(e,t,n){var r=null==e?void 0:kc(e,t);return void 0===r?n:r};var Rc=function(e,t){return null!=e&&t in Object(e)},Tc=n(204),Ic=n(221),Mc=n(133);var xc=function(e,t,n){for(var r=-1,o=(t=Sc(t,e)).length,i=!1;++r<o;){var a=Cc(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&Object(Mc.a)(o)&&Object(Ic.a)(a,o)&&(Object(mc.a)(e)||Object(Tc.a)(e))};var Pc=function(e,t){return null!=e&&xc(e,t,Rc)},Nc=1,zc=2;var Lc=function(e,t){return hc(e)&&uc(t)?pc(Cc(e),t):function(n){var r=jc(n,e);return void 0===r&&r===t?Pc(n,e):Object(oc.a)(t,r,Nc|zc)}};var Dc=function(e){return e},Ac=n(110);var Uc=function(e){return function(t){return kc(t,e)}};var Fc=function(e){return hc(e)?Object(Ac.a)(Cc(e)):Uc(e)};var qc=function(e){return"function"==typeof e?e:null==e?Dc:"object"==typeof e?Object(mc.a)(e)?Lc(e[0],e[1]):fc(e):Fc(e)};var Bc=function(e,t){return e<t};var Hc=function(e,t){return e&&e.length?nc(e,qc(t,2),Bc):void 0},Wc=(n(364),n(62)),Gc=Object(ut.a)("mrc-map-icon-view"),Yc=Object(Wc.a)(function(e){return i.createElement(lt.a,{disableRoundCoordinates:!0,coordinates:e.coordinates,nonInteractive:!e.onClick,zIndex:e.zIndex,onClick:e.onClick},i.createElement("div",{className:Gc({type:e.type||"main"}),style:{transform:"rotate("+(e.direction?e.direction:0)+"deg)"},ref:e.forwardedRef?e.forwardedRef:null}))}),Vc=(n(366),Object(ut.a)("mrc-preview-balloon")),Zc={main:20,side:20},Kc=function(e){function t(t){var n;return(n=e.call(this,t)||this)._image=i.createRef(),n._onLoad=function(){n.setState({isPreviewLoaded:!0})},n._renderSpinner=function(){var e;return n.state.isPreviewLoaded||(null===(e=n._image.current)||void 0===e?void 0:e.complete)?null:i.createElement("div",{className:Vc("placeholder")},i.createElement("div",{className:Vc("spinner")},i.createElement($n,{view:"large"})))},n.state={isPreviewLoaded:!1},n}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(dt.a,{name:"preview_balloon"},i.createElement("div",{className:Vc()},i.createElement(eo,{type:"transparent",coordinates:e.coordinates,position:"bottom-right",offset:Zc,onClose:function(){},showArrow:!1,isShown:!0},i.createElement("div",{className:Vc("balloon")},this._renderSpinner(),i.createElement("img",{ref:this._image,className:Vc("image",{loaded:this.state.isPreviewLoaded}),src:e.image.url,onLoad:this._onLoad})))))},t}(i.Component),Xc=200,$c=16,Jc=function(e){function t(t){var n;return(n=e.call(this,t)||this)._leaveTimer=0,n._getNearestFeature=function(e){var t=n.props,r=Hc(t.features,function(t){return P(t.geometry.coordinates,e)});if(!r||r.properties.id!==t.selectedFeatureId)return r},n._onClick=function(){var e=n.state.currentFeature;e&&n.props.onClick&&n.props.onClick(e.properties.id),n.setState({currentFeature:null})},n._onMouseMove=function(e,t){var r=t.coordinates,o=po(n.props.features.map(function(e){return e.geometry.coordinates}),r,n.props.lineWidth,n.props.zoom);if(o&&!("point"in o)){var i=n._getNearestFeature(o);n.setState({currentFeature:i||null})}},n._onMouseEnter=function(){window.clearTimeout(n._leaveTimer)},n._onMouseLeave=function(){n._leaveTimer=window.setTimeout(function(){n.setState({currentFeature:null})},Xc)},n._renderPreview=function(){var e=n.state;return e.currentFeature?"placemark"===n.props.preview?i.createElement(Yc,{coordinates:e.currentFeature.geometry.coordinates,direction:e.currentFeature.properties.heading,type:"additional"}):i.createElement(Kc,{coordinates:e.currentFeature.geometry.coordinates,image:e.currentFeature.properties.imagePreview}):null},n.state={currentFeature:null},n._onMouseMove=Object(Ko.a)(n._onMouseMove,$c),n}Object(o.a)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){window.clearTimeout(this._leaveTimer)},n.render=function(){var e=this.props;return i.createElement(i.Fragment,null,e.children({onMouseMove:this._onMouseMove,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,onClick:this._onClick}),this._renderPreview())},t}(i.Component),Qc=n(72),eu=Object(ut.a)("map-routes-auto-view"),tu=12,nu=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getPoints=function(){var e=n.props;return e.activeRoute.refPointsLineCoordinates.map(function(t,r){return n.state.editingIndex===r?e.routePoints[r].coords:t})},n._getPointsWithVia=function(){return{points:n.props.routePoints.map(function(e){return e.coords}),isViaPoints:n.props.routePoints.map(function(e,t){return n.props.viaIndexes.includes(t)})}},n._getViaIndexesFromRefsWithVia=function(e){return e.map(function(e,t){return e?t:0}).filter(Boolean)},n._removeViaPoint=function(e){if(n.props.onRoutePointsChange){var t=n._getPointsWithVia(),r=t.points,o=t.isViaPoints;r.splice(e,1),o.splice(e,1),n.props.onRoutePointsChange(r,{viaIndexes:n._getViaIndexesFromRefsWithVia(o),isRough:!1})}},n._addViaPoint=function(e,t){if(n.props.onRoutePointsChange){var r=n._getPointsWithVia(),o=r.points,i=r.isViaPoints;o.splice(t,0,e),i.splice(t,0,!0),n.props.setDragging(!0),n.props.onRoutePointsChange(o,{viaIndexes:n._getViaIndexesFromRefsWithVia(i),isRough:!1})}},n._updateViaPoint=function(e,t,r){if(n.props.onRoutePointsChange){var o=n.props.routePoints.slice().map(function(e){return e.coords});o.splice(t,1,e),n.setState({editingIndex:r?t:void 0}),n.props.onRoutePointsChange(o,{viaIndexes:n.props.viaIndexes,isRough:r})}},n._getActiveRouteStrokeStyles=function(){var e=n.props;return s.e({route:e.activeRoute,isDefaultColor:e.isDefaultColor},e.config)},n._onPointUpdate=function(e,t,r){n._updateViaPoint(e,t,!r),n.props.setDragging(!r)},n._onMapUpdate=function(){n.setState({mapAzimuth:n.props.map.azimuth})},n._renderPointElement=function(e){return n.props.activeRoute.refPointsLineCoordinates.reduce(function(e,t,r){return n.props.viaIndexes.includes(r)?e:e.concat(r)},[]).includes(e)?null:i.createElement("div",{className:eu("via-point")})},n._renderActiveRoute=function(e){var t=n.props,r=n._getActiveRouteStrokeStyles().underlayStyle.width,o=e?{onLineMouseEnter:e.onMouseEnter,onLineMouseMove:e.onMouseMove,onLineMouseLeave:e.onMouseLeave,onPreviewPointMouseLeave:e.onMouseLeave}:{};return i.createElement(yo,Object(Gt.a)({lineStyle:{stroke:[{width:r,opacity:0}],zIndex:tu},polyLineCoordinates:t.activeRoute.coordinates||[],points:n._getPoints(),renderPointElement:n._renderPointElement,previewPointElement:i.createElement("div",{className:eu("via-point",{preview:!0})}),isActive:t.isEditorActive,onPointAdd:n._addViaPoint,onPointUpdate:n._onPointUpdate,onPointRemove:n._removeViaPoint,onPreviewPointClick:function(r,o){o&&n.props.onRouteClick(t.activeRoute,o.coordinates),null==e||e.onClick()}},o))},n._renderActiveMrcFeature=function(){var e=n.props;if(e.isMrcPlayerHidden||e.isLoading||"comparison"===e.travelMode||e.feedback&&"route/edit/better"===e.feedback.type||!e.mrcFeatures||!e.activeMrcIndex&&0!==e.activeMrcIndex||e.isRoutePointDragging||!e.isMrcPlaying&&0===e.activeMrcIndex)return null;var t=e.mrcFeatures[e.activeMrcIndex];return t?i.createElement(i.Fragment,null,i.createElement(Yc,{coordinates:t.geometry.coordinates,direction:t.properties.heading+Object(Qc.a)(n.state.mapAzimuth)}),i.createElement(Ft.b,{onUpdate:n._onMapUpdate})):null},n.state={mapAzimuth:t.map.azimuth},n}return Object(o.a)(t,e),t.prototype.render=function(){var e,t=this,n=this.props,r=this._getActiveRouteStrokeStyles().underlayStyle.width,o=!("route/edit/better"===(null===(e=n.feedback)||void 0===e?void 0:e.type))&&!n.config.uatraits.isMobile&&"comparison"!==n.travelMode;return i.createElement(i.Fragment,null,o?i.createElement(dt.a,{name:"mrc_route_thread",logClick:!0},i.createElement(Jc,{features:n.mrcFeatures||[],lineWidth:r,zoom:n.zoom,onClick:n.onMrcClick,preview:"balloon"},this._renderActiveRoute)):this._renderActiveRoute(),i.createElement(rs,{style:{opacity:.7}},i.createElement(gt.a,{drawingStyle:s.f({route:n.activeRoute,isActive:!0,isDefaultColor:n.isDefaultColor},n.config),geometry:s.o(n.activeRoute)}),n.inactiveRoutes?i.createElement(rs,{style:{opacity:.86}},n.inactiveRoutes.map(function(e){return i.createElement(gt.a,{key:e.uuid,drawingStyle:s.f({route:e,isActive:!1,isDefaultColor:n.isDefaultColor},n.config),geometry:s.o(e),onFastClick:function(n,r){return t.props.onRouteClick(e,r.coordinates)}})})):null),n.config.uatraits.isMobile?null:this._renderActiveMrcFeature())},t}(i.Component),ru=Object(Ut.b)({shouldWait:!0})(Object(I.b)(nu)),ou=(n(368),[{width:4,color:"#6d6d6d"},{width:8,color:"#fff"}]),iu={main:4,dash:[5,10]},au="#9d64fb",su="#b3b3b3",cu=14,uu=Object(ut.a)("map-routes-masstransit-view"),lu=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getStopPlacemarksData=function(){return t.props.activeRoute.paths.reduce(function(e,t){return e.concat(t.segments.reduce(function(e,t){if(!t.stops)return e;var n=t.stops.reduce(function(e,t){return t.coordinateOnRoute?e.concat([t.coordinateOnRoute]):e},[]);return n.shift(),e.concat({color:t.transports?du(t.transports):void 0,coordinates:n})},[]))},[])},t._getColorForTransport=function(e){var n=t.props,r=e.type,o=e.segmentIndex;if(["walk","transfer","undergroundWalk","binding"].includes(r))return ts.a;var i=n.activeRoute.paths.reduce(function(e,t){return e.concat(t.segments)},[]);return o&&i[o]&&i[o].transports?du(i[o].transports):ka.c(r)},t._getActiveDrawingStyle=function(){var e=t.props;return{cursor:"default",zIndex:10,stroke:[{simplifyPalette:!1,width:s.q(e.mapLocation.zoom).main,palette:e.activeRoute.colorizeInfo.map(function(e){return{color:t._getColorForTransport(e),count:e.count}})},{simplifyPalette:!1,width:iu.main,dash:iu.dash,opacity:.5,palette:e.activeRoute.colorizeInfo.map(function(e){var t=e.type,n=e.count;return{color:["undergroundWalk","transfer"].includes(t)?au:ts.a,count:n}})},{simplifyPalette:!1,width:iu.main,dash:iu.dash,palette:e.activeRoute.colorizeInfo.map(function(e){var t=e.type,n=e.count;return{color:"walk"===t?au:ts.a,count:n}})},{simplifyPalette:!1,width:iu.main,dash:iu.dash,palette:e.activeRoute.colorizeInfo.map(function(e){var t=e.type,n=e.count;return{color:"binding"===t?su:ts.a,count:n}})},{width:s.q(e.mapLocation.zoom).underlay,opacity:.9,color:"#fff"}]}},t._renderStopDots=function(){return t.props.mapLocation.zoom<cu?null:t._getStopPlacemarksData().map(function(e,t){return e.coordinates.map(function(n,r){return i.createElement(lt.a,{key:t+"_"+r,coordinates:n,zIndex:pt.a.default},i.createElement("div",{className:uu("stop-dot"),style:{borderColor:e.color}}))})})},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props;return i.createElement(i.Fragment,null,i.createElement(rs,{style:{opacity:1}},i.createElement(gt.a,{drawingStyle:this._getActiveDrawingStyle(),geometry:s.o(t.activeRoute),onFastClick:function(e,n){return t.onRouteClick(t.activeRoute,n.coordinates)}}),t.inactiveRoutes?i.createElement(rs,{style:{opacity:.6}},t.inactiveRoutes.map(function(t){return i.createElement(gt.a,{key:t.uuid,drawingStyle:{cursor:"pointer",stroke:ou},geometry:s.o(t),onFastClick:function(n,r){return e.props.onRouteClick(t,r.coordinates)}})})):null),this._renderStopDots())},t}(i.Component);function du(e){var t=s.n(e);return ka.e(t)}var pu=Object(I.b)(lu),fu=(n(370),n(372),Object(ut.a)("route-warning-view")),mu=function(e){var t=e.type;return i.createElement("div",{className:fu({type:t})})},vu={pedestrian:"pedestrian",bicycle:"bikes",auto:"car",masstransit:"bus"},gu=Object(ut.a)("map-widget-routes-content-view"),hu=function(e){function t(){return e.apply(this,arguments)||this}Object(o.a)(t,e);var n=t.prototype;return n._renderContent=function(){switch(this.props.route.type){case"bicycle":case"pedestrian":case"masstransit":var e=s.k(this.props.route.duration,this.props.config);return this._renderContentCommon(e,this.props.route.distance.text);case"auto":return this._renderContentAuto();default:return null}},n._renderRouteWarning=function(e){return"auto"===e.type?e.flags.blocked?i.createElement(mu,{type:"blocked"}):e.flags.hasTolls?i.createElement(mu,{type:"tolls"}):null:null},n._renderContentCommon=function(e,t){return i.createElement(i.Fragment,null,i.createElement("div",{className:gu("header")},i.createElement(bt.a,{name:vu[this.props.route.type],size:24,inline:!0,className:gu("icon")}),e,i.createElement("div",{className:gu("warning")},this._renderRouteWarning(this.props.route))),i.createElement("div",{className:gu("body")},t))},n._renderContentAuto=function(){var e=this.props;if("auto"!==e.route.type)return null;var t=(function(params){return params.distance+", без пробок: "+params.duration;})({duration:s.k(e.route.duration,e.config),distance:e.route.distance.text}),n=s.k(e.route.durationInTraffic,e.config),r=e.route.flags.blocked?"Проезд закрыт":n;return this._renderContentCommon(r,t)},n.render=function(){return i.createElement("div",{className:gu()},this._renderContent(),i.createElement(Kn.a,{view:"secondary-blue",size:"small",url:this.props.url,target:"_blank",isStretched:!0},"Подробнее"))},t}(i.Component),bu=Object(I.b)(hu),yu=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._checkAndChangeBounds=function(){var e,n,r;if(!(t.props.routerResponse&&0===t.props.routerResponse.routes.length||"routes"!==(null===(e=t.props.config.mapWidget)||void 0===e?void 0:e.activeMode))){var o=(null===(n=t.props.routerResponse)||void 0===n?void 0:n.routes[t.props.activeRouteIndex])||(null===(r=t.props.routerResponse)||void 0===r?void 0:r.routes[0]),i=null==o?void 0:o.bounds,a=t.props.routePoints.filter(function(e){return Boolean(e.coords)});if(0!==a.length){var s=a?Ti(a.map(function(e){return e.coords})):void 0,c=i||s;c&&t.props.onBoundsChange(c)}}},t._onRoutePointsChange=function(e){var n=t.props.routePoints.findIndex(function(t){return!!t.coords&&!e.includes(t.coords)});t.props.updateRoutePoint({coords:e[n],value:""},n)},t._onMapClick=function(e,n){var r={coords:n.coordinates,value:"",input:""};t.props.updateRoutePoint(r,t.props.emptyPointIndex)},t._renderContent=function(){var e,n;if(!t.props.content||!t.props.routerResponse||t.props.isRoutePointDragging)return null;var o=t.props.routerResponse.routes[t.props.activeRouteIndex]||t.props.routerResponse.routes[0];if(!o)return null;var a=t.props.content.data.coordinates||(null===(e=o.coordinates)||void 0===e?void 0:e[Math.floor((null===(n=o.coordinates)||void 0===n?void 0:n.length)/2)]);if(!a)return null;var l=s.r({routePoints:t.props.routePoints,viaIndexes:t.props.routerResponse.viaIndexes||[],travelMode:t.props.routerResponse.type,activeRouteIndex:t.props.activeRouteIndex,routerResponse:null,detailedIndex:-1,settings:{auto:{ignoreTrafficJams:wi(t.props.config),avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}}},t.props.config),d={l:t.props.isTrafficLayerEnabled?t.props.config.query.l||"trf":void 0},p=Object(u.a)(c.a(c.k("",Object(r.a)(Object(r.a)(Object(r.a)({},l),d),{routes:{avoidTypes:void 0}})),t.props.config));return i.createElement(gi,{coordinates:a,displayType:"balloon",mapLocation:t.props.mapLocation,onClose:t.props.resetContentData,offset:{main:3,side:3},mapSize:t.props.mapSize,key:o.uuid},i.createElement(bu,{route:o,url:p}))},t._renderRouteView=function(){if(!t.props.routerResponse||0===t.props.routerResponse.routes.length)return null;var e=t.props.routerResponse.routes[t.props.activeRouteIndex]||t.props.routerResponse.routes[0],n=t.props.routerResponse.routes.filter(function(t){return t.uuid!==e.uuid});switch(e.type){case"pedestrian":return i.createElement(ss,{activeRoute:e,inactiveRoutes:n,onRouteClick:t.props.onRouteClick});case"bicycle":return i.createElement(ec,{activeRoute:e,inactiveRoutes:n,mapLocation:t.props.mapLocation,onRouteClick:t.props.onRouteClick});case"auto":return i.createElement(ru,{activeRoute:e,inactiveRoutes:n,viaIndexes:t.props.routerResponse.viaIndexes||[],routePoints:t.props.routePoints,zoom:t.props.mapLocation.zoom,feedback:null,isDefaultColor:Boolean(t.props.isTrafficLayerEnabled)||(e.colorizeInfo||[]).every(function(e){return"UNKNOWN"===e.type}),isLoading:!1,isEditorActive:!1,setDragging:_u,onRouteClick:t.props.onRouteClick});case"masstransit":return i.createElement(pu,{activeRoute:e,inactiveRoutes:n,onRouteClick:t.props.onRouteClick,mapLocation:t.props.mapLocation});default:return null}},t._renderRoutePinsView=function(){var e,n,r,o=(null===(e=t.props.routerResponse)||void 0===e?void 0:e.routes[t.props.activeRouteIndex])||(null===(n=t.props.routerResponse)||void 0===n?void 0:n.routes[0])||null;return i.createElement(es,{activeRoute:o,travelMode:null==o?void 0:o.type,routePoints:t.props.routePoints,viaIndexes:(null===(r=t.props.routerResponse)||void 0===r?void 0:r.viaIndexes)||[],draggable:!0,isRoutePointDragging:t.props.isRoutePointDragging,draggableIndexes:t.props.draggablePointIndexes,setDragging:t.props.setDragging,onRoutePointsChange:t._onRoutePointsChange})},t._renderRouteCursor=function(){return t.props.cursor?i.createElement(Ks,{cursor:t.props.cursor}):null},t._renderMapListener=function(){return-1===t.props.emptyPointIndex?null:i.createElement(Ft.b,{onClick:t._onMapClick})},t}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._checkAndChangeBounds()},n.componentDidUpdate=function(e){!e.routerResponse&&this.props.routerResponse&&this._checkAndChangeBounds()},n.render=function(){return i.createElement(i.Fragment,null,this._renderRouteView(),this._renderRoutePinsView(),this._renderRouteCursor(),this._renderMapListener(),this._renderContent())},t}(i.Component);function _u(){}var Eu=Object(I.b)(yu),wu=(n(374),n(57)),Su=Object(ut.a)("user-maps-map-view"),Ou=function(e){function t(t){var n;return(n=e.call(this,t)||this)._renderFeature=function(e,t,r){var o=(e.zIndex||r.length-t)+(t===n.state.hoveredIndex?r.length:0),a=!1;if("placemark"===e.type){var s;if(e.content)if("text"===e.content.type)s=i.createElement("div",{className:Su("text")},e.content.text);else{var c=yt.b(e.content.name),u="fallback"===e.content.name;c&&(a=!u,s=i.createElement(Ot.a,{className:Su("icon",{fallback:u}),url:c}))}return i.createElement(It,{key:t,coordinates:e.coordinates,zIndex:o,color:e.stroke&&e.stroke.color,onClick:function(){return n.props.onFeatureClick(t,e.coordinates)},onMouseEnter:function(){return n.setState({hoveredIndex:t})},onMouseLeave:function(){return n.setState({hoveredIndex:-1})},comma:e.isComma,caption:e.caption,size:a?"large":"medium",outline:!0},s)}return i.createElement(gt.a,{key:t,geometry:n._moveGeometryToZeroWorld(e.geometry),drawingStyle:{zIndex:o,cursor:n.props.cursor||"pointer",stroke:e.stroke?[e.stroke]:void 0,fill:"polygon"===e.type&&e.fill?e.fill.color:void 0,fillOpacity:"polygon"===e.type&&e.fill?e.fill.opacity:void 0,interactive:Boolean(e.balloonCoordinates)},onClick:function(e,r){return n.props.onFeatureClick(t,r.coordinates)}})},n.state={hoveredIndex:-1},n}Object(o.a)(t,e);var n=t.prototype;return n._moveGeometryToZeroWorld=function(e){var t=1/0,n=-1/0;Object(wu.d)(e,function(e){t=e[0]<t?e[0]:t,n=e[0]>n?e[0]:n});var r=360*-Math.trunc((n+t)/360);return r?Object(wu.d)(e,function(e){return[e[0]+r,e[1]]}):e},n.render=function(){return this.props.features.map(this._renderFeature)},t}(i.PureComponent),Cu=Object(I.b)(Ou),ku=(n(376),n(378),Object(ut.a)("user-maps-balloon-content")),ju=function(e){return i.createElement(i.Fragment,null,"placemark"===e.feature.type&&e.feature.caption&&e.showTitle?i.createElement("div",{className:ku("title"),dangerouslySetInnerHTML:{__html:e.feature.caption}}):null,i.createElement("span",{dangerouslySetInnerHTML:{__html:e.feature.isTextInTitle?e.feature.title:e.feature.subtitle}}))},Ru=Object(ut.a)("map-widget-user-maps-content-view"),Tu=function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){return this.props.feature.balloonCoordinates?i.createElement("div",{className:Ru()},i.createElement(ju,{showTitle:!1,feature:this.props.feature})):null},t}(i.Component),Iu=Object(I.b)(Tu),Mu=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getDisplayType=function(){return t.props.mapSize.width*t.props.mapSize.height>16e4?"balloon":"panel"},t._renderContent=function(){return t.props.content&&(t.props.content.data.feature.isTextInTitle?t.props.content.data.feature.title:t.props.content.data.feature.subtitle)?i.createElement(gi,{coordinates:t.props.content.data.coordinates,mapLocation:t.props.mapLocation,updateLocationRequest:t.props.updateLocationRequest,displayType:t._getDisplayType(),onClose:t.props.resetContentData,mapSize:t.props.mapSize},i.createElement(Iu,{feature:t.props.content.data.feature})):null},t}return Object(o.a)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,i.createElement(Cu,{features:this.props.userMap.features,cursor:this.props.cursor,onFeatureClick:this.props.onFeatureClick}),this._renderContent())},t}(i.Component),xu=n(52),Pu=Object(xu.a)("time",{getToday:function(){return new Date},timeContext:{hydrationPhaseTime:null}}),Nu=Pu.connect;Pu.Provider,Pu.Context;var zu=Nu;var Lu={Polygon:.025,MultiLineString:.05},Du=30,Au=function(e){function t(t){var n;return(n=e.call(this,t)||this)._timestamp=0,n._intensityRaf=-1,n._calculateIntensity=function(){if(n._stopAnimateIntensity(),n._getGeometry()){var e=n._getTargetIntensity();n.state.intensity!==e&&(n._stopAnimateIntensity(),n._startAnimateIntensity())}},n._startAnimateIntensity=function(){n._intensityRaf=window.requestAnimationFrame(n._animateIntensity)},n._stopAnimateIntensity=function(){window.cancelAnimationFrame(n._intensityRaf),n._timestamp=0},n._animateIntensity=function(){var e=n._getGeometry();if(e){var t=n._timestamp?(n.props.getToday().getTime()-n._timestamp)/(1e3/Du):1,r=Lu[e.type]*t,o=n._getTargetIntensity(),i=n.state.intensity,a=i<o?Math.min(o,i+r):Math.max(o,i-r);n.props.config.query["no-animation"]&&(a=o),n.setState({intensity:a}),a!==o?(n._timestamp=n.props.getToday().getTime(),n._startAnimateIntensity()):n._timestamp=0}},n._getTargetIntensity=function(){var e,t=n._getGeometry();if(!t)return 0;var r=n.props.searchResults.items[0],o="MultiLineString"===t.type&&r&&Fu(r);if("Polygon"!==t.type&&!o)return 1;var i,a,s,c=Ti((e=[]).concat.apply(e,t.coordinates));return i=c,a=n.props.mapLocation.bounds,s=n.props.mapLocation.zoom,function(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}(Object(Ro.a)(i,s),Object(Ro.a)(a,s))?0:1},n._getDrawingStyle=function(e,t){var r=n.state.intensity;switch(e.type){case"MultiLineString":return Fu(t)?{stroke:[{color:"#a3a8a8",opacity:r,width:3}],interactive:!1}:{stroke:[{color:"#000000",opacity:.18,width:6}],interactive:!1};case"Polygon":return{fill:qu(t)?"#00ff00":"#ff4141",fillOpacity:.05*r,stroke:[{color:qu(t)?"#359400":"#d54747",opacity:.7*r,width:2}],interactive:!1};default:return}},n._getGeometry=function(){var e=n.props.searchResults,t=e.requestDisplayGeometry;if(!t){var r=e.items[0];r&&"displayGeometry"in r&&(t=r.displayGeometry)}return Object(H.a)(t)},n.state={intensity:0},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._calculateIntensity()},n.componentDidUpdate=function(e){var t=this.props;e.mapLocation===t.mapLocation&&e.searchResults===t.searchResults||this._calculateIntensity()},n.componentWillUnmount=function(){this._stopAnimateIntensity()},n.render=function(){var e=this.props.searchResults.items[0];if(!e)return null;var t=this._getGeometry();if(!t)return null;var n=this._getDrawingStyle(t,e);return i.createElement(gt.a,{geometry:t,drawingStyle:n})},t}(i.PureComponent),Uu=["rezervation","forest","park","garden","grass"];function Fu(e){switch(e.type){case"toponym":return"route"===e.kind;default:return!1}}function qu(e){switch(e.type){case"toponym":return"vegetation"===e.kind;case"business":return(e.categories||[]).some(function(e){return Uu.includes(e.class||"")});default:return!1}}var Bu=zu(Object(I.b)(Object(Ut.b)({shouldWait:!0})(Au))),Hu=(n(380),n(382),n(384),{max:2});function Wu(e){return function(t,n){return function(e,t,n){void 0===n&&(n=Hu),"number"==typeof n.max&&(e=Math.round(e*Math.pow(10,n.max))/Math.pow(10,n.max));var r=e.toString().split("."),o=r[0],i=r[1],a=void 0===i?"":i;return t.thousands&&(o=o.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t.thousands)),"number"==typeof n.max&&(a=a.slice(0,n.max)),"number"==typeof n.min&&a.length<n.min&&(a+="0".repeat(n.min-a.length)),[o,a].filter(Boolean).join(t.decimal)}(t,e,n)}}var Gu=Wu({decimal:",",thousands:" "}),Yu={ru:Gu,en:Wu({decimal:".",thousands:","}),uk:Gu,tr:Wu({decimal:",",thousands:"."}),uz:Gu,kk:Gu};function Vu(e,t,n){return Yu[t](e,n)}var Zu={RUB:!0,EUR:!0,USD:!0,GBP:!0,BYN:!0,UAH:!0,KZT:!0,AMD:!0,AZN:!0,GEL:!0,GHC:!0,GHS:!0,ILS:!0,XOF:!0,KGS:!0,LVL:!0,LTL:!0,MDL:!0,RON:!0,RSD:!0,UZS:!0},Ku={RUB:"₽",EUR:"€",USD:"$",GBP:"£",UAH:"грн.",ILS:"₪"},Xu={XOF:"CFA"};function $u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object.keys(Zu).reduce(function(e,n){var r=t.includes(n)&&Ku[n];return e[n]={isSymbol:Boolean(r),value:r||Xu[n]||n},e},{})}var Ju=$u("RUB","EUR","USD","GBP","UAH","ILS"),Qu=$u("UAH"),el=$u("EUR","USD","GBP","ILS"),tl=$u("EUR","USD","GBP","ILS"),nl=function(e,t){return e+" "+t.value},rl=function(e,t){return t.value+(t.isSymbol?"":" ")+e};function ol(e,t){return function(n,r){return e(n,t[r])}}var il=ol(nl,Ju),al=ol(nl,Qu);ol(rl,tl),ol(rl,el);var sl=Object(ut.a)("business-rating-badge-view"),cl=Object(I.b)(function(e){var t=Math.round(2*e.ratingValue),n=Math.floor(t/2),r=!1;2*n!==t&&(r=!0);var o=e.size||"m";return i.createElement(dt.a,{name:"business_rating"},i.createElement("span",{className:sl({size:o})},i.createElement("div",{className:sl("stars")},new Array(5).fill(null).map(function(e,t){return i.createElement("span",{className:sl("star",{half:r&&t===n,empty:t>=(r?n+1:n),size:o}),key:t})})),e.onlyStars?null:i.createElement("span",{className:sl("rating")},i.createElement("span",{className:sl("rating-text",{size:o})},Vu(e.ratingValue,e.config.lang,{min:1,max:1})))))}),ul=Object(ut.a)("map-widget-business-rating-view"),ll=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getReviewUrl=function(){if(!t.props.disableLink){var e=c.b(t.props.result,{sublanding:"reviews"},{},{"add-review":""});return Object(u.a)(c.a("/"+e,t.props.config))}},t._renderContent=function(){var e=t.props;return e.result.ratingData?e.result.ratingData.ratingValue?i.createElement(cl,{ratingValue:e.result.ratingData.ratingValue}):(function(params){return (params.count?params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "отзыв" :(params.count % 10 > 1 && params.count % 10 < 5 && (params.count % 100 < 10 || params.count % 100 > 20) ? "отзыва" : "отзывов")):"Ещё нет отзывов");})({count:e.result.ratingData.reviewCount}):null},t}return Object(o.a)(t,e),t.prototype.render=function(){return i.createElement(Xn.a,{text:"Оценить место",position:"bottom",isAir:!0},i.createElement("a",{className:ul(),href:this._getReviewUrl(),target:"_blank"},this._renderContent()))},t}(i.Component),dl=Object(I.b)(ll),pl=(n(386),n(266)),fl=n(71),ml=n(54);function vl(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,o=r&&r.options&&r.options.weekStartsOn,i=null==o?0:Object(fl.a)(o),a=null==n.weekStartsOn?i:Object(fl.a)(n.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=Object(ml.a)(e,n),c=s.getDay(),u=(c<a?7:0)+c-a;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}n(106);var gl=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function hl(e,t){return{sunday:"Воскресенье",monday:"Понедельник",tuesday:"Вторник",wednesday:"Среда",thursday:"Четверг",friday:"Пятница",saturday:"Суббота"}[t]}function bl(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,o=r&&r.options&&r.options.firstWeekContainsDate,i=null==o?1:Object(fl.a)(o),a=null==n.firstWeekContainsDate?i:Object(fl.a)(n.firstWeekContainsDate),s=function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=Object(ml.a)(e,t),r=n.getFullYear(),o=t||{},i=o.locale,a=i&&i.options&&i.options.firstWeekContainsDate,s=null==a?1:Object(fl.a)(a),c=null==o.firstWeekContainsDate?s:Object(fl.a)(o.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var u=new Date(0);u.setFullYear(r+1,0,c),u.setHours(0,0,0,0);var l=vl(u,t),d=new Date(0);d.setFullYear(r,0,c),d.setHours(0,0,0,0);var p=vl(d,t);return n.getTime()>=l.getTime()?r+1:n.getTime()>=p.getTime()?r:r-1}(e,t),c=new Date(0);return c.setFullYear(s,0,a),c.setHours(0,0,0,0),vl(c,t)}var yl=6048e5;function _l(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=Object(ml.a)(e,t),r=vl(n,t).getTime()-bl(n,t).getTime();return Math.round(r/yl)+1}var El=["break","opening_soon","closing_soon"];function wl(e,t,n){var r;void 0===n&&(n={});var o,i=e.status,a=e.currentWorkingStatus,s=n.short?null==a?void 0:a.shortText:null==a?void 0:a.text;return{text:n.showMoved&&(null===(r=e.businessProperties)||void 0===r?void 0:r.moved_to)?"Организация переехала":"open"===i?null!=s?s:"График работы не указан":(o=i,{"possible-closed":"Возможно, больше не работает","temporary-closed":"Временно не работает","permanent-closed":"Больше не работает"}[o]),state:{closed:"open"!==i||Boolean(a&&!a.isOpenNow),"changing-soon":!(!a||!a.tag)&&a.tag.some(function(e){return El.includes(e)}),"no-data":!s}}}function Sl(e,t){if(!e)return{};var n=[];e.unusual_hours&&(n=n.concat(e.unusual_hours)),e.valid_schedule&&(n=n.concat(e.valid_schedule));var r=ke.e(ke.d(t));return n.reduce(function(e,n){var o=function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");return Object(ml.a)(e,t).getDay()}(n),i=_l(n,{weekStartsOn:1})===_l(r,{weekStartsOn:1});if(!e[o]&&i){var a=Object(ml.a)(n);e[o]=Object(hi.a)(a,t)}return e},{})}n(388);var Ol=n(390),Cl=n.n(Ol),kl=Object(ut.a)("flip-icon"),jl=function(e){var t=e.isFlipped;return i.createElement(Ot.a,{className:kl({flipped:t}),url:Cl.a})},Rl=Object(ut.a)("map-widget-business-working-intervals-view"),Tl=function(e){var t=Object(I.c)(),n=i.useState(!1),o=n[0],a=n[1],s=wl(e.result),c=function(e,t){if(e.workingTime){var n=ke.e(ke.d(t)).getDay(),r=Sl(e.businessProperties,t);return[].concat(e.workingTime.slice(1),[e.workingTime[0]]).map(function(e,t){var o,i=(t+1)%7,a=Object(pl.a)(gl[i].slice(0,2));return e?1===e.length&&0===ke.b(e[0].to,e[0].from)?(o="Круглосуточно",a+=" 00:00-23:59"):(o=e.map(function(e){var t=e.from,n=e.to;return ke.h(t)+" – "+ke.h(n)}),a+=" "+e.map(function(e){var t=e.from,n=e.to;return ke.h(t)+"-"+ke.h(n)}).join(",")):(o="Выходной",a=""),{dayName:hl(0,gl[i]),text:o,isWeekend:!e,isToday:n===i,changedDate:r[i],meta:a}})}}(e.result,t)||[],u=c.length>0;return i.createElement("div",{className:Rl()},i.createElement("div",{className:Rl("labels")},e.children?i.createElement("div",{className:Rl("extra-label")},e.children):null,i.createElement("div",{className:Rl("time-label",Object(r.a)(Object(r.a)({},s.state),{},{clickable:u})),onClick:u?function(){a(!o)}:void 0},i.createElement("span",{className:Rl("label-text")},s.text),u?i.createElement("div",{className:Rl("working-status-control")},i.createElement(jl,{isFlipped:o})):null)),o?i.createElement("div",{className:Rl("intervals")},c.map(function(e,t){var n=e.changedDate?i.createElement(i.Fragment,null,e.dayName,", ",i.createElement("span",{className:Rl("date")},e.changedDate)):e.dayName;return i.createElement(Xn.a,{key:t,isDisabled:!e.changedDate,position:["right"],text:"Праздничный день"},i.createElement("div",{className:Rl("interval")},i.createElement("div",{className:Rl("day")},n),i.createElement("span",{className:Rl("time")},Array.isArray(e.text)?e.text.join(", "):e.text)))})):null)};n(391),n(205),"факс","тел.","тел./факс";var Il=Object(ut.a)("map-widget-business-contacts-view"),Ml=function(e){var t,n=Object(I.c)(),r=i.useState(!1),o=r[0],a=r[1],s=function(){a(!o)},u=function(e,t,n){var r=(void 0===n?{}:n).useRealty,o=void 0===r||r,i=e.phones||[],a=e.realty;return a&&a.company.phone&&o&&!e.advert&&(i=[{number:a.company.phone,counter:a.company.phoneCounter+"&source=map&crc="+t.xscriptCsrfToken,type:"phone",info:"Офис продаж"}]),i}(e.result,n),l=u[0],d=u.slice(1),p=null===(t=e.result.urls)||void 0===t?void 0:t[0];return i.createElement("div",{className:Il()},e.result.fullAddress?i.createElement("div",{className:Il("item")},i.createElement(bt.a,{inline:!0,name:"logo",size:24,className:Il("icon")}),e.result.fullAddress):null,l?i.createElement("div",{className:Il("item")},i.createElement("div",null,l?i.createElement("div",{className:Il("phone-container")},i.createElement("a",{className:Il("main-phone"),href:"tel:"+l.number},i.createElement(bt.a,{inline:!0,name:"call",size:24,className:Il("icon")}),l.number),d.length>0?i.createElement("div",{className:Il("flip"),onClick:s},d.length,i.createElement(jl,{isFlipped:o})):null):null,o?d.map(function(e){return i.createElement("a",{key:e.number,className:Il("phone"),href:"tel:"+e.number},e.number)}):null)):null,p?i.createElement("div",{className:Il("item")},i.createElement(bt.a,{inline:!0,name:"web",size:24,className:Il("icon")}),i.createElement("a",{className:Il("url"),href:p,target:"_blank"},c.h(p,!0))):null)},xl=(n(393),n(395)),Pl=n.n(xl),Nl=Object(ut.a)("map-widget-nearest-stops-view"),zl=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._renderFromStopDistance=function(e){var n={coords:t.props.result.coordinates,value:"",uri:t.props.result.uri},r={coords:e.coordinates,value:""},o=Object(u.a)(Object(u.b)([r,n],{travelMode:"pedestrian"},t.props.config));return i.createElement("a",{className:Nl("distance"),href:o,target:"_blank"},i.createElement("div",{className:Nl("distance-icon")},i.createElement(bt.a,{name:"pedestrian",size:24,inline:!0,className:Nl("distance-icon-inner")})),i.createElement("div",{className:Nl("distance-text")},e.distance))},t._renderStop=function(e){var n="metro"===e.type?e.color:void 0;return i.createElement("div",{className:Nl("stop"),key:e.id},i.createElement("div",{className:Nl("metro-icon")},i.createElement(Ot.a,{url:Pl.a,style:{color:n}})),i.createElement("div",null,e.name),t._renderFromStopDistance(e))},t}return Object(o.a)(t,e),t.prototype.render=function(){return this.props.result.metro?this.props.result.metro.map(this._renderStop):null},t}(i.Component),Ll=Object(I.b)(zl),Dl=(n(396),Object(ut.a)("map-widget-business-buttons-view")),Al=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._renderGetToButton=function(){var e={coords:t.props.result.coordinates,value:"",uri:t.props.result.uri},n=Object(u.a)(Object(u.b)([{coords:null,value:""},e],{},t.props.config));return i.createElement("div",{className:Dl("button-container")},i.createElement(Kn.a,{view:"secondary-blue",size:"small",isStretched:!0,url:n,target:"_blank"},"Как добраться"))},t._renderAboutButton=function(){return i.createElement("div",{className:Dl("button-container")},i.createElement(Kn.a,{view:"primary",size:"small",isStretched:!0,url:t.props.businessUrl,target:"_blank"},"Об организации"))},t}return Object(o.a)(t,e),t.prototype.render=function(){return i.createElement("div",{className:Dl()},this._renderGetToButton(),this._renderAboutButton())},t}(i.Component),Ul=Object(I.b)(Al);n(398);var Fl=function(){return(Fl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.create;Object.create;function ql(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var r,o,a=Object(i.useRef)(0),s=(r=Object(i.useRef)(!1),o=Object(i.useCallback)(function(){return r.current},[]),Object(i.useEffect)(function(){return r.current=!0,function(){r.current=!1}},[]),o),c=Object(i.useState)(n),u=c[0],l=c[1];return[u,Object(i.useCallback)(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=++a.current;return l(function(e){return Fl(Fl({},e),{loading:!0})}),e.apply(void 0,t).then(function(e){return s()&&r===a.current&&l({value:e,loading:!1}),e},function(e){return s()&&r===a.current&&l({error:e,loading:!1}),e})},t)]}var Bl={},Hl={getRoute:function(e,t){var n=e.points.join("~");return Bl[n]||(Bl[n]=Object(R.a)("taxi/getRoute",{query:{rll:n,lang:t.locale}},t)),Bl[n]},checkCoverage:function(e,t){return Object(R.a)("taxi/checkCoverage",{query:{ll:Object(Hn.a)(e.center),lang:t.locale}},t)}},Wl=Object(ut.a)("map-widget-taxi-link-view"),Gl=function(e){var t=Object(I.c)(),n=ql(function(){return Hl.checkCoverage({center:e.endPoint},t)},[e.endPoint,t],{value:null,loading:!1}),r=n[0],o=n[1];i.useEffect(function(){o()},[e.endPoint,o]);return r.value||r.loading?i.createElement("div",{className:Wl()},i.createElement(bt.a,{name:"yndx-taxi",size:16,className:Wl("icon")}),i.createElement("a",{className:Wl("link"),href:function(){var n,r,o,i=null===(n=t.mapWidget)||void 0===n?void 0:n.taxi,a=t.uatraits.isMobile;if(i){var s=(null===(r=e.startPoint)||void 0===r?void 0:r.map(String))||[],u=s[0],l=void 0===u?"":u,d=s[1],p=void 0===d?"":d,f=e.endPoint.map(String),m=f[0],v=void 0===m?"":m,g=f[1],h=void 0===g?"":g;return c.l({urlTemplate:a?i.mobileUrlTemplate:i.urlTemplate,domain:i.domain,startLat:p,startLon:l,endLat:h,endLon:v,tariffClass:"",lang:null!==(o=i.lang)&&void 0!==o?o:"ru"})}}(),target:"_blank"},"Вызвать такси")):null},Yl=(n(400),Object(ut.a)("map-widget-content-title-view")),Vl=function(e){return i.createElement(i.Fragment,null,i.createElement("a",{href:e.titleUrl,target:"_blank",className:Yl("title",{disabled:!e.titleUrl})},e.title),e.subtitle?i.createElement("div",{className:Yl("subtitle")},e.subtitle):null)},Zl=Object(ut.a)("map-widget-business-content-view"),Kl=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getCategories=function(){if(t.props.result.categories&&0!==t.props.result.categories.length)return t.props.result.categories.map(function(e){return e.name}).join(", ")},t._renderFeedbackUrl=function(){var e=t.props,n=c.e(e.result.id),r=Object(u.a)(c.a(n,e.config));return i.createElement("a",{className:Zl("feedback-link"),href:r,target:"_blank"},"Сообщить об ошибке")},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=c.b({id:e.result.id,seoname:e.result.seoname},{},{baseUrl:""}),n=Object(u.a)(c.a("/"+t,this.props.config));return i.createElement("div",{className:Zl()},i.createElement(Vl,{title:e.result.title,titleUrl:n,subtitle:this._getCategories()}),i.createElement(Tl,{result:this.props.result},i.createElement(dl,{result:e.result})),i.createElement(Ml,{result:e.result}),i.createElement("div",{className:Zl("stops")},i.createElement(Ll,{result:e.result})),i.createElement("div",{className:Zl("business-buttons")},i.createElement(Ul,{businessUrl:n,result:e.result})),i.createElement("div",{className:Zl("bottom-links")},i.createElement(Gl,{endPoint:e.result.coordinates,startPoint:e.userCoordinates}),this._renderFeedbackUrl()))},t}(i.Component),Xl=Object(I.b)(Kl),$l=(n(402),Object(ut.a)("map-widget-toponym-content-view")),Jl=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getUrl=function(){var e,n=c.g(t.props.result,t.props.result.region,{baseUrl:"",skipPointCheck:!0});n||(n="?"+v.stringify({poi:{uri:null===(e=t.props.result)||void 0===e?void 0:e.uri,point:Object(Hn.a)(t.props.result.coordinates)}}));var r=Object(u.a)(c.a("/"+n,t.props.config));return t.props.isTrafficLayerEnabled&&(r+="&l="+(t.props.config.query.l||"trf")),r},t._getInsideUrl=function(){var e=t.props.result.businesses&&t.props.result.businesses.totalResultCount>0,n=c.g(t.props.result,t.props.result.region,{baseUrl:"",skipPointCheck:!0},e?{sublanding:"inside"}:{});return Object(u.a)(c.a("/"+n,t.props.config))},t._renderContent=function(){return"house"===t.props.result.kind?i.createElement(i.Fragment,null,i.createElement("div",{className:$l("nearest-stops")},i.createElement(Ll,{result:t.props.result})),i.createElement("div",{className:$l("button-wrapper")},i.createElement(Kn.a,{view:"primary",size:"small",isStretched:!0,url:t._getInsideUrl(),target:"_blank"},"Организации в доме"))):i.createElement("div",{className:$l("button-wrapper")},i.createElement(Kn.a,{view:"primary",size:"small",isStretched:!0,url:t._getUrl(),target:"_blank"},"Открыть в Картах"))},t._renderFeedbackUrl=function(){if(!t.props.result.uri)return null;var e=c.f(t.props.result.uri),n=c.a(e,t.props.config);return i.createElement("div",{className:$l("button-wrapper")},i.createElement(Kn.a,{view:"secondary-blue",size:"small",isStretched:!0,url:n,target:"_blank"},"Сообщить об ошибке"))},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement("div",{className:$l()},i.createElement("div",{className:$l("title-wrapper")},i.createElement(Vl,{title:e.result.title,titleUrl:this._getUrl(),subtitle:this.props.result.description})),this._renderContent(),this._renderFeedbackUrl())},t}(i.Component),Ql=Object(I.b)(Jl),ed=n(73),td=(n(404),n(406)),nd=n.n(td),rd=Object(ut.a)("search-placemark-title"),od=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._renderStars=function(e){var t=e.property.find(function(e){return"id"===e.key});if(!t)return null;var n=H.e(t.value);if(0===n)return null;for(var r=new Array(n),o=0;o<n;o++)r[o]=i.createElement(Ot.a,{key:o,url:nd.a});return i.createElement("span",{key:"stars",className:rd("subtitle-item")},r)},t._renderRating=function(e){var n=e.property.find(function(e){return"value_5"===e.key});return n?i.createElement("span",{className:rd("subtitle-item"),key:"rating"},i.createElement(Ot.a,{url:nd.a,className:rd("subtitle-item-rating-image")}),i.createElement("span",{className:rd("subtitle-item-rating")},Vu(Number(n.value),t.props.config.lang,{min:1,max:1}))):null},t._renderWorkingHours=function(e){var t=e.property.find(function(e){return"is_open"===e.key}),n="closed_for_visitors"===e.type||!!t&&"0"===t.value;return i.createElement("span",{key:"working_hours",className:rd("subtitle-item",{"closed-now":n})},e.text)},t._renderSubtitleItem=function(e){var n=e.text?e.text:"";return"star"===e.type?t._renderStars(e):"rating"===e.type?t._renderRating(e):"working_hours"===e.type||"closed_for_visitors"===e.type?t._renderWorkingHours(e):n?i.createElement("span",{key:e.type,className:rd("subtitle-item")},n):null},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=this.props.subtitleItems;return i.createElement("div",{className:rd({background:e.background,"low-relevance":e.isLowRelevance,position:e.position,"no-truncate":e.disableTruncate})},i.createElement("div",{className:rd("title")},e.title),t&&e.showSubtitle?i.createElement("div",{className:rd("subtitle")},t.map(this._renderSubtitleItem)):null)},t}(i.PureComponent),id=Object(I.b)(od),ad=(n(407),Object(ut.a)("poi-placemark-title")),sd=function(e){var t=Object(ba.a)(e.title,{length:40});return i.createElement("div",{className:ad(),style:{color:e.color,WebkitTextFillColor:e.color}},t.split(" ").map(function(e,t){return i.createElement("span",{key:t,className:ad("word")},e)}))},cd=(n(409),function(e){function t(t){var n;return(n=e.call(this,t)||this)._fetchIcon=function(){n.props.icon.promise.then(function(e){n.setState({element:e})})},n.state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._fetchIcon()},n.componentDidUpdate=function(e){this.props.icon.promise!==e.icon.promise&&this._fetchIcon()},n.render=function(){var e,t,n=this.state.element;return n?(null===(e=(t=this.props).children)||void 0===e?void 0:e.call(t,n))||n:null},t}(i.Component)),ud=Object(ut.a)("search-placemark-icon");function ld(e,t){return!t.experiments.ui.searchPinsNoClosed&&("business"===e.type&&("open"!==e.status||wl(e).state.closed))}var dd=function(e){var t,n="lowRelevance"in e.result,o={mode:e.mode,state:e.state,"has-advert":H.g(e.result),"low-relevance":n,closed:ld(e.result,e.config)},a="business"===e.result.type?n?e.result.businessProperties&&e.result.businessProperties.geoproduct_poi_color||"#999":null===(t=e.style)||void 0===t?void 0:t.color:void 0,s=a?{color:a}:void 0;return i.createElement("div",{className:ud(o),style:Object(r.a)({},s)},i.createElement(cd,{icon:e.icon}))},pd=(n(411),n(413)),fd=n.n(pd),md=n(414),vd=n.n(md),gd=n(415),hd=n.n(gd),bd=Object(ut.a)("search-placemark-icons"),yd={dot:{source:fd.a,width:22,height:22},base:{source:vd.a,width:34,height:34},active:{source:hd.a,className:bd("active"),width:60,height:68,baseY:64,centerY:28}};function _d(e){return yd[e]}function Ed(e,t){return Object(r.a)(Object(r.a)({},Sd(e)),{},{promise:t?t.then(function(t){return wd(e,t)}):Promise.resolve(wd(e))})}function wd(e,t){var n=Sd(e),r=n.width,o=n.height,a=n.centerX,s=n.centerY,c={className:e.className,dangerouslySetInnerHTML:{__html:e.source}};return t?i.createElement("div",{style:{position:"relative",width:r,height:o}},i.createElement("div",c),i.createElement("div",{style:{position:"absolute",left:a,top:s}},"point"===t?i.createElement("div",{className:bd("content")}):t)):i.createElement("div",Object(Gt.a)({style:{width:r,height:o}},c))}function Sd(e){var t=Math.round(e.width/2),n=Math.round(e.height/2);return{width:e.width,height:e.height,baseX:e.baseX||t,baseY:e.baseY||n,centerX:e.centerX||t,centerY:e.centerY||n}}var Od={base:{width:34,height:40,baseY:40},active:{width:60,height:68,baseY:64,centerY:28},dot:{width:22,height:22}},Cd={};function kd(e,t){return{default:jd("default",e,t),hover:jd("hover",e,t),visited:jd("visited",e,t)}}function jd(e,t,n){var o=Od[t];return Object(r.a)(Object(r.a)({},Sd(o)),{},{promise:n.then(function(n){var i,a,s=null===(i=n[t])||void 0===i?void 0:i[e];return s?wd(Object(r.a)(Object(r.a)({},o),{},{source:(a=s,'<img src="'+a+'" width="100%" height="100%" />')})):void 0})})}var Rd={get:function(e,t){if(!Cd[e]){var n=Object(R.a)("branding/icons",{query:{name:e}},t);Cd[e]={base:kd("base",n),active:kd("active",n),dot:kd("dot",n)}}return Cd[e]}},Td=(n(416),n(418)),Id=n.n(Td),Md=n(419),xd=n.n(Md),Pd=n(420),Nd=n.n(Pd),zd=Object(ut.a)("rubric-placemark-icons-provider"),Ld={geoproduct:{source:Id.a,width:34,height:40,centerY:17,baseY:38},"low-relevance":{source:xd.a,width:28,height:34,baseY:32,centerX:14,centerY:15},card:{source:Nd.a,width:34,height:40,baseY:38,centerX:14,centerY:14}},Dd={};function Ad(e,t,n){return{default:Ed("base"===e&&n&&Ld[n]||_d(e),t.then(function(t){return i.createElement("div",{className:zd(e+"-content",{"pin-type":n}),dangerouslySetInnerHTML:{__html:t[e]}})}))}}var Ud={get:function(e,t,n){var r=function(e,t){if(!Dd[e]){var n=["small","normal"].map(function(n){return yt.a({type:"rubrics",name:e,size:n},t)||""}).map(function(e){return e?Object(j.a)({url:e,parser:"string"}):Promise.resolve("")});Dd[e]=Promise.all(n).then(function(e){return{base:e[0],active:e[1]}})}return Dd[e]}(e,t);return{base:Ad("base",r,n),active:Ad("active",r)}}},Fd="https://avatars.mds.yandex.net/get-{id}_%s",qd={dot:{width:18,height:18},base:{width:34,height:40,baseY:36},active:{width:60,height:60,baseY:56,centerY:28}};function Bd(e,t){e.startsWith("https://")||(e=Fd.replace("{id}",e.replace(/--/g,"/")));var n=Math.max(2,Math.ceil(window.devicePixelRatio||1)),r=e.replace("%s","x"+n);return'<img height="'+qd[t].height+'" width="'+qd[t].width+'" src="'+r+'" />'}var Hd={get:function(e){return Object.entries(e).reduce(function(e,t){var n,o=t[0],i=t[1];return Object(r.a)(Object(r.a)({},e),{},((n={})[o]=Object.entries(i||{}).reduce(function(e,t){var n,i=t[0],a=t[1];return Object(r.a)(Object(r.a)({},e),{},((n={})[i]=Ed(Object(r.a)({source:Bd(a,o)},qd[o])),n))},{}),n))},{})}},Wd={width:60,height:68,baseY:64,centerY:28},Gd={transit:26};function Yd(e,t){var n='<div class="poi-icon-provider" style="'+("width: "+t.width+"px; height: "+t.height+"px;background: url("+e+") 50% bottom no-repeat; background-size: contain")+'" />';return{default:Ed(Object(r.a)({source:n},t))}}var Vd={get:function(e,t){var n=(t||[]).find(function(e){return Object.keys(Gd).includes(e)});return{active:Yd(e,Object(r.a)(Object(r.a)({},Wd),{},{centerY:n&&Gd[n]||Wd.centerY}))}}};var Zd={};function Kd(e){var t,n="shortTitle"in e.result&&e.result.shortTitle||e.result.title||"",o="subtitleItems"in e.result&&e.result.subtitleItems||[],a="hover"===e.state;if(e.hideTitle||!n||["dot","base"].includes(e.mode)&&!a)return Promise.resolve(void 0);var s="lowRelevance"in e.result,c="business"===e.result.type&&!e.config.experiments.ui.disableSearchResultsPreview,u={title:n,subtitleItems:o,showSubtitle:["active","subtitle"].includes(e.mode)||a&&!c,background:"active"!==e.mode,isLowRelevance:s,disableTruncate:!0},l=s&&"business"===e.result.type&&(null===(t=e.result.businessProperties)||void 0===t?void 0:t.geoproduct_poi_label_color)||void 0,d=e.titlePosition||"right",p=s&&!["dot","active"].includes(e.mode)&&e.config.isVectorEnabled?i.createElement(sd,{title:n,color:l}):i.createElement(id,Object(Gt.a)({},u,{position:d})),f=JSON.stringify(u);return Zd[f]=Zd[f]||zi(function(){return p}),Zd[f].then(function(e){return Object(r.a)(Object(r.a)({},e),{},{element:p,position:d})})}function Xd(e){var t=e.state||"default",n=["title","subtitle"].includes(e.mode)?"base":e.mode,o=function(e){var t=e.result,n=H.d(t);if("lowRelevance"in t)return Ud.get(n||"",e.config,"low-relevance");if("business"===t.type&&!t.direct&&t.advert&&t.advert.pinBranding)return Hd.get(t.advert.pinBranding);if("brandingId"in t&&t.brandingId)return Rd.get(t.brandingId,e.config);if("hotspotProperties"in t&&t.hotspotProperties&&t.hotspotProperties.selectedIconUrl)return Vd.get(t.hotspotProperties.selectedIconUrl,t.hotspotProperties.tags);if(n){var r,o=(null===(r=e.style)||void 0===r?void 0:r.forceGeoproduct)||H.g(t)?"geoproduct":"default";return Ud.get(n,e.config,o)}return}(e),a=null==o?void 0:o[n],s=(null==a?void 0:a[t])||(null==a?void 0:a.default)||Ed(_d(n),Promise.resolve("dot"!==n?"point":void 0));return Object(r.a)(Object(r.a)({},s),{},{element:i.createElement(dd,{result:e.result,state:t,icon:s,mode:n,config:e.config,style:e.style})})}var $d=n(421),Jd=function(e){function t(t){var n;return(n=e.call(this,t)||this)._calcPlacemarkAction=void 0,n._calcPlacemark=function(e){p.a.cancel(n._calcPlacemarkAction);var t=n.state.hover?"hover":"default",r=e.result,o=e.mode,i=e.config;n._calcPlacemarkAction=p.a.create(function(e){return Promise.all([Xd(e),Kd(e)]).then(function(e){return{icon:e[0],title:e[1]}})}({result:r,mode:o,state:t,config:i}),{success:function(e){return n.setState({placemark:e})}})},n._onMouseEnter=function(){var e=Object(ed.a)(n).props;n.setState({hover:!0},function(){return n._calcPlacemark(e)})},n._onMouseLeave=function(){var e=Object(ed.a)(n).props;n.setState({hover:!1},function(){return n._calcPlacemark(e)})},n.state={hover:!1},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._calcPlacemark(this.props)},n.componentDidUpdate=function(e){e!==this.props&&this._calcPlacemark(this.props)},n.componentWillUnmount=function(){p.a.cancel(this._calcPlacemarkAction)},n.render=function(){var e=this.state.placemark;if(!e)return null;var t=this.props,n=t.result,r=pt.a.search[t.mode];return i.createElement($d.a,Object(Gt.a)({coordinates:t.coordinates,result:n},e,{analyticsName:t.analyticsName,zIndex:this.state.hover?r+1:r,onClick:t.onClick,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave}))},t}(i.Component),Qd=Object(I.b)(Jd),ep=460,tp={advert:void 0,brandingId:void 0},np=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._getDisplayType=function(){return t.props.mapSize.width>=ep?"balloon":"panel"},t._renderStaticSearchResult=function(e){var n;if(!e||e.id===(null===(n=t.props.content)||void 0===n?void 0:n.data.result.id))return null;var o={requestId:"",requestResults:1,totalResultCount:1,items:[e]};return i.createElement(i.Fragment,null,i.createElement(Bu,{searchResults:o,mapLocation:t.props.mapLocation}),i.createElement(Qd,{result:Object(r.a)(Object(r.a)({},e),tp),coordinates:e.coordinates,mode:"active",onClick:t.props.onStaticPlacemarkClick}),i.createElement(pa,{uri:e.uri}))},t._renderContentSearchResult=function(){var e=t.props.content,n=t._getDisplayType();if(!e)return null;var o=e.data.result,a={requestId:"",requestResults:1,totalResultCount:1,items:[o]};return i.createElement(i.Fragment,null,i.createElement(gi,{coordinates:e.data.coordinates,mapLocation:t.props.mapLocation,displayType:n,updateLocationRequest:t.props.updateLocationRequest,onClose:t.props.onContentClose,mapSize:t.props.mapSize},"business"===o.type?i.createElement(Xl,{result:o}):i.createElement(Ql,{result:o,isTrafficLayerEnabled:t.props.isTrafficLayerEnabled})),i.createElement(Bu,{searchResults:a,mapLocation:t.props.mapLocation}),"panel"===n?i.createElement(i.Fragment,null,i.createElement(Qd,{result:Object(r.a)(Object(r.a)({},o),tp),coordinates:o.displayCoordinates,mode:"active"}),i.createElement(pa,{uri:o.uri})):null)},t}return Object(o.a)(t,e),t.prototype.render=function(){var e,t,n,r,o=null===(e=this.props.config.whatsherePreloadedResults)||void 0===e?void 0:e.items[0],a=null===(t=this.props.config.poiPreloadedResults)||void 0===t?void 0:t.items[0],s=null===(n=this.props.config.mapWidget)||void 0===n?void 0:null===(r=n.activeObject)||void 0===r?void 0:r.items[0];return i.createElement(i.Fragment,null,this._renderStaticSearchResult(o),this._renderStaticSearchResult(a),this._renderStaticSearchResult(s),this._renderContentSearchResult())},t}(i.Component),rp=Object(I.b)(np),op=(n(426),n(428),Object(ut.a)("masstransit-underground-line-name-view")),ip=Object(I.b)(function(e){var t,n=e.transport,r=e.config,o=n.city?yt.a({type:"masstransit",name:"underground-"+n.city,size:"small"},r):null;return i.createElement("div",{className:op()},o?i.createElement("div",{className:op("icon")},i.createElement(Ot.a,{url:o})):null,i.createElement("div",{className:op("line-number"),style:{backgroundColor:n.Style&&n.Style.color||"transparent"}},null!==(t=n.lineNumber)&&void 0!==t?t:null),i.createElement("div",{className:op("line-name")},n.name))}),ap=Object(ut.a)("map-widget-masstransit-stop-content-view"),sp=function(e){var t,n,r,o=Object(I.c)(),a=e.content.data.stop,s=a.region?c.d(a,a.region,{baseUrl:""}):"",l=Object(u.a)(c.a("/"+s,o)),d={coords:a.coordinates,value:"",uri:null===(t=a.searchResult)||void 0===t?void 0:t.uri},p=Object(u.b)([{coords:null,value:""},d],{},o),f=function(){if("railway"===a.type){var e,t=null===(e=a.links)||void 0===e?void 0:e.find(function(e){return"timetable"===e.type});return null==t?void 0:t.href}if("underground"===a.type)return c.i(o.hosts.metro,{ll:Object(Hn.a)(a.coordinates)});if("urban"===a.type&&a.region){var n=c.d(a,a.region)||"";return Object(u.a)(c.a("/"+n,o))}};return i.createElement("div",{className:ap()},i.createElement(Vl,{title:("underground"===a.type?"Станция метро":"railway"===a.type?"Ж/д станция":"Остановка")+" "+a.name,titleUrl:l,subtitle:"underground"!==a.type?null===(n=a.searchResult)||void 0===n?void 0:n.description:void 0}),"underground"===a.type&&a.transports[0]?i.createElement("div",{className:ap("underground-title")},i.createElement(ip,{transport:a.transports[0]})):null,i.createElement("div",{className:ap("buttons-container")},i.createElement("div",{className:ap("button-container")},i.createElement(Kn.a,{view:"secondary-blue",size:"small",isStretched:!0,url:p,target:"_blank"},"Как добраться")),i.createElement("div",{className:ap("button-container")},i.createElement(Kn.a,{view:"primary",size:"small",isStretched:!0,url:f(),target:"_blank"},"underground"===a.type?"Схема метро":"railway"===a.type?"Показать расписание":"Список маршрутов"))),(null===(r=a.searchResult)||void 0===r?void 0:r.metro)&&"underground"!==a.type?i.createElement("div",{className:ap("nearest-stops")},i.createElement(Ll,{result:a.searchResult})):null)},cp=(n(430),{bus:"bus-stop",minibus:"bus-stop",tramway:"tram-stop",trolleybus:"bus-stop",suburban:"railway-station",funicular:"funicular",cable:"cableway",underground:"subway-fallback",water:"pier",aeroexpress:"aeroexpress"}),up=Object(I.b)(function(e){var t=e.undergroundCity&&yt.a({type:"masstransit",name:e.vehicleType+"-"+e.undergroundCity,size:e.size},e.config)||yt.a({type:"rubrics",name:e.vehicleType&&cp[e.vehicleType]||"fallback",size:e.size},e.config);return t?i.createElement(Ot.a,{url:t,className:e.className}):null}),lp=n(432),dp=n.n(lp),pp=n(433),fp=n.n(pp),mp=n(434),vp=n.n(mp),gp=Object(ut.a)("masstransit-stop-placemark"),hp=function(e){function t(){return e.apply(this,arguments)||this}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(zo,{name:"masstransit_stop_placemark",logClick:!0},i.createElement(lt.a,{coordinates:e.coordinates,onClick:e.onClick,zIndex:pt.a.masstransitStop},i.createElement("div",{className:gp({bookmark:e.isBookmark})},!e.hotspotIconUrl||e.isBookmark?i.createElement(up,{className:gp("content-icon"),size:"normal",vehicleType:e.type,undergroundCity:e.undergroundCity}):null,e.hotspotIconUrl&&!e.isBookmark?i.createElement("img",{src:e.hotspotIconUrl,className:gp("background-icon"),width:"60",height:"68"}):i.createElement(Ot.a,{className:gp("background-icon"),url:e.isBookmark?fp.a:e.undergroundCity?vp.a:dp.a}))),e.id?i.createElement(pa,{uri:X.a(e.id)}):null)},t}(i.PureComponent),bp=Object(I.b)(hp),yp=460,_p=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getDisplayType=function(){return t.props.mapSize.width>=yp?"balloon":"panel"},t._renderStopPlacemark=function(e,t){var n,r=Object(ka.d)(e);"underground"===r&&(n=e.transports[0].city);return i.createElement(bp,{id:e.id,type:r,coordinates:e.coordinates,undergroundCity:n,isBookmark:!1,onClick:function(){return null==t?void 0:t(e)}})},t._renderStaticStop=function(){var e,n=t.props.config.masstransitStop;return n&&n.id!==(null===(e=t.props.content)||void 0===e?void 0:e.data.stop.id)?t._renderStopPlacemark(n,t.props.onStaticPlacemarkClick):null},t._renderContentStop=function(){var e=t._getDisplayType();return t.props.content?i.createElement(i.Fragment,null,i.createElement(gi,{coordinates:t.props.content.data.coordinates,mapLocation:t.props.mapLocation,updateLocationRequest:t.props.updateLocationRequest,onClose:t.props.onContentClose,displayType:e,mapSize:t.props.mapSize},i.createElement(sp,{content:t.props.content})),"panel"===e?t._renderStopPlacemark(t.props.content.data.stop):null):null},t}return Object(o.a)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,this._renderContentStop(),this._renderStaticStop())},t}(i.Component),Ep=Object(I.b)(_p),wp=n(220),Sp=n(69),Op=Sp.a?Sp.a.isConcatSpreadable:void 0;var Cp=function(e){return Object(mc.a)(e)||Object(Tc.a)(e)||!!(Op&&e&&e[Op])};var kp=function e(t,n,r,o,i){var a=-1,s=t.length;for(r||(r=Cp),i||(i=[]);++a<s;){var c=t[a];n>0&&r(c)?n>1?e(c,n-1,r,o,i):Object(wp.a)(i,c):o||(i[i.length]=c)}return i};var jp,Rp=function(e){return(null==e?0:e.length)?kp(e,1):[]},Tp=6e4;function Ip(e,t){var n,r,o,i,a=e.threads[0];if((null==a?void 0:null===(n=a.BriefSchedule)||void 0===n?void 0:n.Events)&&(null===(r=a.BriefSchedule)||void 0===r?void 0:r.Events.length)>0){var s,c,u=(null===(s=a.BriefSchedule.Events[0].Estimated)||void 0===s?void 0:s.value)||(null===(c=a.BriefSchedule.Events[0].Scheduled)||void 0===c?void 0:c.value);if(u){var l=1e3*Number(u);return l-t<Tp?l-t:l}}if((null==a?void 0:null===(o=a.BriefSchedule)||void 0===o?void 0:o.Frequencies)&&(null==a?void 0:null===(i=a.BriefSchedule)||void 0===i?void 0:i.Frequencies.length)>0){var d=1e3*a.BriefSchedule.Frequencies[0].value,p=a.BriefSchedule.Frequencies[0].begin?1e3*Number(a.BriefSchedule.Frequencies[0].begin.value):void 0,f=a.BriefSchedule.Frequencies[0].end?1e3*Number(a.BriefSchedule.Frequencies[0].end.value):void 0;return f&&f<t?-1/0:!p||p<t?d:p}return-1/0}var Mp={loadLayerRegions:function(e){return jp||(jp=Object(R.a)("masstransit/getLayerRegions",{},e).catch(function(){return[]}))},getStopInfo:function(e,t){return Object(R.a)("masstransit/getStopInfo",{query:{id:e.id,uri:e.uri,locale:t.locale,lang:t.lang,mode:"prognosis"}},t).then(function(e){if(!e)throw new Error("Stop no data");return e})},getStopTimetable:function(e,t){return Object(R.a)("masstransit/getStopTimetable",{query:{id:e.id,timestamp:e.timestamp,locale:t.locale,lang:t.lang}},t).then(function(e){if(!e)return null;var t=function(e){return{id:e.id,name:e.name,type:e.type,currentTime:e.currentTime,region:e.region,tzOffset:e.tzOffset,transports:Rp(e.transports.map(function(e){return Rp(e.threads.map(function(t){var n=[];return t.BriefSchedule&&t.BriefSchedule.Frequencies.length>0&&n.push.apply(n,t.BriefSchedule.Frequencies.map(function(n){var o;return Object(r.a)(Object(r.a)({},e),{},{threads:[Object(r.a)(Object(r.a)({},t),{},{BriefSchedule:{Frequencies:[n],Events:[],departureTime:null===(o=t.BriefSchedule)||void 0===o?void 0:o.departureTime}})]})})),t.BriefSchedule&&t.BriefSchedule.Events.length>0&&n.push.apply(n,t.BriefSchedule.Events.map(function(n){var o;return Object(r.a)(Object(r.a)({},e),{},{threads:[Object(r.a)(Object(r.a)({},t),{},{BriefSchedule:{Frequencies:[],Events:[n],departureTime:null===(o=t.BriefSchedule)||void 0===o?void 0:o.departureTime}})]})})),0===n.length&&n.push(Object(r.a)(Object(r.a)({},e),{},{threads:[Object(r.a)({},t)]})),n}))}))}}(e);return t.transports=t.transports.filter(function(e){return Ip(e,t.currentTime)>0}).sort(function(e,n){return Ip(e,t.currentTime)-Ip(n,t.currentTime)}),t})},getVehiclesInfo:function(e,t){return Object(R.a)("masstransit/getVehiclesInfoWithRegion",{query:Object(r.a)({locale:t.locale,lang:t.lang},e)},t)},getVehiclePredictionInfo:function(e,t){return Object(R.a)("masstransit/getVehiclePredictionInfo",{query:Object(r.a)({},e)},t)},getLine:function(e,t){return Object(R.a)("masstransit/getLine",{query:Object(r.a)({locale:t.locale,lang:t.lang},e)},t)},getDistance:function(e,t){return Object(R.a)("masstransit/distance",{query:{startPoint:e.coordinates.join(","),destinationPoints:e.stops.map(function(e){return e.coordinates.join(",")}),locale:t.locale}},t)}};function xp(e,t){var n=e.feature,o=n.properties,i=n.properties.uri;return function(e,t){return Mp.getStopInfo(e,t).then(function(t){return Object(r.a)(Object(r.a)({},t),{},{coordinates:e.hotspotCoordinates||t.coordinates})})}({id:X.c(i),uri:i,hotspotProperties:o,hotspotCoordinates:e.coordinates,clearLine:!0},t).then(function(e){return{type:"masstransit-stop",data:{stop:e,coordinates:e.coordinates}}})}var Pp=function(e){var t=Object(I.c)(),n=e.poiData,r=e.updateContent;return i.useEffect(function(){var e;if(n){p.a.cancel(e);var o=X.h(n.feature.properties.uri)?xp(n,t):function(e,t){var n,r,o=e.feature,i=o.properties,a=o.properties.uri,s={clientId:null===(n=t.mapWidget)||void 0===n?void 0:n.clientId,origin:null===(r=t.mapWidget)||void 0===r?void 0:r.origin,from:"poi",coordinates:e.coordinates,hotspotProperties:i,uri:a};return rt.a.fetchSearchResult(s,t).then(function(t){var n=null==t?void 0:t.items[0];return n?{type:"search",data:{result:n,coordinates:e.coordinates}}:null})}(n,t);e=p.a.create(o,{success:function(e){e&&r(e)}})}return function(){p.a.cancel(e)}},[n,r,t]),null},Np=1e3,zp=15e3;var Lp={getSummary:function(e,t){return Object(R.a)("router/getSummary",{query:Object(r.a)(Object(r.a)({},e),{},{lang:t.lang,locale:t.locale})},t)},optimizeRoutePoints:function(e,t){return Object(R.a)("router/optimize/add",{query:Object(r.a)(Object(r.a)({},e),{},{lang:t.locale})},t).then(function(e){var n;return e?h.b(null!==(n=e.delay)&&void 0!==n?n:Np).then(function(){return function e(t,n,r){return void 0===r&&(r=0),Object(R.a)("router/optimize/get",{query:t},n).then(function(o){var i;if(r>=zp||!o||"failed"===o.status)return null;if("completed"===o.status)return o.points;var a=null!==(i=o.delay)&&void 0!==i?i:Np;return h.b(a).then(function(){return e(t,n,r+a)})})}({id:e.id},t)}):null})},buildRoute:function(e,t){return Object(R.a)("router/buildRoute",{query:Object(r.a)(Object(r.a)({},e),{},{locale:t.locale,lang:t.lang})},t)},pollIntercityPrice:function(e,t){return Object(R.a)("router/poll-intercity-price",{query:e},t)}},Dp=100,Ap=function(e){function t(t){var n;return(n=e.call(this,t)||this)._buildRouteAction=void 0,n._buildRouteDebounced=void 0,n._buildRoute=function(){var e=n.props,t=s.g(e.config,{travelMode:Si(e.config),routerResponse:null,routePoints:e.routePoints,activeRouteIndex:-1,viaIndexes:[],settings:{auto:{ignoreTrafficJams:wi(e.config),avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}}},{});p.a.cancel(n._buildRouteAction),n._buildRouteAction=p.a.create(Lp.buildRoute(t,e.config),{success:function(t){if(t){var n=s.d(t);e.onLoad(n)}},fail:function(){e.onLoad(null)}})},n._buildRouteDebounced=Object(Ht.a)(n._buildRoute,Dp),n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){e.routePoints!==this.props.routePoints&&this._buildRouteDebounced()},n.componentWillUnmount=function(){p.a.cancel(this._buildRouteAction)},n.render=function(){return null},t}(i.Component),Up=Object(I.b)(Ap);var Fp=function(e,t){var n,r=(n=Object(i.useRef)(!0)).current?(n.current=!1,!0):n.current;Object(i.useEffect)(function(){if(!r)return e()},t)},qp=(n(435),n(437),Object(ut.a)("map-widget-search-result-list-item")),Bp=function(e){var t;Object(I.c)();return i.createElement("div",{className:qp(),onClick:function(){e.onClick(e.item)}},"toponym"===e.item.type?(t=e.item,i.createElement(Vl,{title:t.title,subtitle:t.description})):function(t){var n,o=wl(t);return i.createElement(i.Fragment,null,i.createElement(Vl,{title:e.item.title,subtitle:null===(n=t.categories)||void 0===n?void 0:n.slice(0,2).map(function(e){return e.name}).join(", ")}),i.createElement("div",{className:qp("data")},i.createElement(dl,{result:t,disableLink:!0}),i.createElement("div",{className:qp("time-label",Object(r.a)({},o.state))},o.text)))}(e.item))};function Hp(e,t){var n=t[0],r=t[1];return e.reduce(function(e,t){return"string"!=typeof t?e.push(t):t.split(n).forEach(function(t,n){n>0&&e.push(r),e.push(t)}),e},[])}var Wp=function(e,t){return Object.entries(t).reduce(Hp,[e]).filter(function(e){return e}).map(function(e,t){return i.createElement("span",{key:t},e)})},Gp=Object(ut.a)("map-widget-search-result-list-view"),Yp={main:-4,side:4},Vp={top:10,right:10},Zp=460,Kp=function(e){var t,n,r,o,a=Object(I.c)(),s=(null!==(t=null===(n=e.searchResults)||void 0===n?void 0:n.totalResultCount)&&void 0!==t?t:0)-(null!==(r=null===(o=e.searchResults)||void 0===o?void 0:o.items.length)&&void 0!==r?r:0),u=i.useMemo(function(){return e.mapSize.width<=Zp?"fullscreen":"balloon"},[e.mapSize]),l=function(t){var n,r,o,u,l,d=(a.query["display-text"]||a.query.text||"").toString(),p=e.searchResults;return(null===(n=p.chain)||void 0===n?void 0:n.name)&&(d=p.chain.name),i.createElement(i.Fragment,null,d?i.createElement("div",{className:Gp("header")},(function(params){return "Результаты поиска «"+params.query+"»";})({query:d})):null,i.createElement("div",{style:{maxHeight:t-30}},i.createElement(li,{width:"dynamic"},e.searchResults?i.createElement("div",null,e.searchResults.items.map(function(t){return i.createElement(Bp,{item:t,key:t.id,onClick:e.onListItemClick})})):null,e.isLoading?i.createElement("div",{className:Gp("spinner-container")},i.createElement($n,{view:"small"})):e.searchResults&&s>0?i.createElement("div",{className:Gp("more"),onClick:e.onLoadMoreClick},(function(params){return "Показать ещё "+params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "результат" :(params.count % 10 > 1 && params.count % 10 < 5 && (params.count % 100 < 10 || params.count % 100 > 20) ? "результата" : "результатов"));})({count:Math.min(e.searchResults.requestResults,s)})):null,i.createElement("div",{className:Gp("footer")},i.createElement("div",{className:Gp("icon")},i.createElement(bt.a,{name:"super-search",size:24,inline:!0})),i.createElement("span",{className:Gp("caption")},Wp((function(params){return "Не нашли, что искали, — измените масштаб или "+params.refineSearch;})({refineSearch:"__refineSearch"}),{__refineSearch:(u=c.c(e.mapLocation,a.query.text,a.query.chain,null===(r=a.searchPreloadedResults)||void 0===r?void 0:null===(o=r.chain)||void 0===o?void 0:o.name),l=c.a("/?"+u,a),i.createElement("a",{className:Gp("link"),href:l,target:"_blank"},"уточните запрос"))}))))))};return"fullscreen"===u?i.createElement(An.a,null,i.createElement("div",{className:Gp("fullscreen-container")},i.createElement(pi,{offset:Vp,onClick:e.onListClose}),l(e.mapSize.height-10))):i.createElement(Qr.a,{isShown:!0,getTarget:function(){var t;return(null===(t=e.targetRef)||void 0===t?void 0:t.current)||null},onClose:e.onListClose,type:"normal",position:["bottom-left"],offset:Yp},i.createElement("div",{className:Gp("balloon-container")},l(e.mapSize.height-110)))},Xp=(n(439),Object(ut.a)("map-widget-search-control-view")),$p=Object(Wc.a)(function(e){return i.createElement("div",{className:Xp({checked:e.checked}),ref:e.forwardedRef},i.createElement(Kn.a,{size:"small",view:"air-alt",checked:e.checked,icon:i.createElement(bt.a,{name:"search",size:24,inline:!0,className:Xp("icon")}),onClick:e.onClick},(function(params){return params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "найден" :"найдено");})({count:e.resultsCount})))}),Jp=function(e){var t,n,r,o=i.useRef(null),a=i.useMemo(function(){return e.mapSize.width<295||e.mapSize.height<250},[e.mapSize]);return i.createElement(i.Fragment,null,(r=null!==(t=null===(n=e.searchResults)||void 0===n?void 0:n.totalResultCount)&&void 0!==t?t:0,a?null:i.createElement($p,{resultsCount:r,checked:e.isResultsListShown,ref:o,onClick:e.onControlClick})),!a&&e.isResultsListShown&&e.searchResults?i.createElement(Kp,{searchResults:e.searchResults,mapSize:e.mapSize,isLoading:e.isLoading,targetRef:o,mapLocation:e.mapLocation,onListItemClick:e.onResultClick,onListClose:e.onListClose,onLoadMoreClick:e.onLoadMoreClick}):null)},Qp={advert:void 0,brandingId:void 0},ef=function(e){var t,n=1===e.results.items.length?e.results.items[0]:void 0,o=e.results.exactResult||n;return i.createElement(i.Fragment,null,o&&!(null===(t=e.hiddenResults)||void 0===t?void 0:t.find(function(e){return e.id===o.id}))?i.createElement(i.Fragment,null,i.createElement(Qd,{key:o.id,result:Object(r.a)(Object(r.a)({},o),Qp),coordinates:o.coordinates,mode:"subtitle",onClick:e.onPlacemarkClick}),o.uri?i.createElement(pa,{uri:o.uri}):null):null,e.results.items.filter(function(t){var n;return t.id!==(null==o?void 0:o.id)&&!(null===(n=e.hiddenResults)||void 0===n?void 0:n.find(function(e){return e.id===t.id}))}).map(function(t){var n=Object(r.a)(Object(r.a)({},t),Qp);return i.createElement(Qd,{key:t.id,result:n,coordinates:n.coordinates,mode:"base",onClick:e.onPlacemarkClick})}))},tf=function(e){var t=Object(I.c)(),n=ql(function(n,o){var i,a,s,c,u,l="search"===(null===(i=e.content)||void 0===i?void 0:i.type)?e.content.data.result.id:void 0,d=null==o?void 0:o.items.find(function(e){return e.id===l}),p=null!==(a=null==o?void 0:o.requestResults)&&void 0!==a?a:10,f=e.mapLocation,m={text:t.query.chain?"chain_id:("+t.query.chain+")":t.query.text,clientId:null===(s=t.mapWidget)||void 0===s?void 0:s.clientId,origin:null===(c=t.mapWidget)||void 0===c?void 0:c.origin,center:f.center,span:f.span,bounds:f.bounds,zoom:f.zoom,count:null==o?void 0:o.requestResults,type:["biz","geo"],context:null==o?void 0:o.requestContext,skip:n?Math.floor((null!==(u=null==o?void 0:o.items.length)&&void 0!==u?u:0)/p)*p:void 0};return rt.a.fetch(m,t).then(function(e){var t=e.items;return!d||t.find(function(e){return e.id===d.id})||n&&(null==o?void 0:o.items.find(function(e){return e.id===d.id}))||t.push(d),Object(r.a)(Object(r.a)({},e),{},{items:n&&o?[].concat(o.items,t):t})}).catch(function(){return o})},[e.mapLocation,t],{value:t.searchPreloadedResults,loading:!1}),o=n[0],a=n[1],s=Boolean(o.value);Fp(function(){s&&a(!1,o.value)},[e.mapLocation,t]);var c,u=function(){a(!0,o.value)},l=function(){var t;e.setListContent("search-list"===(null===(t=e.content)||void 0===t?void 0:t.type)?null:{type:"search-list"})},d=function(){e.setListContent(null)},p=i.useMemo(function(){var n,r,o,i,a;return["search"===(null===(n=e.content)||void 0===n?void 0:n.type)?e.content.data.result:void 0,null===(r=t.mapWidget)||void 0===r?void 0:null===(o=r.activeObject)||void 0===o?void 0:o.items[0],null===(i=t.poiPreloadedResults)||void 0===i?void 0:i.items[0],null===(a=t.whatsherePreloadedResults)||void 0===a?void 0:a.items[0]].filter(function(e){return Boolean(e)})},[e.content,t]);return i.createElement(i.Fragment,null,o.value?i.createElement(Jp,{searchResults:o.value,mapSize:e.mapSize,isLoading:o.loading,mapLocation:e.mapLocation,isResultsListShown:"search-list"===(null===(c=e.content)||void 0===c?void 0:c.type),onResultClick:e.onResultClick,onLoadMoreClick:u,onControlClick:l,onListClose:d}):null,o.value?i.createElement(ef,{hiddenResults:p,results:o.value,onPlacemarkClick:e.onResultClick}):null)},nf=n(191),rf=n(467);function of(e){return e.isPoiEnabled&&Boolean(e.content&&["masstransit-stop","search"].includes(e.content.type))}function af(e){return{params:{ll:Object(Hn.a)(e.map.location.center),z:Math.round(100*e.map.location.zoom)/100}}}function sf(e){var t;return e.isPoiEnabled&&"masstransit-stop"===(null===(t=e.content)||void 0===t?void 0:t.type)?{params:{masstransit:{stopId:e.content.data.stop.id},mode:"stop"}}:{}}function cf(e,t){var n,r,o,i,a=null===(n=t.mapWidget)||void 0===n?void 0:null===(r=n.activeObject)||void 0===r?void 0:r.items[0];if(e.isPoiEnabled&&"search"===(null===(o=e.content)||void 0===o?void 0:o.type)){var s=e.content.data.result,c={};return"business"!==s.type||e.routes.routerResponse||t.searchPreloadedResults?c.poi={uri:s.uri,point:s.coordinates}:c.orgpage={id:s.id},{params:c}}return!of(e)&&a&&"search"===(null===(i=t.mapWidget)||void 0===i?void 0:i.activeMode)?{params:{poi:{uri:a.uri,point:a.coordinates}}}:{}}function uf(e,t){var n,r,o,i;return"search"===(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)?{params:{text:null===(r=t.searchPreloadedResults)||void 0===r?void 0:r.requestQuery,"display-text":null===(o=t.searchPreloadedResults)||void 0===o?void 0:null===(i=o.chain)||void 0===i?void 0:i.name}}:{}}function lf(e,t){var n=gf(e,t);if(n)return{textContent:"Как добраться",params:Object(r.a)(Object(r.a)({},s.r({routerResponse:null,travelMode:Si(t),detailedIndex:-1,activeRouteIndex:0,viaIndexes:[],routePoints:[s.l(),n]},t)),{},{mode:"routes"})};if(e.routes.routePoints.length>0){var o,i,a,c,u=s.r({routerResponse:null,travelMode:Si(t),detailedIndex:-1,activeRouteIndex:e.routes.activeRouteIndex,viaIndexes:(null===(o=e.routes.routerResponse)||void 0===o?void 0:o.viaIndexes)||[],routePoints:e.routes.routePoints},t),l=Object(r.a)(Object(r.a)({},u),{},{rtm:t.query.rtm,mode:"routes"!==(null===(i=t.mapWidget)||void 0===i?void 0:i.activeMode)||of(e)?void 0:"routes"}),d=null===(a=e.routes.routerResponse)||void 0===a?void 0:a.routes[e.routes.activeRouteIndex];return{params:l,textContent:of(e)||t.searchPreloadedResults&&"routes"!==(null===(c=t.mapWidget)||void 0===c?void 0:c.activeMode)||null==d||!d.bounds||!Object(rf.a)(e.map.location.bounds,d.bounds)?void 0:"Открыть маршрут"}}return{}}function df(e,t){return{params:{rl:e.ruler.points.slice(0,t.ruler.maxCount).map(function(e,t,n){var r=e.coordinates,o=n[t-1]&&n[t-1].coordinates,i=0===t?r:[r[0]-o[0],r[1]-o[1]];return Object(Hn.a)(i)}).join("~")||null}}}function pf(e,t){return{layers:{trf:e.traffic.isActive,trfe:e.traffic.isActive&&Ei(t)}}}function ff(e,t){var n=t.userMap;return n?{params:{um:n.id}}:{}}function mf(e,t){var n,r,o,i,a,s,c,u,l,d=gf(e,t),p=e.content&&"data"in e.content&&e.content.data.coordinates,f=of(e)||"search"!==(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)?null===(r=t.mapWidget)||void 0===r?void 0:null===(o=r.activeObject)||void 0===o?void 0:null===(i=o.items[0])||void 0===i?void 0:i.coordinates:void 0,m=null===(a=t.poiPreloadedResults)||void 0===a?void 0:null===(s=a.items[0])||void 0===s?void 0:s.coordinates,v=null===(c=t.whatsherePreloadedResults)||void 0===c?void 0:null===(u=c.items[0])||void 0===u?void 0:u.coordinates,g=null===(l=t.masstransitStop)||void 0===l?void 0:l.coordinates,h=[].concat((e.placemarks||[]).map(function(e){return e.coordinates}),[f,m,v,g]).filter(function(e){return Boolean(e&&(!(null==d?void 0:d.coords)||!Object(vt.a)(null==d?void 0:d.coords,e))&&(!p||!Object(vt.a)(p,e)))});return{params:{pt:h.length>0?h.map(function(e){return Object(Hn.a)(e)}).join("~"):void 0}}}function vf(){return{params:{source:"mapframe",utm_source:"mapframe",from:"mapframe"}}}function gf(e,t){var n;if("search"!==(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)&&!of(e)){var r=[];return t.poiPreloadedResults&&t.poiPreloadedResults.items.length>0&&r.push({coords:t.poiPreloadedResults.items[0].coordinates,value:t.poiPreloadedResults.items[0].title}),t.whatsherePreloadedResults&&t.whatsherePreloadedResults.items.length>0&&r.push({coords:t.whatsherePreloadedResults.items[0].coordinates,value:t.whatsherePreloadedResults.items[0].title}),t.masstransitStop&&r.push({coords:t.masstransitStop.coordinates,value:t.masstransitStop.name}),r.find(function(t){return Object(Go.a)(e.map.location.bounds,t.coords)})}}var hf=function(e){var t=Object(I.c)(),n=function(e,t){var n=[af,sf,cf,uf,lf,df,pf,ff,mf,vf].reduce(function(n,o){var i=o(e,t);return{textContent:n.textContent||i.textContent,params:Object(r.a)(Object(r.a)({},n.params||{}),i.params||{}),layers:Object(r.a)(Object(r.a)({},n.layers||{}),i.layers||{})}},{}),o=n.params,i=void 0===o?{}:o,a=n.layers,s=void 0===a?{}:a,u=n.textContent;i.l=Object.entries(s).reduce(function(e,t){var n=t[0],r=t[1];return[].concat(e.filter(function(e){return e!==n}),r?[n]:[])},[]).join(",")||null;var l=Object.entries(i).reduce(function(e,t){var n=t[0],r=t[1];return null!==r&&(e[n]=r),e},{});return{url:c.k(t.hosts.maps,l),textContent:u}}(e.state,t),o=n.url,a=n.textContent,s=i.createElement(nf.a,{url:o},function(){switch(e.size){case"tiny":return null;case"small":return "Открыть в Картах";case"medium":return a||"Открыть в Яндекс.Картах"}return null}());return"tiny"===e.size?i.createElement(Xn.a,{text:"Открыть в Яндекс.Картах",position:"right",isAir:!0},s):s},bf=16,yf=1e3,_f=1e3,Ef=1500,wf=200,Sf=295,Of=400,Cf=[50,70,72,50],kf={passive:!1},jf=function(e){function t(t){var n,o,l;(l=e.call(this,t)||this)._getLocationAction=void 0,l._asyncRoadEventAction=void 0,l._getRoutePointAction=void 0,l._getInitialContent=function(){var e,t,n,r,o=l.props,i=null===(e=o.config.mapWidget)||void 0===e?void 0:e.activeMode,a=null===(t=l.props.config.poiPreloadedResults)||void 0===t?void 0:t.items[0];if("routes"===i&&l.props.config.routerResponse)return{type:"route",data:{}};if("poi"===i&&a){return{type:"search",data:{result:a,coordinates:a.coordinates}}}if("stop"===i&&o.config.masstransitStop)return{type:"masstransit-stop",data:{stop:o.config.masstransitStop,coordinates:o.config.masstransitStop.coordinates}};if("whatshere"===i&&(null===(n=l.props.config.whatsherePreloadedResults)||void 0===n?void 0:n.items[0])){var s=l.props.config.whatsherePreloadedResults.items[0];return{type:"search",data:{result:s,coordinates:s.coordinates}}}if("search"===i&&(l.props.config.searchPreloadedResults||(null===(r=l.props.config.mapWidget)||void 0===r?void 0:r.activeObject))){var c,u,d,p,f=null===(c=l.props.config.mapWidget)||void 0===c?void 0:null===(u=c.activeObject)||void 0===u?void 0:u.items[0],m=1===(null===(d=l.props.config.searchPreloadedResults)||void 0===d?void 0:d.items.length)?l.props.config.searchPreloadedResults.items[0]:void 0,v=f||(null===(p=l.props.config.searchPreloadedResults)||void 0===p?void 0:p.exactResult)||m;if("business"===(null==v?void 0:v.type)||"toponym"===(null==v?void 0:v.type))return{type:"search",data:{result:v,coordinates:v.coordinates}};if(!v&&o.mapSize.width>Zp)return{type:"search-list"}}return null},l._onRouterResponseLoad=function(e){l._deepSetState({routes:{routerResponse:e,activeRouteIndex:0}}),l._updateContentData({type:"route",data:{}})},l._getIsPoiEnabled=function(e,t){return e>=Sf&&t>=Of},l._deepSetState=function(e,t){l.setState(Object(f.a)(l.state,e),t)},l._onGeolocationControlClick=function(){l._makeGeolocationRequest()},l._makeGeolocationRequest=function(){var e=l.props.config;l.setState({geolocation:{isStarted:!0}}),l._getLocationAction=p.a.create(k.getCurrentPosition(Object(m.b)(e),e,Ef),{success:l._onGeolocationSuccess,fail:l._onGeolocationFail})},l._onGeolocationSuccess=function(e){l._updateLocationRequest({center:[e.longitude,e.latitude],duration:yf,zoom:e.accuracy<=wf?bf:void 0}),l._deepSetState({geolocation:{isStarted:!1,accuracy:e.accuracy,currentPosition:[e.longitude,e.latitude]}})},l._onGeolocationFail=function(){var e;(null===(e=l.props.config.mapWidget)||void 0===e?void 0:e.userCoordinates)&&(l._updateLocationRequest({center:l.props.config.mapWidget.userCoordinates,duration:yf}),l._deepSetState({geolocation:{isStarted:!1,currentPosition:l.props.config.mapWidget.userCoordinates,accuracy:_f}}))},l._updateLocation=function(e){l._deepSetState({map:{location:e}})},l._updateLocationRequest=function(e){l.setState({map:Object(r.a)(Object(r.a)({},l.state.map),{},{locationRequest:e})})},l._onRoutesBoundsChange=function(e){var t=a.b({bounds:e},Cf,l.state.map.size);l._updateLocationRequest(t)},l._updateRuler=function(e){l._deepSetState({ruler:e})},l._onTrafficLevelChange=function(e){l._deepSetState({traffic:{level:e}})},l._onTrafficControlClick=function(){var e=l._getContentData("traffic");l._deepSetState({traffic:{isActive:!l.state.traffic.isActive},content:e?void 0:l.state.content})},l._setMapSize=function(e){l._deepSetState({map:{size:e}})},l._updateContentData=function(e){l.setState({content:e})},l._processMapObjectClick=function(e,t){var n=l._getEmptyRoutePointIndex();-1!==n?l._updateRoutePoint(e,n):t()},l._onTrafficEventClick=function(e){var t,n,r,o=l.props;if(Boolean(null===(t=o.config.query.l)||void 0===t?void 0:t.includes("trfe"))||Boolean(null===(n=o.config.userMap)||void 0===n?void 0:n.isTrafficShown)){var i=e.properties,a=i.HotspotMetaData,s=i.vectorMetadata,c=(null==s?void 0:s.get("objectId"))||(null==a?void 0:a.id);if(c){var u=null===(r=e.geometry)||void 0===r?void 0:r.coordinates;if(u&&2===u.length){var d={coords:u,value:""};l._processMapObjectClick(d,function(){p.a.cancel(l._asyncRoadEventAction),l._asyncRoadEventAction=p.a.create(T.getRoadEvent(c,o.config),{success:function(e){e&&e.position&&l._updateContentData({type:"traffic",data:{event:e,coordinates:e.position}})},fail:function(){return l._resetContentData()}})})}}}},l._onRouteClick=function(e,t){var n;l._updateContentData({type:"route",data:{coordinates:t}});var r=((null===(n=l.state.routes.routerResponse)||void 0===n?void 0:n.routes)||[]).indexOf(e);l._deepSetState({routes:{activeRouteIndex:-1!==r?r:0}})},l._onUserMapsFeatureClick=function(e,t){var n={coords:t,value:""};l._processMapObjectClick(n,function(){var n,r=null===(n=l.props.config.userMap)||void 0===n?void 0:n.features[e];r&&l._updateContentData({type:"user-maps",data:{feature:r,coordinates:t}})})},l._onPlacemarkClick=function(e){var t={coords:e.coordinates,value:e.title,uri:e.uri};l._processMapObjectClick(t,function(){if(l.state.isPoiEnabled)l._updateContentData({type:"search",data:{result:e,coordinates:e.coordinates}});else{var t="business"===e.type?c.b({id:e.id,seoname:e.seoname},{},{baseUrl:""}):c.g(e,e.region,{baseUrl:"",skipPointCheck:!0});if(t){var n=Object(u.a)(c.a("/"+t,l.props.config));window.open(n,"_blank")}}})},l._onMasstransitPlacemarkClick=function(e){var t,n={coords:e.coordinates,value:e.name,uri:null===(t=e.searchResult)||void 0===t?void 0:t.uri};l._processMapObjectClick(n,function(){if(l.state.isPoiEnabled)l._updateContentData({type:"masstransit-stop",data:{stop:e,coordinates:e.coordinates}});else{var t=e.region?c.d(e,e.region,{baseUrl:""}):"";if(t){var n=Object(u.a)(c.a("/"+t,l.props.config));window.open(n,"_blank")}}})},l._resetContentData=function(){l._deepSetState({content:null})},l._updateRoutePointDragging=function(e){var t;l._deepSetState({routes:{isPointDragging:e},content:"route"===(null===(t=l.state.content)||void 0===t?void 0:t.type)?null:l.state.content})},l._updateRoutePoint=function(e,t){if(l.state.routes.isPointDragging){var n=[].concat(l.state.routes.routePoints);n[t]=e,l._deepSetState({routes:{routePoints:n}})}else l._getRoutePointAction=p.a.create(it(e,l.props.config,"router"),{success:function(n){e.value=(null==n?void 0:n.title)||"",e.input=(null==n?void 0:n.title)||"",e.searchResult=n;var r=[].concat(l.state.routes.routePoints);r[t]=e,l._deepSetState({routes:{routePoints:r}})},fail:function(){var n=[].concat(l.state.routes.routePoints);n[t]=e,l._deepSetState({routes:{routePoints:n}})}})},l._getEmptyRoutePointIndex=function(){return l.state.routes.routePoints.findIndex(function(e){return!e.coords})},l._getRoutePointsDraggableIndexes=function(){var e;return(null===(e=l.props.config.routePoints)||void 0===e?void 0:e.reduce(function(e,t,n){return t.coords||e.push(n),e},[]))||[]},l._onPoiClick=function(e,t){var n=e.properties.uri,r=e.geometry&&e.geometry.coordinates||t.coordinates;l._processMapObjectClick({coords:r,value:e.properties.name||"",uri:n},function(){l.setState({poiData:{coordinates:r,feature:e}})})},l._getCursor=function(){var e=l._getEmptyRoutePointIndex();if(-1!==e&&!l.state.ruler.isEnabled)return s.m(e,l.state.routes.routePoints)+"_"+e},l._getContentData=function(e){var t;if((null===(t=l.state.content)||void 0===t?void 0:t.type)===e)return l.state.content},l._preventZoomByPinching=function(e){"scale"in e&&1!==e.scale&&e.touches.length>1&&e.preventDefault()},l._renderInMapsControl=function(e){return i.createElement(hf,{state:l.state,size:e})},l._renderGeolocationPin=function(){return l.state.geolocation.currentPosition&&l.state.geolocation.accuracy?i.createElement(wt,{currentPosition:l.state.geolocation.currentPosition,accuracy:l.state.geolocation.accuracy}):null},l._renderTrafficLayer=function(){return l.state.traffic.isActive?i.createElement(ji,{mapLocation:l.state.map.location,mapSize:l.state.map.size,updateLocationRequest:l._updateLocationRequest,onActualEventClick:l._onTrafficEventClick,onTrafficLevelChange:l._onTrafficLevelChange,resetContentData:l._resetContentData,content:l._getContentData("traffic")}):null},l._renderUserMaps=function(){return l.props.config.userMap?i.createElement(Mu,{userMap:l.props.config.userMap,mapLocation:l.state.map.location,mapSize:l.state.map.size,updateLocationRequest:l._updateLocationRequest,onFeatureClick:l._onUserMapsFeatureClick,cursor:l._getCursor(),resetContentData:l._resetContentData,content:l._getContentData("user-maps")}):null},l._renderSearchResult=function(){return i.createElement(rp,{mapSize:l.state.map.size,mapLocation:l.state.map.location,isTrafficLayerEnabled:l.state.traffic.isActive,updateLocationRequest:l._updateLocationRequest,content:l.state.isPoiEnabled?l._getContentData("search"):void 0,onContentClose:l._resetContentData,onStaticPlacemarkClick:l._onPlacemarkClick})},l._renderSearchComponentWithControl=function(){return i.createElement(tf,{mapLocation:l.state.map.location,mapSize:l.state.map.size,content:l._getContentData("search")||l._getContentData("search-list"),onResultClick:l._onPlacemarkClick,setListContent:l._updateContentData})};var v=a.b(l.props.config.mapLocation,Cf,{width:t.mapSize.width,height:t.mapSize.height}),g=l._getIsPoiEnabled(t.mapSize.width,t.mapSize.height);return l.state={placemarks:t.config.query.pt?d(t.config.query.pt):void 0,map:{location:v,size:t.mapSize},geolocation:{isStarted:!1},ruler:$e(t.config),traffic:{isActive:(null===(n=t.config.query.l)||void 0===n?void 0:n.includes("trf"))||(null===(o=t.config.userMap)||void 0===o?void 0:o.isTrafficShown),level:null},routes:{activeRouteIndex:Number(t.config.query.rtn)||0,routerResponse:t.config.routerResponse?s.d(t.config.routerResponse):null,routePoints:t.config.routePoints||[],isPointDragging:!1},content:l._getInitialContent(),isPoiEnabled:g},l}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.document.body.classList.add("_app_ready"),document.addEventListener("touchmove",this._preventZoomByPinching,kf)},n.componentDidUpdate=function(e,t){if(t.map.size!==this.state.map.size){var n=this._getIsPoiEnabled(this.state.map.size.width,this.state.map.size.height);this._deepSetState({isPoiEnabled:n})}},n.componentWillUnmount=function(){p.a.cancel(this._getLocationAction),p.a.cancel(this._getRoutePointAction)},n.render=function(){var e=this.state;return i.createElement(Ln,{location:e.map.location,locationRequest:e.map.locationRequest,margin:Cf,onLocationChange:this._updateLocation,onSizeChange:this._setMapSize,isPoiEnabled:this.state.isPoiEnabled,onPoiClick:this._onPoiClick},i.createElement(Kr,{geolocation:{isStarted:e.geolocation.isStarted,onClick:this._onGeolocationControlClick},location:e.map.location,ruler:{isEnabled:e.ruler.isEnabled,updateRuler:this._updateRuler},traffic:{isActive:e.traffic.isActive,level:e.traffic.level,onClick:this._onTrafficControlClick},search:{render:this._renderSearchComponentWithControl},inMaps:{render:this._renderInMapsControl}}),this._renderUserMaps(),this._renderGeolocationPin(),i.createElement(jo,{ruler:e.ruler,updateRuler:this._updateRuler}),this._renderTrafficLayer(),i.createElement(Pt,{points:e.placemarks}),i.createElement(Eu,{routerResponse:e.routes.routerResponse,activeRouteIndex:e.routes.activeRouteIndex,routePoints:e.routes.routePoints,mapLocation:e.map.location,mapSize:e.map.size,emptyPointIndex:this._getEmptyRoutePointIndex(),isTrafficLayerEnabled:e.traffic.isActive,isRoutePointDragging:e.routes.isPointDragging,cursor:this._getCursor(),setDragging:this._updateRoutePointDragging,draggablePointIndexes:this._getRoutePointsDraggableIndexes(),updateRoutePoint:this._updateRoutePoint,onRouteClick:this._onRouteClick,onBoundsChange:this._onRoutesBoundsChange,resetContentData:this._resetContentData,content:this._getContentData("route")}),i.createElement(Up,{routePoints:e.routes.routePoints,onLoad:this._onRouterResponseLoad}),this._renderSearchResult(),i.createElement(Ep,{content:e.isPoiEnabled?this._getContentData("masstransit-stop"):void 0,mapSize:e.map.size,mapLocation:e.map.location,updateLocationRequest:this._updateLocationRequest,onContentClose:this._resetContentData,onStaticPlacemarkClick:this._onMasstransitPlacemarkClick}),i.createElement(Pp,{poiData:e.poiData,updateContent:this._updateContentData}))},t}(i.Component);t.default=Object(I.b)(jf)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(107);function o(e,t){return Object(r.a)(e,t).distance}},function(e,t,n){"use strict";var r=n(241),o=n(44),i="Expected a function";t.a=function(e,t,n){var a=!0,s=!0;if("function"!=typeof e)throw new TypeError(i);return Object(o.a)(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),Object(r.a)(e,t,{leading:a,maxWait:t,trailing:s})}},function(e,t,n){"use strict";var r=n(46),o=n(205);t.a=function(e){return Object(o.a)(Object(r.a)(e).toLowerCase())}},,,,,,,function(e,t,n){var r=n(224),o=n(225),i=r(),a=[1|i[0],i[1],i[2],i[3],i[4],i[5]],s=16383&(i[6]<<8|i[7]),c=0,u=0;e.exports=function(e,t,n){var r=t&&n||0,i=t||[],l=void 0!==(e=e||{}).clockseq?e.clockseq:s,d=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:u+1,f=d-c+(p-u)/1e4;if(f<0&&void 0===e.clockseq&&(l=l+1&16383),(f<0||d>c)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=d,u=p,s=l;var m=(1e4*(268435455&(d+=122192928e5))+p)%4294967296;i[r++]=m>>>24&255,i[r++]=m>>>16&255,i[r++]=m>>>8&255,i[r++]=255&m;var v=d/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=255&v,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=l>>>8|128,i[r++]=255&l;for(var g=e.node||a,h=0;h<6;++h)i[r+h]=g[h];return t||o(i)}},function(e,t,n){var r=n(224),o=n(225);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/ebe60c9063e4a91162d1366e790ea391.svg"},function(e,t,n){e.exports=n.p+"_/fd161c881e6392111418a1036fe1188e.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t){},function(e,t,n){},,function(e,t,n){},,function(e,t){},function(e,t,n){},,function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.56 14.363L14.363 3.56a1.91 1.91 0 0 1 2.7 0l3.377 3.376a1.91 1.91 0 0 1 0 2.7L9.636 20.442a1.91 1.91 0 0 1-2.7 0l-3.377-3.377a1.91 1.91 0 0 1 0-2.7zm4.12-.743l1.282-1.282 1.823 1.824a.764.764 0 1 0 1.08-1.082l-1.824-1.822 1.216-1.215 1.148 1.145a.763.763 0 0 0 1.318-.534.765.765 0 0 0-.237-.545l-1.148-1.147 1.282-1.283 1.824 1.824a.764.764 0 0 0 1.08-1.082l-1.825-1.824 1.014-1.012a.478.478 0 1 0-.676-.675L4.91 15.038a.478.478 0 0 0 .675.675l1.012-1.012 1.15 1.146a.764.764 0 1 0 1.08-1.079L7.679 13.62v.001z" fill="currentColor"/></svg>'},function(e,t,n){},,function(e,t){},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/ac5e1b536924f7e8a301d831df70844a.svg"},function(e,t,n){e.exports=n.p+"_/6af0c0ad591e18333f25c83b7e2e0279.svg"},function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/220b7368693f1dd6ea9cc18efe67c389.svg"},function(e,t,n){},,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/88dd6621d29f63b3bcd11823a075bab8.svg"},function(e,t,n){e.exports=n.p+"_/982f21b161efbb26f879ac8dcf5bc613.svg"},function(e,t,n){e.exports=n.p+"_/6dfdf3e1f699e358e2a45696b5910bfc.svg"},function(e,t,n){e.exports=n.p+"_/d7eede432ce185c2bcdea2a81dd73d60.svg"},function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/af445ec16173f0fa9a696ec6b9f6c7e1.svg"},function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/e3fc7b2ee2e8adff5a3cf54a228b18be.svg"},function(e,t,n){e.exports=n.p+"_/f869888cf7cada800b61fc42b9a84b32.svg"},function(e,t,n){e.exports=n.p+"_/dff25d38edaaaed43455e2838501c7d2.png"},function(e,t,n){e.exports=n.p+"_/7485047d3440076f2f17ebb52a011c9c.png"},function(e,t,n){e.exports=n.p+"_/9dae14af44a24ba50a1bf841f2d22144.png"},function(e,t,n){e.exports=n.p+"_/9c80a04cdee2564f1b348f2c942570e5.png"},function(e,t,n){e.exports=n.p+"_/db96e0b37fb683edb082b6d22cd47375.png"},function(e,t,n){e.exports=n.p+"_/9d7d9192162a766707427f0fdfad6e69.png"},function(e,t,n){e.exports=n.p+"_/30566ea95b3b85e11fdf731ad19d0cb6.png"},function(e,t,n){e.exports=n.p+"_/00dbdb577dd780ef99cebd89eabff5b0.png"},function(e,t,n){e.exports=n.p+"_/6b36feaa685efb371af0a08ebce07269.png"},function(e,t,n){e.exports=n.p+"_/74ca6ea4b76200fd171c44aa5a49f5a8.png"},function(e,t,n){e.exports=n.p+"_/af158d44913f89ba43eabd0e26e9dda3.png"},function(e,t,n){e.exports=n.p+"_/af158d44913f89ba43eabd0e26e9dda3.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},function(e,t,n){e.exports=n.p+"_/4107b60439ecfb91bb4f01454bb365e2.png"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/ab65d8cbf4996eb9048efd9031d9f38b.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/c8b65388cbb6b14a49041ce7df22cd1a.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/cbb4eab83cc1f046b092166074e47cb5.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="2ccc4e9f8fe2f8acc9e7eab53f797f56__b" d="M7 14A7 7 0 1 0 7 0a7 7 0 0 0 0 14z"/><filter id="2ccc4e9f8fe2f8acc9e7eab53f797f56__a" width="150%" height="150%" x="-25%" y="-17.9%" filterUnits="objectBoundingBox"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd" transform="translate(4 4)"><use fill="#000" filter="url(#2ccc4e9f8fe2f8acc9e7eab53f797f56__a)" xlink:href="#2ccc4e9f8fe2f8acc9e7eab53f797f56__b"/><use fill="#FFF" xlink:href="#2ccc4e9f8fe2f8acc9e7eab53f797f56__b"/><path d="M7 12A5 5 0 1 1 7 2a5 5 0 0 1 0 10z" fill="currentColor"/><path fill="#000" class="tint" d="M7 12A5 5 0 1 1 7 2a5 5 0 0 1 0 10z"/></g></svg>\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 34 34" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="cbb016882db5c851af06eebb43c674f7__b" d="M17 31c7.732 0 14-6.268 14-14S24.732 3 17 3 3 9.268 3 17s6.268 14 14 14z"/><filter id="cbb016882db5c851af06eebb43c674f7__a" width="200%" height="200%" x="-50%" y="-50%" filterUnits="objectBoundingBox"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.200000003 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd"><use fill="#000" filter="url(#cbb016882db5c851af06eebb43c674f7__a)" xlink:href="#cbb016882db5c851af06eebb43c674f7__b"/><use fill="#FFF" xlink:href="#cbb016882db5c851af06eebb43c674f7__b"/><path fill="currentColor" d="M17 29c-6.627 0-12-5.373-12-12S10.373 5 17 5s12 5.373 12 12-5.373 12-12 12z"/><path fill="#000" class="tint" d="M17 29c-6.627 0-12-5.373-12-12S10.373 5 17 5s12 5.373 12 12-5.373 12-12 12z"/></g></svg>\n'},function(e,t){e.exports='<svg width="60" height="68" viewBox="0 0 60 68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M23.51 51.523a.5.5 0 0 1-.5.477c-.29 0-.51-.21-.52-.477-.145-3.168-1.756-5.217-4.832-6.147C7.53 42.968 0 33.863 0 23 0 10.297 10.297 0 23 0s23 10.297 23 23c0 10.863-7.53 19.968-17.658 22.376-3.076.93-4.687 2.98-4.83 6.147z" id="ae96eeecd750ec2a83543f00c9bc789d__b"/><filter x="-21.7%" y="-15.4%" width="143.5%" height="138.5%" filterUnits="objectBoundingBox" id="ae96eeecd750ec2a83543f00c9bc789d__a"><feGaussianBlur in="SourceGraphic" stdDeviation="3"/><feOffset dy="2"/><feComponentTransfer><feFuncA type="linear" slope=".3"/></feComponentTransfer></filter></defs><g fill="none" fill-rule="evenodd"><g fill-rule="nonzero" transform="translate(7 5)" fill="currentColor"><use filter="url(#ae96eeecd750ec2a83543f00c9bc789d__a)" xlink:href="#ae96eeecd750ec2a83543f00c9bc789d__b"/><use xlink:href="#ae96eeecd750ec2a83543f00c9bc789d__b"/></g><path d="M30 68c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z" fill="#fff" fill-rule="nonzero"/><path d="M30 66a2 2 0 1 0 .001-3.999A2 2 0 0 0 30 66z" fill="currentColor"/></g></svg>'},function(e,t,n){},,function(e,t){e.exports='<svg fill="none" height="40" width="34" xmlns="http://www.w3.org/2000/svg"><filter id="24609e80b326bd45d5a64be8fc7ffd36__a" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" height="38" width="32" x="1" y="2"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/></filter><g filter="url(#24609e80b326bd45d5a64be8fc7ffd36__a)"><path fill="#000" d="M3 17C3 9.266 9.267 3 17 3c7.732 0 14 6.268 14 14 0 5.082-2.014 8.247-6.235 11.76-.295.245-1.696 1.382-2.054 1.684-1.852 1.56-2.6 2.572-2.721 3.757l-.012.109a2.995 2.995 0 0 1-5.959-.018l-.01-.106c-.112-1.185-.857-2.196-2.71-3.755-.361-.304-1.77-1.446-2.065-1.691C5.014 25.234 3 22.073 3 17z"/></g><path fill="#fff" d="M3 17C3 9.266 9.267 3 17 3c7.732 0 14 6.268 14 14 0 5.082-2.014 8.247-6.235 11.76-.295.245-1.696 1.382-2.054 1.684-1.852 1.56-2.6 2.572-2.721 3.757l-.012.109a2.995 2.995 0 0 1-5.959-.018l-.01-.106c-.112-1.185-.857-2.196-2.71-3.755-.361-.304-1.77-1.446-2.065-1.691C5.014 25.234 3 22.073 3 17z"/><path fill="currentColor" d="M5 17c0 10 10.436 11.04 11 16.997l.01.104a.993.993 0 0 0 1.979.005l.011-.11C18.609 28.053 29 27 29 17c0-6.627-5.373-12-12-12S5 10.37 5 17z"/><path fill="#000" class="tint" d="M5 17c0 10 10.436 11.04 11 16.997l.01.104a.993.993 0 0 0 1.979.005l.011-.11C18.609 28.053 29 27 29 17c0-6.627-5.373-12-12-12S5 10.37 5 17z"/></svg>'},function(e,t){e.exports='<svg width="28" height="34" viewBox="0 0 28 34" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.2247 28.9111C12.133 27.9459 11.6447 27.1349 10.8253 26.292C10.2356 25.6855 9.54841 25.1305 8.78321 24.5125C8.44143 24.2365 8.08408 23.9479 7.71292 23.6366C5.37129 21.6722 2.89999 19.1042 2.89999 14.4658C2.89999 8.35203 7.86976 3.39999 14 3.39999C20.1304 3.39999 25.1 8.35434 25.1 14.4658C25.1 19.1025 22.6402 21.6727 20.3021 23.6393C19.9262 23.9555 19.5645 24.2481 19.2186 24.5279C18.46 25.1415 17.7778 25.6935 17.1898 26.2968C16.3675 27.1407 15.8737 27.9527 15.7745 28.9181L15.765 29.0107C15.7161 29.4865 15.4554 29.874 15.1734 30.1276C14.8914 30.3813 14.4782 30.6 13.9988 30.6C13.0882 30.6 12.3249 29.9125 12.2344 29.008L12.2247 28.9111Z" fill="white" fill-opacity="0.6"/><path d="M4.00143 14.5004C4.00143 8.97615 8.47795 4.50179 14 4.50179C19.5221 4.50179 23.9986 8.9783 23.9986 14.5004C23.9986 22.8325 15.3405 23.7089 14.8332 28.6624C14.83 28.694 14.8269 28.7245 14.8239 28.7537C14.785 29.1334 14.3805 29.4982 13.9989 29.4982C13.5738 29.4982 13.218 29.1765 13.1759 28.7535C13.173 28.7243 13.1699 28.694 13.1668 28.6624C12.6965 23.6996 4.00143 22.8325 4.00143 14.5004Z" fill="currentColor"/></svg>\n'},function(e,t){e.exports='<svg width="28" height="32" viewBox="0 0 28 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 14c0 5.508 3.18 10.273 7.805 12.558 3.026 1.573 4.847 3.215 5.463 4.928a.778.778 0 0 0 1.464 0c.616-1.713 2.437-3.355 5.463-4.928C24.819 24.273 28 19.508 28 14c0-7.732-6.268-14-14-14S0 6.268 0 14z" fill="currentColor"/></svg>'},function(e,t,n){"use strict";var r=n(16),o=n(4),i=n(422),a=n.n(i),s=n(2),c=n.n(s),u=n(5),l=n(234),d=n(19),p=n(36),f=n(45),m=n(31),v=n(455),g=Object(l.a)({resolved:{},chunkName:function(){return"stories-preview"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("stories-preview").then(n.bind(null,239))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 239}}),h=Object(l.a)({resolved:{},chunkName:function(){return"stories-preview"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("stories-preview").then(n.bind(null,243))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 243}}),b=Object(u.a)("search-placemark-view"),y=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this)._onClick=function(){t.props.onClick&&t.props.onClick(t.props.result)},t._getPlacemarkData=function(){var e=t.props;return{icon:e.icon,mode:e.mode,result:e.result}},t._onMouseEnter=function(){var e,n;null===(e=(n=t.props).onMouseEnter)||void 0===e||e.call(n,t._getPlacemarkData())},t._onMouseLeave=function(){var e,n;null===(e=(n=t.props).onMouseLeave)||void 0===e||e.call(n,t._getPlacemarkData())},t._renderEntrances=function(){var e=t.props;return e.active?s.createElement(v.a,{result:e.result,analyticsName:"entrances",animated:!0}):null},t._renderEntranceStory=function(){var e=t.props,n=e.result;return e.active&&"business"===n.type&&n.hasStories?s.createElement(g,{result:n},function(e){return s.createElement(h,Object(r.a)({result:n},e))}):null},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.result,n=e.icon,r=e.title,o=r&&r.position||"right",i=null;if(r){var a="bottom"!==o?n.centerY:void 0;i=s.createElement("div",{className:b("title"),style:{marginTop:a}},r.element)}var c=p.d(t),u="brandingId"in t&&t.brandingId||"advert"in t&&t.advert&&t.advert.pinBranding?"branding":c?"rubric":"default";return s.createElement(d.a,{name:e.analyticsName||"placemark",nodeState:{type:p.b(t),gml_id:t.analyticsId,pinPriority:"business"===t.type?t.pinPriority:void 0,logId:t.logId,permalink:"id"in t?t.id:void 0,uri:f.d(t),reqid:t.requestId,branding:"brandingId"in t?t.brandingId:void 0,active:e.active,lowRelevance:"lowRelevance"in t&&t.lowRelevance,relatedAdvertType:"relatedAdvertType"in t&&t.relatedAdvertType||void 0,mode:e.mode,iconType:u},logClick:!0},s.createElement(m.a,{coordinates:e.coordinates,zIndex:e.zIndex,onClick:this._onClick,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},s.createElement("div",{className:b({position:o}),"data-object":"search-placemark","data-id":e.result.id,"data-log-id":e.result.logId,"data-mode":e.mode,"data-coordinates":e.coordinates.join(","),"data-icon-type":u,style:{marginTop:-n.baseY,marginLeft:"left"===o?n.baseX:"right"===o?-n.baseX:void 0}},s.createElement("div",{className:b("icon"),style:{width:n.width,height:n.height}},n.element),i)),this._renderEntrances(),this._renderEntranceStory())},t}(s.PureComponent);t.a=y},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){e.exports=n.p+"_/7f78fe3f36223c298be58eb812e95646.svg"},function(e,t,n){e.exports=n.p+"_/c12482225d6037bc31c877707bba41c3.svg"},function(e,t,n){e.exports=n.p+"_/2e1750eb108b5881e5577c7e08041e3f.svg"},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(101),o=n(102),i=n(47),a=n(44),s=n(58),c=n(53),u="[object RegExp]";var l=function(e){return Object(c.a)(e)&&Object(s.a)(e)==u},d=n(132),p=n(131),f=p.a&&p.a.isRegExp,m=f?Object(d.a)(f):l,v=n(110),g=Object(v.a)("length"),h="[\\ud800-\\udfff]",b="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",y="\\ud83c[\\udffb-\\udfff]",_="[^\\ud800-\\udfff]",E="(?:\\ud83c[\\udde6-\\uddff]){2}",w="[\\ud800-\\udbff][\\udc00-\\udfff]",S="(?:"+b+"|"+y+")"+"?",O="[\\ufe0e\\ufe0f]?"+S+("(?:\\u200d(?:"+[_,E,w].join("|")+")[\\ufe0e\\ufe0f]?"+S+")*"),C="(?:"+[_+b+"?",b,E,w,h].join("|")+")",k=RegExp(y+"(?="+y+")|"+C+O,"g");var j=function(e){for(var t=k.lastIndex=0;k.test(e);)++t;return t};var R=function(e){return Object(i.a)(e)?j(e):g(e)},T=n(100),I=n(122),M=n(46),x=30,P="...",N=/\w*$/;t.a=function(e,t){var n=x,s=P;if(Object(a.a)(t)){var c="separator"in t?t.separator:c;n="length"in t?Object(I.a)(t.length):n,s="omission"in t?Object(r.a)(t.omission):s}var u=(e=Object(M.a)(e)).length;if(Object(i.a)(e)){var l=Object(T.a)(e);u=l.length}if(n>=u)return e;var d=n-R(s);if(d<1)return s;var p=l?Object(o.a)(l,0,d).join(""):e.slice(0,d);if(void 0===c)return p+s;if(l&&(d+=p.length-d),m(c)){if(e.slice(d).search(c)){var f,v=p;for(c.global||(c=RegExp(c.source,Object(M.a)(N.exec(c))+"g")),c.lastIndex=0;f=c.exec(v);)var g=f.index;p=p.slice(0,void 0===g?d:g)}}else if(e.indexOf(Object(r.a)(c),d)!=d){var h=p.lastIndexOf(c);h>-1&&(p=p.slice(0,h))}return p+s}},,function(e,t,n){"use strict";var r=n(85),o=n(65),i=n(202),a=n(121);var s=n(27);function c(e,t,n){e=n?[[Math.min(e[0][0],e[1][0])-n,Math.min(e[0][1],e[1][1])-n],[Math.max(e[0][0],e[1][0])+n,Math.max(e[0][1],e[1][1])+n]]:e;var c=Object(r.a)(s.g),u=Object(o.a)(t,s.g);return Object(i.a)(Object(a.a)(e,s.g),c).some(function(e){return function(e,t){return t[0]>=e[0][0]&&t[0]<=e[1][0]&&t[1]>=e[0][1]&&t[1]<=e[1][1]}(e,u)})}n.d(t,"a",function(){return c})},function(e,t,n){"use strict";var r=n(4),o=(n(424),n(2)),i=n(72),a=n(458),s=n(5),c=n(20),u=n(32),l=n(31),d=n(19),p=n(42),f=n(63),m=n.n(f),v=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._uuid=m.a.v4(),t._getCollidingPrimitiveId=function(e){return t._uuid+":"+e.id},t._getCollidingPrimitives=function(e){var n=new Map;return e.forEach(function(e){n.set(t._getCollidingPrimitiveId(e),{anchor:e.anchor,rect:{minX:e.pixelSize[0][0],minY:e.pixelSize[0][1],maxX:e.pixelSize[1][0],maxY:e.pixelSize[1][1]}})}),n},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=this._getCollidingPrimitives(e.placemarks);e.map.addInvisibleCollidingPrimitives(t)},n.shouldComponentUpdate=function(){return!this.props.preventUpdates},n.componentDidUpdate=function(){var e=this,t=this.props,n=t.map.getInvisibleCollidingPrimitives(),r=[],o=this._getCollidingPrimitives(t.placemarks);n.forEach(function(t,n){n.startsWith(e._uuid+":")&&r.push(n)}),t.map.removeInvisibleCollidingPrimitives(r),t.map.addInvisibleCollidingPrimitives(o)},n.componentWillUnmount=function(){var e=this.props;e.map.removeInvisibleCollidingPrimitives(e.placemarks.map(this._getCollidingPrimitiveId))},n.render=function(){return null},t}(o.Component),g=Object(c.b)({shouldWait:!0})(v),h=Object(s.a)("map-entrances-view"),b=[[-5,-5],[5,5]],y=18.5,_=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onMapMainEngineChanged=function(){var e="vector"===n.props.map.getEffectiveMode();e!==n.state.isVector&&n.setState({isVector:e})},n._onMapUpdate=function(){var e=n.props,t=n.state,r=e.map.zoom,o=e.map.azimuth;r===t.mapZoom&&o===t.mapAzimuth||n.setState({mapZoom:r,mapAzimuth:o})},n._renderEntrance=function(e,t){var r=n.props,s=n.state,c=E(s.mapZoom),u=((e.azimuth||0)+Object(i.a)(s.mapAzimuth))%360;return o.createElement(d.a,{key:t,name:"entrance",nodeState:{name:e.name,coords:Object(a.a)(e.coordinates)}},o.createElement(l.a,{coordinates:e.coordinates,nonInteractive:!r.onEntranceClick,onClick:function(){var t;return null===(t=r.onEntranceClick)||void 0===t?void 0:t.call(r,e)},zIndex:p.a.search.base},o.createElement("div",{className:h({size:c,animated:r.animated})},o.createElement("div",{style:{transform:"rotate("+u+"deg)"}},void 0!==e.azimuth?o.createElement("div",{className:h("arrow")}):void 0,o.createElement("div",{className:h("dot")})),s.isVector&&e.name&&s.mapZoom>=y?o.createElement("div",{className:h("title",{position:u>45&&u<135?"left":"right"})},e.name):null)))},n._renderEntrances=function(){var e=n.props,t=n.state,r=E(t.mapZoom);return e.result.entrances&&r?o.createElement(o.Fragment,null,e.result.entrances.map(n._renderEntrance),t.mapZoom>=y?o.createElement(g,{placemarks:e.result.entrances.map(function(e){return{anchor:e.coordinates,id:e.coordinates.join(","),pixelSize:b}})}):null):null},n.state={mapZoom:t.map.zoom,mapAzimuth:t.map.azimuth,isVector:"vector"===t.map.getEffectiveMode()},n}return Object(r.a)(t,e),t.prototype.render=function(){return o.createElement(o.Fragment,null,this._renderEntrances(),o.createElement(u.b,{onUpdate:this._onMapUpdate,onMainEngineChanged:this._onMapMainEngineChanged}))},t}(o.PureComponent);function E(e){return e>=18?"large":e>=17?"normal":e>=16?"small":void 0}t.a=Object(c.b)({shouldWait:!0})(_)}]]);